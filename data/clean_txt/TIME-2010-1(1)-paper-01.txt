Decidability of the Logics of the Reflexive Sub-interval  and Super-interval Relations over Finite Linear Orders  Angelo Montanari  Dept. of Mathematics and  Computer Science  University of Udine, Italy  angelo.montanari@uniud.it  Ian Pratt-Hartmann  School of Computer Science  Manchester University, UK  ipratt@cs.man.ac.uk  AbstractÃ¢Â€Â”An interval temporal logic is a propositional, multimodal logic interpreted over interval structures of partial  orders. The semantics of each modal operator are given in the  standard way with respect to one of the natural accessibility  relations defined on such interval structures. In this paper,  we consider the modal operators based on the (reflexive) subinterval relation and the (reflexive) super-interval relation. We  show that the satisfiability problems for the interval temporal  logics featuring either or both of these modalities, interpreted  over interval structures of finite linear orders, are all PS PACEcomplete. These results fill a gap in the known complexity  results for interval temporal logics.  Keywords-interval temporal logic; decidability; computational complexity  I. I NTRODUCTION  Interval temporal logics provide a natural framework for  representing and reasoning about temporal properties in  many areas of computer science, including formal specification and verification of reactive systems, temporal databases,  knowledge representation, and natural language semantics  [1]. For many years, the discouragingly high computational  complexity of these logics impeded their systematic investigation. (As an example, Halpern and ShohamÃ¢Â€Â™s modal  logic of time interval HS [2] and VenemaÃ¢Â€Â™s CDT logic [3]  are highly undecidable.) Recently, however, the discovery  of expressive decidable fragments of HS has generated  renewed interest in this subject. The most significant of these  fragments are the logics of temporal neighbourhood [4] and  the logics of sub-interval and super-interval structures [5].  Decidability of temporal neighbourhood logics over various  classes of linear orders can be proved by reducing their  satisfiability problems to that of the two-variable fragment  of first-order logic over the same classes of linear orders  [6]. In fact, neighbourhood temporal logic turns out to be a  maximal decidable fragment of HS, when interpreted over  any class of linear orders that contains at least one linear  order with an infinitely ascending/descending sequence [4],  [7], [8]. In this paper, we focus on interval logics of subinterval and super-interval structures.  There are three natural definitions of the sub-interval  Pietro Sala  Dept. of Mathematics and  Computer Science  University of Verona, Italy  pietro.sala@univr.it  relation [5]: reflexive  (the current interval is a sub-interval  of itself), proper  (sub-intervals share at most one endpoint  with the current interval), and strict   Ã‚Ë‡ (both endpoints of  the sub-intervals are strictly inside the current interval).  And interval temporal logics based on all of these versions  of the sub-interval relationÃ¢Â€Â”interpreted over the class of  dense linear ordersÃ¢Â€Â”have been studied in the literature.  Thus, the logic D of reflexive sub-intervals is studied by  van Benthem in [9], where it is proved to be equivalent  to the standard modal logic S4. In [10], Shapirovsky and  Shehtman establish a connection between the logic of strict  sub-intervals DÃ‚Ë‡ and the logic of Minkowski space-time.  They provide a sound and complete axiomatic system for  DÃ‚Ë‡ ; moreover, they prove PS PACE-completeness of DÃ‚Ë‡  by means of a suitable filtration technique [10], [11]. An  optimal tableau system for DÃ‚Ë‡ is given by Bresolin et al in  [5]. Finally, the logic D is treated extensively in [5]. The  authors prove decidability and PS PACE-completeness of D ,  and provide an optimal tableau system.  All of the above results concern logics interpreted over  dense linear orders; and the question naturally arises as  to what happens if we consider classes of discrete orders  instead. In this paper, we go some way to answering this  question. Specifically, we study the satisfiability problem of  interval temporal logics based on the reflexive sub-interval  and super-interval relations interpreted over finite linear  orders.  The paper is organized as follows. In Section II, we  give the syntax and semantics of three propositional modal  languages: LD , featuring the modal operator [D], LDÄšÂ„ ,  featuring the modal operator [DÄšÂ„], and LD,DÄšÂ„ , featuring both  operators. Informally, we read [D]ÄÂ• as Ã¢Â€ÂœÄÂ• is true at all subintervals of the current intervalÃ¢Â€Â, and [DÄšÂ„]ÄÂ• as Ã¢Â€ÂœÄÂ• is true at all  super-intervals of the current intervalÃ¢Â€Â. We interpret all three  languages over the class of finite linear orders. In Section III,  we prove PS PACE-hardness of the satisfiability problem for  LD and LDÄšÂ„ , by reduction from the satisfiability problem for  quantified Boolean formulas. In Section IV, we prove that  the satisfiability problem for LD is in PS PACE. In Section  V, we generalize this latter result to LDDÄšÂ„ . It can easily be  1, m  m, m  i, j  so  @  Rsq , q  @  p1 , p s  1  ?  ?  s q2 , q  p2 , p s  j, j  [i, j]  i, i  i  j  Figure 2.  A relational frame satisfying (1)Ã¢Â€Â“(10).  1, 1  Figure 1.  Geometrical depiction of intervals.  shown that the proposed techniques cannot be directly lifted  to the strict and proper cases. Moreover, the undecidability  of various extensions of the logics of sub-interval and superinterval structures has been recently proved [4], [7], [12].  II. P RELIMINARIES  Fix a set P of proposition letters, and denote its power  set by P(P). The language LD is defined to be the smallest  set of expressions satisfying:  (i) P Ã¢ÂŠÂ† LD ;  (ii) if ÄÂ•, ÄÂˆ Ã¢ÂˆÂˆ LD , then ÄÂ• Ã¢ÂˆÂ§ ÄÂˆ, Ã‚Å¹ÄÂ•, [D]ÄÂ• Ã¢ÂˆÂˆ LD .  The language LDÄšÂ„ is defined similarly, but with [DÄšÂ„] in place  of [D]; the language LDDÄšÂ„ contains both modalities.  In the following, we employ the usual abbreviations ÄÂ• Ã¢ÂˆÂ¨  ÄÂˆ (for Ã‚Å¹(Ã‚Å¹ÄÂ• Ã¢ÂˆÂ§ Ã‚Å¹ÄÂˆ)), DÄÂ• (for Ã‚Å¹[D]Ã‚Å¹ÄÂ•), and DÄšÂ„ÄÂ• (for  Ã‚Å¹[DÄšÂ„]Ã‚Å¹ÄÂ•). We denote by ÄÂ• the total number of symbols  occurring in ÄÂ•. For the purposes of this paper, an interval  is a set of the form {h Ã¢ÂˆÂˆ N | i  h  j}, where i, j are  positive integers with i  j; we write [i, j] to denote this  interval. Note that intervals are finite and non-empty, but  may be singletons. If I is an interval, we write Sub(I) to  denote the set of intervals J such that J Ã¢ÂŠÂ† I. A structure  is a pair A = (IA , Ã‚Ë‡A ), where IA = [1, m] for some m  1,  and Ã‚Ë‡A is a function from Sub(IA ) to P(P). We refer to  IA as the domain of A, m as the size of A, and Ã‚Ë‡A as the  interpretation function of A. We define a truth-relation for  LDDÄšÂ„ -formulas (hence for LD -formulas and LDÄšÂ„ -formulas),  relative to structures A and intervals I Ã¢ÂŠÂ† IA , as follows:  (i) for p Ã¢ÂˆÂˆ P, A |=I p if and only if p Ã¢ÂˆÂˆ I A ;  (ii) the usual rules for Ã¢ÂˆÂ§ and Ã‚Å¹;  (iii) A |=I [D]ÄÂ• if and only if, for all intervals J Ã¢ÂŠÂ† I,  A |=J ÄÂ•;  (iv) A |=I [DÄšÂ„]ÄÂ• if and only if, for all intervals J Ã¢ÂˆÂˆ Sub(IA )  such that J Ã¢ÂŠÂ‡ I, A |=J ÄÂ•.  If ÃÅš is a set of formulas, we write A |=I ÃÅš if A |=I ÄÂ• for  all ÄÂ• Ã¢ÂˆÂˆ ÃÅš. If A |=I ÄÂ• for some I Ã¢ÂˆÂˆ Sub(IA ), we say that  A is a model of ÄÂ•. If ÄÂ• has a model, then ÄÂ• is satisfiable;  if Ã‚Å¹ÄÂ• has no model, then ÄÂ• is valid. We denote the set of  valid LD -formulas by D.  If I = [1, m], it is useful to depict Sub(I) as the upper  left-hand half of an m Ä‚Â— m integer grid, as shown in Fig. 1,  where each interval [i, j] Ã¢ÂˆÂˆ Sub(I) corresponds to the cell  in the grid having co-ordinates i, j. In this representation,  all intervals sharing a common end-point j lie in the jth row  (counting from the bottom upwards), all intervals sharing a  common start-point i lie in the ith column (counting leftto-right), and all singleton intervals [i, i] lie on the diagonal  section of the boundary. Motivated by this representation, if  A is a structure of size m, and 1  j  m, then we refer to  the set of intervals {[i, j] | for some i (1  i  j)} as the  jth row of A, and to the interval [i, j] as the ith cell in that  row. We refer to the mth row of A as the top row.  Evidently, we may identify LD with the language of  propositional modal logic, where [D] replaces the modal  operator ; and it is natural to ask how D is related,  under this identification, to the modal logics of various  familiar frame-classes. Thus, for example, it is easy to show  that every satisfiable LD -formula (using the semantics for  LD given above) has a relational (Kripke) model over a  finite, reflexive, transitive tree. Since the logic S4Grz is  known to be sound and complete for the class of finite,  reflexive, transitive trees [13, p. 101], we have S4Grz Ã¢ÂŠÂ† D.  However, a little thought shows that this inclusion is strict.  For consider the following set of LD -formulas featuring the  proposition letters o, p, q, p1 , p2 , q1 and q2 :  o  (1)  [D](o Ã¢ÂˆÂ¨ p1 Ã¢ÂˆÂ¨ p2 Ã¢ÂˆÂ¨ q1 Ã¢ÂˆÂ¨ q2 )  [D](o Ã¢Â†Â’ D(p1 Ã¢ÂˆÂ§ Ã‚Å¹o) Ã¢ÂˆÂ§ D(q1 Ã¢ÂˆÂ§ Ã‚Å¹o))  (2)  (3)  [D](p1 Ã¢Â†Â’ D(p2 Ã¢ÂˆÂ§ Ã‚Å¹p1 ))  [D](q1 Ã¢Â†Â’ D(q2 Ã¢ÂˆÂ§ Ã‚Å¹q1 ))  (4)  (5)  [D](p1 Ã¢ÂˆÂ¨ p2 Ã¢Â†Â’ p)  [D](q1 Ã¢ÂˆÂ¨ q2 Ã¢Â†Â’ q)  [D]Ã‚Å¹(p Ã¢ÂˆÂ§ q)  (6)  (7)  (8)  [D](p Ã¢Â†Â’ [D]p)  [D](q Ã¢Â†Â’ [D]q).  (9)  (10)  The corresponding -formulas are easily seen to be satisfied  at the root of the reflexive, transitive tree with two depth-3  branches illustrated in Fig. 2 (where only the true proposition  letters are indicated); hence these formulas are S4Grzconsistent.  Now suppose (1)Ã¢Â€Â“(10) are true at an interval I in some  structure A (under LD -semantics). From (3)Ã¢Â€Â“(5), every sub-  interval of I satisfying o has length at least 3, and every  sub-interval of I satisfying p1 or q1 , length at least 2. Hence,  by (2), all unit-length sub-intervals of I satisfy either p2 or  q2 , and by (6)Ã¢Â€Â“(8), no such interval satisfies both. By (1),  (3)Ã¢Â€Â“(7) and (9)Ã¢Â€Â“(10), there exists at least one unit-length  subinterval of I satisfying p2 and similarly for q2 . Therefore,  we can find adjacent unit-length intervals, say, Jp satisfying  p2 and Jq , satisfying q2 . Now consider the length-2 interval  J which includes Jp and Jq . Since J is of length less than  3, J cannot satisfy o; since Jp satisfies p by (6), J cannot  satisfy q1 or q2 by (7)Ã¢Â€Â“(8) and (10); likewise, J cannot  satisfy p1 or p2 by (6) and (8)Ã¢Â€Â“(9). This falsifies (2).  q0  ÃÂ¸ = Q1 p1 . . . Qn pn ÄÂˆ,  (11)  where ÄÂˆ is a formula of propositional logic and, for all i (1   i  n), Qi is either Ã¢ÂˆÂ€ or Ã¢ÂˆÂƒ. Given a truth-value assignment to  its free variables, ÃÂ¸ is assigned a truth-value in the obvious  way; in particular, if ÃÂ¸ is closed (has no free variables), it is  either true or false simpliciter. The problem of determining  the truth-value of closed quantified Boolean formulas was  shown to be PS PACE-complete in [14].  Theorem 1. The satisfiability problems for LD -formulas  and LDÄšÂ„ -formulas over finite linear orders are both PS PACEhard.  Proof: By (logarithmic space) reduction from the satisfiability problem for quantified Boolean formulas. Let the  quantified Boolean formula ÃÂ¸, of the form (11), be given,  where ÄÂˆ is a formula of propositional logic featuring only  the proposition letters p1 , . . . , pn . We construct an LD formula ÃÂ¸ÄšÂ„, and show that ÃÂ¸ÄšÂ„ is satisfiable over finite linear  orders if and only if ÃÂ¸ is true. For all i (0  i  n), define ÃÂ¸i  to be the formula Qi+1 pi+1 . . . Qn pn ÄÂˆ, with free variables  p1 , . . . , pi . Thus, ÃÂ¸0 = ÃÂ¸ and ÃÂ¸n = ÄÂˆ.  The LD -formula ÃÂ¸ÄšÂ„ will feature the proposition letters p1 , . . . , pn together with additional proposition letters  q0 , . . . , qn . We define ÃÂ¸ÄšÂ„ to be the conjunction of the following set of formulas:  q0  (1  j  i < k  n)  [D](qi Ã¢ÂˆÂ§ pj Ã¢Â†Â’ [D](qk Ã¢Â†Â’ pj ))  [D](qi Ã¢ÂˆÂ§ Ã‚Å¹pj Ã¢Â†Â’ [D](qk Ã¢Â†Â’ Ã‚Å¹pj )) (1  j  i < k  n)  (0  i < n)  [D](qi Ã¢Â†Â’ Dqi+1 )  (0  i < n, Qi+1 = Ã¢ÂˆÂ€)  [D](qi Ã¢Â†Â’ D(qi+1 Ã¢ÂˆÂ§ pi+1 )  [D](qi Ã¢Â†Â’ D(qi+1 Ã¢ÂˆÂ§ Ã‚Å¹pi+1 )  (0  i < n, Qi+1 = Ã¢ÂˆÂ€)  (12)  (13)  (14)  (15)  (16)  (17)  q3 , p 3  q2 ,Ã‚Å¹p2  q4 ,Ã‚Å¹p4  q3 ,Ã‚Å¹p3  q4 , p 4  q1 ,Ã‚Å¹p1  q2 , p 2  q3 , p 3  q3 ,Ã‚Å¹p3  q4 , p 4  p3 /0  Ã‚Å¹p1 , p2 , Ã‚Å¹p3  Ã¢Âˆ  p1 /1  Ã‚Å¹p1  Ã‚Å¹p1 , p2  p4 /1  Figure 3.  p1 /0  p2 /1  q4 ,Ã‚Å¹p4  III. L OWER B OUND  The task of this section is to establish the PS PACEhardness of the satisfiability problems for D and D over  finite linear orders. The argument is straightforward, and  proceeds by reduction from the satisfiability problem for  quantified Boolean formulas, the canonical PS PACE-hard  problem. Recall, in this context, that a quantified Boolean  formula is an expression of the form  q1 , p 1  p3 /1  Ã‚Å¹p1 , p2 , p3  p4 /0  p1  p3 /0  p2 /0  p1 , Ã‚Å¹p2  p1 , Ã‚Å¹p2 , Ã‚Å¹p3  p4 /1  p3 /1  p1 , Ã‚Å¹p2 , p3  p4 /0  Ã‚Å¹p1 , p2 ,  Ã‚Å¹p1 , p2 ,  p1 , Ã‚Å¹p2 ,  p1 , Ã‚Å¹p2 ,  Ã‚Å¹p3 , p4  p3 , Ã‚Å¹p4  Ã‚Å¹p3 , p4  p3 , Ã‚Å¹p4  A tree-model and its embedding into a grid structure.  [D](qn Ã¢Â†Â’ ÄÂˆ)  (18)  It is routine to check that the construction of ÃÂ¸ÄšÂ„ requires only  space bounded by a logarithmic function of ÃÂ¸ . Suppose  A |=I0 ÃÂ¸ÄšÂ„. We think of the truth of a proposition letter qi  (0  i < n) at an interval as indicating that the quantifier  Qi+1 is being Ã¢Â€Â˜consideredÃ¢Â€Â™. Formula (12) starts the process  by considering Q1 . Now, suppose A |=I qi , where 0  i < n  and I Ã¢ÂŠÂ† I0 . By Formulas (13) and (14), every sub-interval of  I satisfying qk (k > i) must agree with I on the truth-values  assigned to p1 , . . . , pi ; thus these proposition letters may be  regarded as fixed for all such intervals. If Qi+1 = Ã¢ÂˆÂƒ, then,  by Formulas (15), I has a sub-interval J satisfying qi+1 (at  which pi+1 must be either true or false); on the other hand,  if Qi+1 = Ã¢ÂˆÂ€, then, by Formulas (16) and (17), I has two  sub-intervals satisfying qi+1 : one in which pi+1 is true, and  one in which pi+1 is false. Finally, Formula (18) ensures  that, if I Ã¢ÂŠÂ† I0 and A |=I qn , then ÄÂˆ is true at I. Now,  any I Ã¢ÂŠÂ† I0 such that A |=I qi defines a natural truth-value  assignment ÃËI with domain {p1 , . . . , pi } obtained by taking  ÃË(pj ) =  just in case A |=I pj , for all j (1  j  i).  Using a (backwards) inductive argument, we claim that, if  I Ã¢ÂŠÂ† I0 and A |=I qi , then ÃËI |= ÃÂ¸i . For i = n, the claim is  guaranteed by Formula (18). Assuming the result holds for  i (0 < i  n) Formulas (13), (14), (16) and (17) guarantee  that it holds for i Ã¢ÂˆÂ’ 1 if Qi = Ã¢ÂˆÂ€, and Formulas (13)Ã¢Â€Â“(15) do  the same if Qi = Ã¢ÂˆÂƒ. Formula (12) then guarantees that ÃÂ¸ is  true.  Conversely, suppose ÃÂ¸ is true. We define a tree tr(ÃÂ¸) as  follows. Each node ÃË of tr(ÃÂ¸) will be a truth-value assignment with domain {p1 , . . . , pi } for some i (0  i  n),  with the property that ÃË |= ÃÂ¸i ; we call i the level of  ÃË. We take the root node ÃË0 of tr(ÃÂ¸) to be the empty  assignment (i.e., the unique assignment with level 0). Since  ÃÂ¸ = ÃÂ¸0 is a true formula with no free variables, we have  ÃË0 |= ÃÂ¸0 . Suppose now that ÃË is a node of tr(ÃÂ¸), with level i  (0  i < n), such that ÃË |= ÃÂ¸i . If ÃÂ¸i = Ã¢ÂˆÂƒpi+1 ÃÂ¸i+1 , let ÃË  be  an assignment with domain {p1 , . . . , pi+1 } such that ÃË Ã¢ÂŠÂ† ÃË  ,  and ÃË  |= ÃÂ¸i+1 ; we then take ÃË  to be the sole daughter  of ÃË in tr(ÃÂ¸). If, on the other hand, ÃÂ¸i = Ã¢ÂˆÂ€pi+1 ÃÂ¸i+1 , let  ÃË  = ÃË Ã¢ÂˆÅ {pi+1 Ã¢Â†Â’ }, ÃË  = ÃË Ã¢ÂˆÅ {pi+1 Ã¢Â†Â’ Ã¢ÂŠÄ½}, and take ÃË   and ÃË  to be the daughters of ÃË in tr(ÃÂ¸); evidently, ÃË  |= ÃÂ¸i+1  and ÃË  |= ÃÂ¸i+1 . This completes the definition of tr(ÃÂ¸). Note  that, in particular, if ÃË is a node with level n, then ÃË |= ÃÂ¸n ;  i.e., ÃË |= ÄÂˆ.  A straightforward induction on n shows that, setting m =  2n+1 , we may define an embedding f : tr(ÃÂ¸) Ã¢Â†Â’ Sub([1, m])  in such a way that f (ÃË) Ã¢ÂŠÂ† f (ÃË  ) if and only if ÃË is a  descendant of ÃË  in tr(ÃÂ¸). This is illustrated by the lefthand diagram in Fig. 3, where a tree-model for the QBF  formula ÃÂ¸ = Ã¢ÂˆÂ€p1 Ã¢ÂˆÂƒp2 Ã¢ÂˆÂ€p3 Ã¢ÂˆÂƒp4 (p1 Ã¢ÂˆÂ¨ p2 ) Ã¢ÂˆÂ§ (Ã‚Å¹p1 Ã¢ÂˆÂ¨ Ã‚Å¹p2 ) Ã¢ÂˆÂ§ (p3 Ã¢ÂˆÂ¨  p4 ) Ã¢ÂˆÂ§ (Ã‚Å¹p3 Ã¢ÂˆÂ¨ Ã‚Å¹p4 ) is given, together with its embedding  into a grid structure. To show that ÃÂ¸ÄšÂ„ is satisfiable, define  A with domain [1, m] as follows. For all i (0  i  n),  we set A |=I qi if and only if I = f (ÃË) for some node  ÃË of tr(ÃÂ¸) with level i. Further, for each node ÃË with level  i, and each j (1  j  i), we set A |=f (ÃË) pj if and  only if ÃË(pj ) = . The truth-values of the other proposition  letters may be assigned arbitrarily. It is then obvious that  A |=f (ÃË0 ) ÃÂ¸ÄšÂ„. An example of this construction is shown in  the right-hand diagram of Fig. 3.  By replacing every occurrence of [D] with [DÄšÂ„], we  similarly establish the PS PACE-hardness of LDÄšÂ„ .  IV. U PPER B OUND  The task of this section is to establish the membership in  PS PACE of the satisfiability problem for LD -formulas over  the class of finite linear orders.  Fix an LD -formula ÄÂ•. Let ÃÅš be the set of all sub-formulas  of ÄÂ• (including ÄÂ• itself), and let ÃÅš be the set of all formulas  ÄÂˆ or Ã‚Å¹ÄÂˆ, where ÄÂˆ Ã¢ÂˆÂˆ ÃÅš . A 1-type is a subset ÃÄ… Ã¢ÂŠÂ† ÃÅš  satisfying the properties:  (T1) for all formulas Ã‚Å¹ÄÂˆ Ã¢ÂˆÂˆ ÃÅš, either ÄÂˆ Ã¢ÂˆÂˆ ÃÄ… or Ã‚Å¹ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…;  (T2) ÃÄ… is propositionally consistent;  (T3) if [D]ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…, then ÄÂˆ Ã¢ÂˆÂˆ ÃÄ….  Let A be a structure and I Ã¢ÂˆÂˆ Sub(IA ). Evidently, there is a  unique 1-type ÃÄ… such that A |=I ÃÄ…; we say that A realizes  ÃÄ… at I.  For the purposes of this paper, a vector is a finite, nonempty sequence of positive integers. The following notation  will be used. If wÄšÂ„ = (w1 , . . . , ws ) is a vector of length s, we  write |wÄšÂ„| = s, and if m is a positive integer, we write mwÄšÂ„ for  the vector (mw1 , . . . , mws ). If vÄšÂ„ = (v1 , . . . , vs ) is a vector  of the same length, we write wÄšÂ„  vÄšÂ„ (equivalently: vÄšÂ„  wÄšÂ„) if  wi  vi for all i (1  i  s). Less conventionally, we take  corresponding upper-case letters to denote the successive  partial sums of vectors, thus: Wi = w1 + Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ + wi , for all i  (0  i  s). Note that, for any vector wÄšÂ„, W0 = 0.  Let A be a structure of size m, I1 , . . . , Is , a selection  of intervals in IA occurring left-to right across a single  wi  w1  ÃÄ…1  Figure 4.  Ã‚Ë‡Ã‚Ë‡Ã‚Ë‡  ÃÄ…1  Ã‚Ë‡Ã‚Ë‡Ã‚Ë‡  ÃÄ…i  Ã‚Ë‡Ã‚Ë‡Ã‚Ë‡  ws  ÃÄ…i  Ã‚Ë‡Ã‚Ë‡Ã‚Ë‡  ÃÄ…s  Ã‚Ë‡Ã‚Ë‡Ã‚Ë‡  ÃÄ…s  Geometrical depiction of the realization of a profile by a row.  row in the grid-representation of Sub(IA ), and ÃÄ…1 , . . . , ÃÄ…s  the respective 1-types realized in A by these intervals. In  addition, suppose that the final cell in that row realizes ÃÄ…s .  Evidently:  (C1) if 1  h < h  s and [D]ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h , then [D]ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h ;  (C2) if DÄÂˆ Ã¢ÂˆÂˆ ÃÄ…s , then ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…s .  Accordingly, we say that a configuration is a finite, nonempty sequence ÃÄ…ÄšÂ„ = (ÃÄ…1 , . . . , ÃÄ…s ) of 1-types satisfying  conditions (C1) and (C2). Again, we denote the length of  this sequence by |ÃÄ…ÄšÂ„|. A profile is a pair ÃÄ…ÄšÂ„, wÄšÂ„, where ÃÄ…ÄšÂ„ is  a configuration of length s  1, and wÄšÂ„ = (w1 , . . . , ws ) a  vector, also of length s; we say that the length of this profile  is s. For 1  j  m, we say that the jth row of A realizes the  profile (ÃÄ…1 , . . . , ÃÄ…s ), (w1 , . . . , ws ) if Ws = j and, for all h  (1  h  s) and all i (WhÃ¢ÂˆÂ’1 < i  Wh ), A |=[i,j] ÃÄ…h . Pictorially, this means that the successive 1-types ÃÄ…1 , . . . , ÃÄ…s are  realized horizontally in uniform blocks of length w1 , . . . , ws ,  respectively, and that these blocks cover the entire row, as  shown in Fig. 4. For all j (1  j  m), the jth row of A  obviously realizes at least one profile; however, since there is  no requirement that neighbouring ÃÄ…i are distinct, this profile  will not in general be unique.  The following lemma shows that we may, without loss of  generality, confine attention to Ã¢Â€Â˜shortÃ¢Â€Â™ profiles.  Lemma 2. If an LD -formula ÄÂ• has a model, then it has a  model over the same domain in which every row realizes a  profile of length at most ÄÂ• + 1.  Proof: Fix a model A of ÄÂ•, of size m. If ÄÂˆ Ã¢ÂˆÂˆ ÃÅš, a  witness for ÄÂˆ is an interval I Ã¢ÂˆÂˆ Sub(IA ) such that A |=I ÄÂˆ.  We call an interval I = [i, j] Ã¢ÂˆÂˆ Sub(IA ) special if there  exists ÄÂˆ Ã¢ÂˆÂˆ ÃÅš such that A |=I ÄÂˆ and, for all k (i < k  j)  A |=[k,j] ÄÂˆÃ¢Â€Â”that is, if there is some formula of ÃÅš for which  I is the right-most witness in its row. Since every singleton  interval, [j, j], is special, it follows that, for any I = [i, j] Ã¢ÂˆÂˆ  Sub(IA ), there is a least k (i  k  j) such that K = [k, j]  is special. We refer to K as the first special interval to the  right of I. Evidently, K = I if and only if I is itself special.  Moreover, since |ÃÅš|  2 ÄÂ• , and the right-most interval of  any row is the right-most witness for at least |ÃÅš|/2 of the  formulas of ÃÅš in that row, it follows that the number of  special intervals in any row is at most ÄÂ• + 1.  Now define the structure B, over the same domain as A,  by setting, for all I Ã¢ÂˆÂˆ Sub(IA ), I B = K A , where K is the  first special interval to the right of I. We claim that, for all  I Ã¢ÂˆÂˆ Sub(IA ) and all ÄÂˆ Ã¢ÂˆÂˆ ÃÅš:      Vh  Vh Ã¢ÂˆÂ’1  v1 v2 . . . vtÃ¢ÂˆÂ’1   -  -  vt  -  6  ÃË›h    Uh  Figure 5.  ÃÄ…h  -  Neighbouring rows of a structure  Vt Ã¢ÂˆÂ’ Us  ÃË›1 ÃË›2 . . . ÃË›tÃ¢ÂˆÂ’1  ?  (S1) for all h (1  h  s) and all h (1  h  t), if  [D]ÄÂˆ Ã¢ÂˆÂˆ ÃË›h and Uh > Vh Ã¢ÂˆÂ’1 , then [D]ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h ;  (S2) for all h (1  h  t), if DÄÂˆ Ã¢ÂˆÂˆ ÃË›h , either there  exists h (h  h  t) such that ÄÂˆ Ã¢ÂˆÂˆ ÃË›h , or there  exists h (1  h  s) such that Uh  Vh and DÄÂˆ Ã¢ÂˆÂˆ  ÃÄ…h ;  (S3) VtÃ¢ÂˆÂ’1  Us < Vt .  The following two lemmas motivate this definition.  Lemma 3. Let A be a structure of size m, let 1  j < m,  and let ÃÄ…ÄšÂ„, uÄšÂ„, ÃË›ÄšÂ„, vÄšÂ„ be profiles realized by the jth and  -  A  B |=I ÄÂˆ if and only if A |=K ÄÂˆ, where K is the  first special interval to the right of I.  We prove the claim by structural induction. If ÄÂˆ = p is a  proposition letter, the claim is immediate by the construction  of B; furthermore, the Boolean cases are trivial. So suppose  ÄÂˆ = [D]ÃÂ¸ (whence Ã‚Å¹ÄÂˆ, Ã‚Å¹ÃÂ¸ Ã¢ÂˆÂˆ ÃÅš). Pick any I Ã¢ÂˆÂˆ Sub(IA ), and  let K be the first special interval to the right of I. Suppose  first that B |=I ÄÂˆ. Then B |=J ÃÂ¸ for some J Ã¢ÂŠÂ† I. Let  K  be the first special interval to the right of J, so that,  by inductive hypothesis, A |=K  ÃÂ¸. Since K  Ã¢ÂŠÂ† J Ã¢ÂŠÂ† I, we  have A |=I Ã‚Å¹[D]ÃÂ¸; so let I  be the right-most witness for  Ã‚Å¹[D]ÃÂ¸ in the same row as I. By definition, I  is special, and  hence must lie (non-strictly) to the right of K; thus, I  Ã¢ÂŠÂ† K.  But then A |=K Ã‚Å¹[D]ÃÂ¸, i.e., A |=K ÄÂˆ. Conversely, suppose  A |=K ÄÂˆ. Then A |=J Ã‚Å¹ÃÂ¸ for some J Ã¢ÂŠÂ† K. So now let J   be the right-most witness for Ã‚Å¹ÃÂ¸ in the same row as J. By  definition, J  is special, and thus (trivially) the first special  interval to the right of J  , whence, by inductive hypothesis,  B |=J  Ã‚Å¹ÃÂ¸. But J  Ã¢ÂŠÂ† J Ã¢ÂŠÂ† K Ã¢ÂŠÂ† I, so that B |=I ÄÂˆ. This  completes the induction, and establishes the claim.  To conclude the proof, suppose A |=I ÄÂ•, and suppose,  without loss of generality, that I is the right-most witness for  ÄÂ• in its row. Thus, I is special, and, furthermore, is (trivially)  the first special interval to the right of I. Constructing B as  above, BI |= ÄÂ•. Finally, the claim shows that every row in  B realizes a profile of length no greater than the number of  special intervals in that row. But we have already noted that  this number is bounded by ÄÂ• + 1.  Now suppose ÃÄ…ÄšÂ„ = (ÃÄ…1 , . . . , ÃÄ…s ) and ÃË›ÄšÂ„ = (ÃË›1 , . . . , ÃË›t ) are  configurations. A solution for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„ is a pair uÄšÂ„, vÄšÂ„, where  uÄšÂ„ is a vector of length s and vÄšÂ„ a vector of length t, satisfying  the following conditions:  Us  ÃË›t  Figure 6.  The structure B of Lemma 4.  (j + 1)th rows of A, respectively. Then uÄšÂ„, vÄšÂ„ is a solution  for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„.  Proof: Numbering the cells of the jth row from left to  right (starting with 1), we observe that, for all h (1  h   |ÃÄ…ÄšÂ„|), the cells in positions UhÃ¢ÂˆÂ’1 + 1 to Uh all satisfy ÃÄ…h ;  similar remarks apply to row j +1. Conditions (S1)Ã¢Â€Â“(S2) are  then evident by inspection of Fig. 5, which depicts the two  rows of A in question. For condition (S3), note that Us = j,  Vt = j + 1 and, by assumption, vt > 0.  Lemma 4. Let ÃÄ…ÄšÂ„ and ÃË›ÄšÂ„ be configurations. Suppose that  uÄšÂ„, vÄšÂ„ is a solution for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„, and that A is a structure  whose top row realizes the profile ÃÄ…ÄšÂ„, uÄšÂ„. Then there exists  a structure B whose top row realizes the profile ÃË›ÄšÂ„, vÄšÂ„.  Proof: Write ÃË›ÄšÂ„ = (ÃË›1 , . . . , ÃË›t ), and let s = |ÃÄ…ÄšÂ„|. The  structure B shown in Fig. 6 has the required properties. A  label ÃË›h in a region indicates that all the intervals in that  region make true exactly the proposition letters ÃË›h Ã¢ÂˆÅ P. Condition (S3) guarantees that the dimensions of the rectangles  labelled ÃË›1 , . . . , ÃË›tÃ¢ÂˆÂ’1 are such that the Ã¢Â€Â˜trapeziumÃ¢Â€Â™ labelled  ÃË›t exists. In particular, each of the new rows (above the top  row of A) contains a final block of cells in the region labelled  ÃË›t . (This is important, because (ÃË›1 , . . . , ÃË›h ) need not be a  configuration for h < t.) Using Conditions (C1)Ã¢Â€Â“(C2) and  (S1)Ã¢Â€Â“(S2), a routine structural induction establishes that, for  all h (1  h  t), and any interval I lying in the region  labelled ÃË›h , B |=I ÃË›h .  Thus, Lemma 3 states that configurations belonging to  profiles realized by successive rows in a structure always  have a solution, while Lemma 4 provides a partial converse:  given a solution uÄšÂ„, vÄšÂ„ for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„, we can extend any structure whose top row realizes the profile ÃÄ…ÄšÂ„, uÄšÂ„ to one whose  top row realizes the profile ÃË›ÄšÂ„, vÄšÂ„ (notice that reflexivity of  the sub-interval relation plays an essential role in Lemma  4.3). Indeed, the next lemma allows us to create, ex nihilo,  a structure whose top-row realizes any profile of length 1.  Lemma 5. Let ÃÄ… be a 1-type such that DÄÂˆ Ã¢ÂˆÂˆ ÃÄ… implies  ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…, and let m be a positive integer. Then there exists a  structure A whose top row realizes the profile (ÃÄ…), (m).  Proof: Set IA = [1, m], and I A = ÃÄ… Ã¢ÂˆÅ  P for all I Ã¢ÂˆÂˆ  Sub(IA ).  The following sequence of lemmas shows that, if ÃÄ…ÄšÂ„, ÃË›ÄšÂ„  has one solution, then it has many.  Lemma 6. Let ÃÄ…ÄšÂ„ and ÃË›ÄšÂ„ be configurations, and m a positive  integer, and suppose that uÄšÂ„, vÄšÂ„ is a solution for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„. Then  muÄšÂ„, mvÄšÂ„ is also a solution for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„.  Proof: Satisfaction of inequalities x1 + Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ + xh  y1 +  Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ + yk and x1 + Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ + xh < y1 + Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ + yk is preserved  under multiplication by m.  Lemma 7. Let ÃÄ…ÄšÂ„ and ÃË›ÄšÂ„ be configurations, and suppose that  uÄšÂ„, vÄšÂ„ is a solution for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„. If uÄšÂ„ is a vector satisfying  uÄšÂ„  uÄšÂ„ , then there exists a vector vÄšÂ„  satisfying vÄšÂ„  vÄšÂ„  such  that uÄšÂ„ , vÄšÂ„   is a solution for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„.  Proof: It suffices to prove the lemma where uÄšÂ„ =  (u1 , . . . , us ), vÄšÂ„ = (v1 , . . . , vt ), and uÄšÂ„ = (u1 , . . . , uiÃ¢ÂˆÂ’1 ,  ui + 1, ui+1 , . . . , us ). Since Vt > Us , pick the least j  (1  j  t) such that Vj > UiÃ¢ÂˆÂ’1 , and set vÄšÂ„  =  (v1 , . . . , vjÃ¢ÂˆÂ’1 , vj + 1, vj+1 , . . . , vt ). It is then obvious that,  for all i (0  i  s) and all j (0  j  t), Ui > Vj if and  only if Ui > Vj .  Lemma 8. Let ÃÄ…ÄšÂ„ and ÃË›ÄšÂ„ be configurations, with |ÃÄ…ÄšÂ„| = s  m  and |ÃË›ÄšÂ„| = t  n, such that ÃÄ…ÄšÂ„, ÃË›ÄšÂ„ has a solution. Then ÃÄ…ÄšÂ„, ÃË›ÄšÂ„  has a solution uÄšÂ„, vÄšÂ„ satisfying uÄšÂ„  (n, . . . , n). Indeed, it  has a solution uÄšÂ„, vÄšÂ„ satisfying uÄšÂ„  (n, . . . , n) and vÄšÂ„   (m + 1, . . . , m + 1).  Proof: Let uÄšÂ„, vÄšÂ„ be a solution with uÄšÂ„ = (u1 , . . . , us )  and vÄšÂ„ = (v1 , . . . , vt ). For the first statement of the  lemma, suppose ui > n for some i (1  i  s).  We claim that there exists j (1  j  t) such that,  writing uÄšÂ„ = (u1 , . . . , uiÃ¢ÂˆÂ’1 , ui Ã¢ÂˆÂ’ 1, ui+1 , . . . , us ) and vÄšÂ„  =  (v1 , . . . , vjÃ¢ÂˆÂ’1 , vj Ã¢ÂˆÂ’1, vj+1 , . . . , vt ), uÄšÂ„ , vÄšÂ„   is also a solution.  By repeated applications of this claim, we obtain the desired  solution. The claim is obvious if n = 1; so assume n > 1  (whence ui  3). Now, since Vt > Us  UsÃ¢ÂˆÂ’1 + 1, let j   be the smallest positive integer such that Vj  > UiÃ¢ÂˆÂ’1 + 1.  If vj  > 1, then, since ui  3, setting j = j  gives the  required vÄšÂ„  . So suppose vj  = 1, in which case, we also  have j   2 and indeed Vj  = UiÃ¢ÂˆÂ’1 + 2. Since, in addition,  ui  n + 1, there exists j (j  < j  t) such that vj > 1 and  VjÃ¢ÂˆÂ’1  Ui Ã¢ÂˆÂ’ 2. Again, it is easy to check that this value of  j gives the required vÄšÂ„  . The second statement of the lemma  follows by an almost identical argument.  Lemma 9. Let ÃÄ…ÄšÂ„ and ÃË›ÄšÂ„ be configurations whose length  is bounded by a polynomial function of ÄÂ• . Then we can  determine, using space likewise bounded by a polynomial  function of ÄÂ• , whether ÃÄ…ÄšÂ„, ÃË›ÄšÂ„ has a solution.  Proof: Try all pairs of vectors uÄšÂ„, vÄšÂ„ satisfying the  bounds given in Lemma 8.  Lemma 10. Let ÃÄ…ÄšÂ„ and ÃË›ÄšÂ„ be configurations, with |ÃË›ÄšÂ„|  n,  such that ÃÄ…ÄšÂ„, ÃË›ÄšÂ„ has a solution; and let m be a positive  integer. For any vector uÄšÂ„ satisfying uÄšÂ„  (mn, . . . , mn),  there exists a vector vÄšÂ„ satisfying vÄšÂ„  (m, . . . , m), such that  uÄšÂ„, vÄšÂ„ is a solution for ÃÄ…ÄšÂ„, ÃË›ÄšÂ„.  Proof: By Lemma 8, let uÄšÂ„ , vÄšÂ„   be a solution satisfying  uÄšÂ„  (n, . . . n). By Lemma 6, muÄšÂ„ , mvÄšÂ„   is a solution, with  muÄšÂ„  uÄšÂ„, and (trivially) mvÄšÂ„   (m, . . . , m). By Lemma 7,  there exists a vector vÄšÂ„ with vÄšÂ„  mvÄšÂ„  such that uÄšÂ„, vÄšÂ„ is a  solution.  Define the directed graph GÄÂ• = (C, E) as follows:    C  = {ÃÄ…ÄšÂ„ | ÃÄ…ÄšÂ„ is a configuration s.t. |ÃÄ…ÄšÂ„|  ÄÂ• + 1}  E  = {ÃÄ…ÄšÂ„, ÃË›ÄšÂ„ Ã¢ÂˆÂˆ C 2 | ÃÄ…ÄšÂ„, ÃË›ÄšÂ„ has a solution}.  Since the number of 1-types is at most 2ÄÂ• , |C|  2n ,  where n = ÄÂ• ( ÄÂ• + 1). The main lemma of this section states necessary and sufficient conditions for ÄÂ• to be  satisfiable.  Lemma 11. Let ÄÂ• be an LD -formula, and let the graph  GÄÂ• = (C, E) be constructed as above. Then ÄÂ• is satisfiable  if and only if there is a path in GÄÂ• from some configuration  ÃÄ…ÄšÂ„ of length 1 to some configuration ÃË›ÄšÂ„ containing a 1-type  ÃË› such that ÄÂ• Ã¢ÂˆÂˆ ÃË›.  Proof: Suppose first that A is a model of ÄÂ•. By  Lemma 2, we may assume that each row of A realizes  some profile (ÃÄ…ÄšÂ„, uÄšÂ„) of length at most ÄÂ• + 1, so that  ÃÄ…ÄšÂ„ Ã¢ÂˆÂˆ C. The first row necessarily realizes a profile of  length 1; by Lemma 3, the configurations corresponding to  successive rows are joined by an edge in E; and, since A  is a model of ÄÂ•, some row of A realizes a profile in which  ÄÂ• occurs somewhere. That is: there is a path in GÄÂ• from  some configuration ÃÄ…ÄšÂ„ of length 1 to some configuration ÃË›ÄšÂ„  containing a 1-type ÃË› such that ÄÂ• Ã¢ÂˆÂˆ ÃË›.  Conversely, suppose there is a path ÃÄ…ÄšÂ„1 , . . . , ÃÄ…ÄšÂ„z in GÄÂ•  where: (i) ÃÄ…ÄšÂ„1 = (ÃÄ…) is a configuration of length 1; (ii)  ÃÄ…ÄšÂ„i , ÃÄ…ÄšÂ„i+1  is an edge of E for all i (1  i < z); and (iii)  ÃÄ…ÄšÂ„z contains a 1-type ÃË› such that ÄÂ• Ã¢ÂˆÂˆ ÃË›. Let n = ÄÂ• + 1.  By definition, each configuration in C is of length at most  n. We show by induction that, for all j (1  j  z), there  exists a structure Aj whose top row realizes a profile of the  form ÃÄ…ÄšÂ„j , uÄšÂ„, with uÄšÂ„  (nzÃ¢ÂˆÂ’j , . . . , nzÃ¢ÂˆÂ’j ). It follows that Az  is a model of ÄÂ•, proving the lemma.  Case j = 1: By Lemma 5, there exists a structure whose  top row realizes the profile (ÃÄ…), (nzÃ¢ÂˆÂ’1 ).  Case 1 < j  z: Suppose AjÃ¢ÂˆÂ’1 has been defined, and that  the top row of AjÃ¢ÂˆÂ’1 realizes the profile ÃÄ…ÄšÂ„jÃ¢ÂˆÂ’1 , uÄšÂ„jÃ¢ÂˆÂ’1 , with  uÄšÂ„jÃ¢ÂˆÂ’1  (nzÃ¢ÂˆÂ’j+1 , . . . , nzÃ¢ÂˆÂ’j+1 ). Since (ÃÄ…ÄšÂ„jÃ¢ÂˆÂ’1 , ÃÄ…ÄšÂ„j ) Ã¢ÂˆÂˆ E, the  pair ÃÄ…ÄšÂ„jÃ¢ÂˆÂ’1 , ÃÄ…ÄšÂ„j , has a solution, and hence, by Lemma 10,  a solution uÄšÂ„jÃ¢ÂˆÂ’1 , uÄšÂ„j  with uÄšÂ„j  (nzÃ¢ÂˆÂ’j , . . . , nzÃ¢ÂˆÂ’j ). By  Lemma 4, there exists a model Aj whose top row realizes  the profile ÃÄ…ÄšÂ„j , uÄšÂ„j . This completes the induction, and the  proof.  Theorem 12. The satisfiability problem for LD is in  PS PACE.  Proof: Denote ÄÂ• ( ÄÂ• + 1) by n, and consider the  following nondeterministic procedure  1. set N = 0;  2. guess a configuration ÃË›ÄšÂ„ of length 1;  3. until N = 2n or ÃË›ÄšÂ„ contains a 1-type ÃË› such that  ÄÂ• Ã¢ÂˆÂˆ ÃË› do:  4.  set ÃÄ…ÄšÂ„ = ÃË›ÄšÂ„ and increment N ;  5.  guess a configuration ÃË›ÄšÂ„ s.t. |ÃË›ÄšÂ„|  ÄÂ• + 1;  6.  if ÃÄ…ÄšÂ„, ÃË›ÄšÂ„ has no solution, then fail;  7. end until  8. if N = 2n then fail;  9. succeed.  By Lemma 9, the test in Line 6 requires only space bounded  by a polynomial function of ÄÂ• ; further, the counter N  requires only n + 1 bits. Evidently, the procedure has a  successful run if and only if there exists a path in GÄÂ• from  some configuration ÃÄ…ÄšÂ„ of length 1 to some configuration ÃË›ÄšÂ„  containing a 1-type ÃË› such that ÄÂ• Ã¢ÂˆÂˆ ÃË›. The result then  follows by Lemma 11 and SavitchÃ¢Â€Â™s theorem.  V. A DDING THE O PERATOR [DÄšÂ„]  In this section, we show how to generalize Theorem 12 to  the satisfiability problem for LDDÄšÂ„ over finite linear orders  (LDÄšÂ„ is just a special case). First, we modify the definitions  of configuration and profile by adding to conditions (C1)Ã¢Â€Â“  (C2) the further condition:  (C3) if 1  h < h  s and [DÄšÂ„]ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h , [DÄšÂ„]ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h .  Next, we prove an analogue of Lemma 2.  Lemma 13. If an LDDÄšÂ„ -formula ÄÂ• has a model, then it has  a model over the same domain in which every row realizes  a profile of length at most 4 ÄÂ• + 3.  Proof: Fix a model A of ÄÂ•. If ÄÂˆ Ã¢ÂˆÂˆ ÃÅš, a witness for  ÄÂˆ is an interval I Ã¢ÂˆÂˆ Sub(IA ) such that A |=I ÄÂˆ. We call  an interval I = [i, j] Ã¢ÂˆÂˆ Sub(IA ) right (resp., left) special if  there exists ÄÂˆ Ã¢ÂˆÂˆ ÃÅš such that A |=I ÄÂˆ and, for all k (i < k   j) (resp., (1  k < i)) A |=[k,j] ÄÂˆÃ¢Â€Â”that is, if there is some  formula of ÃÅš for which I is the right-most (resp., left-most)  witness in its row. A special interval is a right special or  left special interval. Evidently, for any I = [i, j] Ã¢ÂˆÂˆ Sub(IA ),  there is a least k (i  k  j) (resp., greatest k  (1  k  < i))  such that Kr = [k, j] (resp., Kl = [k  , j]) is special. We refer  to Kr (resp., Kl ) as the closest-to-the-right (resp., closestto-the-left) special intervals for I. Finally, since |ÃÅš|  2 ÄÂ• ,  and the right-most (resp., left-most) interval of any row is  the right-most (resp., left-most) witness for at least |ÃÅš|/2 of  the formulas of ÃÅš in that row, it follows that the number of  special intervals in any row is at most 2 ÄÂ• + 2.  Let f : Sub(IA ) Ã¢Â†Â’ Sub(IA ) be a function that satisfies  the following properties:  (F1) for every special interval I, f (I) = I;  (F2) for every non-special interval I, f (I) = I  , where I  is  a non-special interval such that the closest-to-the-left  and closest-to-the-right special intervals for I and I   are the same;  (F3) for every pair of non-special intervals I, I  , if the  closest-to-the-left and closest-to-the-right special intervals for I and I  are the same, then f (I) = f (I  ).  Observe that, for any ÄÂˆ = [D]ÃÂ¸ Ã¢ÂˆÂˆ ÃÅš and any I Ã¢ÂˆÂˆ Sub(IA ),  A |=I ÄÂˆ if and only if A |=f (I) ÄÂˆ; similarly for ÄÂˆ = [DÄšÂ„]ÃÂ¸.  Let B be a structure with the same domain as A (that is,  Sub(IB ) = Sub(IA )) such that I B = f (I)A . We claim that,  for every I Ã¢ÂˆÂˆ Sub(IA ) and every ÄÂˆ Ã¢ÂˆÂˆ ÃÅš:  B |=I ÄÂˆ if and only if A |=f (I) ÄÂˆ.  We prove the claim by structural induction. If ÄÂˆ = p is a  proposition letter, the claim is immediate by the construction  of B. Boolean cases are trivial. So suppose ÄÂˆ = [D]ÃÂ¸  (whence Ã‚Å¹ÄÂˆ, Ã‚Å¹ÃÂ¸ Ã¢ÂˆÂˆ ÃÅš). Pick I Ã¢ÂˆÂˆ Sub(IA ), and let f (I) = I  .  For the left-to-right implication, suppose that A |=I  Ã‚Å¹ÄÂˆ.  Let K be the right-most witness for Ã‚Å¹ÄÂˆ in the same row  as I. Since K is special and non-strictly to the right of I  ,  we have K Ã¢ÂŠÂ† I. Now, there exists an interval KÄšÂ„ such that  KÄšÂ„ Ã¢ÂŠÂ† K, A |=KÄšÂ„ Ã‚Å¹ÃÂ¸, and KÄšÂ„ is the right-most witness for  Ã‚Å¹ÃÂ¸ in its row. Since KÄšÂ„ is special, f (KÄšÂ„) = KÄšÂ„, and thus,  by inductive hypothesis, B |=KÄšÂ„ Ã‚Å¹ÃÂ¸, whence B |=I Ã‚Å¹ÄÂˆ.  Conversely, suppose B |=I Ã‚Å¹ÄÂˆ. Then, there exists J Ã¢ÂŠÂ† I  such that B |=J Ã‚Å¹ÃÂ¸, whence A |=f (J) Ã‚Å¹ÃÂ¸, by inductive  hypothesis. Let K be the right-most witness for Ã‚Å¹ÃÂ¸ in the  same row as J. Since K is special and non-strictly to the  right of f (J), we have K Ã¢ÂŠÂ† J, whence A |=I Ã‚Å¹[D]ÃÂ¸. But  we have already observed that A |=I [D]ÃÂ¸ if and only if  A |=f (I) [D]ÃÂ¸. Hence, A |=f (I) Ã‚Å¹ÄÂˆ as required. The case  ÄÂˆ = [DÄšÂ„]ÃÂ¸ is completely symmetric.  Now, suppose A |=I ÄÂ•. We may assume without loss  of generality that I is special, whence I = f (I), so that,  constructing B as above, B |=I ÄÂ•. To conclude the proof,  it suffices to observe that every row in B realizes a profile  that features one 1-type for every special interval in that row  (at most 2 ÄÂ• +2) plus at most one 1-type for every maximal  consecutive sequence of non-special intervals in that row (at  most 2 ÄÂ• + 1).  Next, we modify the definition of a solution for a pair  of configurations ÃÄ…ÄšÂ„, ÃË›ÄšÂ„, given in Section IV, by adding to  conditions (S1)Ã¢Â€Â“(S3) the further conditions  (S4) for all h (1  h  s) and all h (1  h  t), if  [DÄšÂ„]ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h and Uh > Vh Ã¢ÂˆÂ’1 , then [DÄšÂ„]ÄÂˆ Ã¢ÂˆÂˆ ÃË›h ;  (S5) for all h (1  h  s), if DÄšÂ„ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h , either there  exists h (1  h  h) such that ÄÂˆ Ã¢ÂˆÂˆ ÃÄ…h , or there  exists h (1  h  t) such that Vh Ã¢ÂˆÂ’1  UhÃ¢ÂˆÂ’1 and  DÄšÂ„ÄÂˆ Ã¢ÂˆÂˆ ÃË›h .  We construct the graph GÄÂ• exactly as described in Section IV, except that we employ the revised definitions of  configuration and solution, and set  C = {ÃÄ…ÄšÂ„ | ÃÄ…ÄšÂ„ is a configuration s.t. |ÃÄ…ÄšÂ„|  4 ÄÂ• + 3}.  In place of Lemma 11, we then have:  Lemma 14. Let ÄÂ• be an LDDÄšÂ„ -formula, and let the graph  GÄÂ• = (C, E) be constructed as above. Then ÄÂ• is satisfiable  over finite linear orders if and only if there is a path in GÄÂ•  from some configuration ÃÄ… of length 1 to some configuration  ÃË›ÄšÂ„ containing a 1-type ÃË› such that ÄÂ• Ã¢ÂˆÂˆ ÃË›, and a path in GÄÂ•  from ÃË›ÄšÂ„ to some configuration (ÃÅ‚1 , . . . , ÃÅ‚k ) such that, for  every j (1  j  k) and every DÄšÂ„ÄÂˆ Ã¢ÂˆÂˆ ÃÅ‚j , there exists j   (1  j   j) with ÄÂˆ Ã¢ÂˆÂˆ ÃÅ‚j  .  The following theorem is the counterpart of Theorem 12  for LDDÄšÂ„ , and may be proved similarly.  Theorem 15. The satisfiability problem for LDDÄšÂ„ is in  PS PACE.  VI. C ONCLUSIONS  In this paper, we have shown that the satisfiability problems for the interval logics of the reflexive sub-interval and  super-interval relations interpreted over finite linear orders  are PS PACE-complete. The authors are currently investigating the problem of establishing whether decidability, and  complexity, of LDDÄšÂ„ are preserved if we replace finite linear  orders by the natural numbers or the integers. The problem  is of interest, because, as is easily shown, DÄšÂ„ can be used to  write formulas satisfiable over infinite discrete linear orders,  but not over finite linear orders. As we have already pointed  out, some basic steps of our proof do not work if we replace  reflexive sub-interval and super-interval relations by strict or  proper ones. To the best of our knowledge, the satisfiability problems for interval logics of the strict (respectively,  proper) sub-interval and super-interval relations, interpreted  over finite linear orders, are still open.  ACKNOWLEDGMENTS  This paper resulted from a visit of the first and third  authors to Manchester University in January 2010, funded by  the ESF Research Networking Programme GAMES (Games  for Design and Verification). The same authors acknowledge the support of the Italian PRIN and GNCS projects  Innovative and multi-disciplinary approaches for constraint  and preference reasoning and Logics, automata, and games  for the formal verification of complex systems. The second  author acknowledges the support of the EPSRC, grant reference EP/E035248.  R EFERENCES  [1] V. Goranko, A. Montanari, and G. Sciavicco, Ã¢Â€ÂœA road map  of interval temporal logics and duration calculi,Ã¢Â€Â Journal of  Applied Non-Classical Logics, vol. 14, no. 1Ã¢Â€Â“2, pp. 9Ã¢Â€Â“54,  2004.  [2] J. Halpern and Y. Shoham, Ã¢Â€ÂœA propositional modal logic of  time intervals,Ã¢Â€Â Journal of the ACM, vol. 38, pp. 279Ã¢Â€Â“292,  1991.  [3] Y. Venema, Ã¢Â€ÂœA modal logic for chopping intervals,Ã¢Â€Â Journal  of Logic and Computation, vol. 1, no. 4, pp. 453Ã¢Â€Â“476, 1991.  [4] D. Bresolin, V. Goranko, A. Montanari, and G. Sciavicco,  Ã¢Â€ÂœPropositional interval neighborhood logics: expressiveness,  decidability, and undecidable extensions,Ã¢Â€Â Annals of Pure and  Applied Logic, vol. 161, no. 3, pp. 289Ã¢Â€Â“304, 2009.  [5] D. Bresolin, V. Goranko, A. Montanari, and P. Sala, Ã¢Â€ÂœTableaux  for logics of subinterval structures over dense orderings,Ã¢Â€Â  Journal of Logic and Computation, vol. 20, no. 1, pp. 133Ã¢Â€Â“  166, 2010.  [6] M. Otto, Ã¢Â€ÂœTwo variable first-order logic over ordered domains,Ã¢Â€Â Journal of Symbolic Logic, vol. 66, no. 2, pp. 685Ã¢Â€Â“  702, 2001.  [7] D. Bresolin, D. Della Monica, V. Goranko, A. Montanari,  and G. Sciavicco, Ã¢Â€ÂœDecidable and undecidable fragments of  Halpern and ShohamÃ¢Â€Â™s interval temporal logic: towards a  complete classification,Ã¢Â€Â in Proc. of the 15th International  Conference on Logic for Programming, Artificial Intelligence,  and Reasoning, ser. LNCS, vol. 5330. Springer, 2008, pp.  590Ã¢Â€Â“604.  [8] A. Montanari, G. Puppis, and P. Sala, Ã¢Â€ÂœMaximal decidable  fragments of Halpern and ShohamÃ¢Â€Â™s modal logic of intervals,Ã¢Â€Â  in Proc. of the 37th International Colloquium on Automata,  Languages and Programming, 2010.  [9] J. van Benthem, The Logic of Time: A Model-Theoretic  Investigation into the Varieties of Temporal Ontology and  Temporal Discourse, Second Edition. Kluver, 1991.  [10] I. Shapirovsky and V. Shehtman, Ã¢Â€ÂœChronological future  modality in Minkowski spacetime,Ã¢Â€Â in Advances in Modal  Logic. London: KingÃ¢Â€Â™s College Publications, 2003, vol. 4,  pp. 437Ã¢Â€Â“459.  [11] I. Shapirovsky, Ã¢Â€ÂœOn PSPACE-decidability in Transitive Modal  Logic,Ã¢Â€Â in Advances in Modal Logic. London: KingÃ¢Â€Â™s College  Publications, 2005, vol. 5, pp. 269Ã¢Â€Â“287.  [12] E. Kieronski, J. Marcinkowski, and J. Michaliszyn, Ã¢Â€ÂœB and D  are enough to make the Halpern-Shoham logic undecidable,Ã¢Â€Â  in Proc. of the 37th International Colloquium on Automata,  Languages and Programming, 2010.  [13] K. Segerberg, Ã¢Â€ÂœAn essay in classical modal logic,Ã¢Â€Â Filosofiska  Studier, vol. 13, 1971.  [14] L. J. Stockmeyer and A. Meyer, Ã¢Â€ÂœWord problems requiring  exponential time,Ã¢Â€Â in Proc. of the 5th ACM Symposium on the  Theory of Computing, 1973, pp. 1Ã¢Â€Â“9. 