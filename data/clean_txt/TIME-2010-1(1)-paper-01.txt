Decidability of the Logics of the Reflexive Sub-interval  and Super-interval Relations over Finite Linear Orders  Angelo Montanari  Dept. of Mathematics and  Computer Science  University of Udine, Italy  angelo.montanari@uniud.it  Ian Pratt-Hartmann  School of Computer Science  Manchester University, UK  ipratt@cs.man.ac.uk  AbstractâAn interval temporal logic is a propositional, multimodal logic interpreted over interval structures of partial  orders. The semantics of each modal operator are given in the  standard way with respect to one of the natural accessibility  relations defined on such interval structures. In this paper,  we consider the modal operators based on the (reflexive) subinterval relation and the (reflexive) super-interval relation. We  show that the satisfiability problems for the interval temporal  logics featuring either or both of these modalities, interpreted  over interval structures of finite linear orders, are all PS PACEcomplete. These results fill a gap in the known complexity  results for interval temporal logics.  Keywords-interval temporal logic; decidability; computational complexity  I. I NTRODUCTION  Interval temporal logics provide a natural framework for  representing and reasoning about temporal properties in  many areas of computer science, including formal specification and verification of reactive systems, temporal databases,  knowledge representation, and natural language semantics  [1]. For many years, the discouragingly high computational  complexity of these logics impeded their systematic investigation. (As an example, Halpern and Shohamâs modal  logic of time interval HS [2] and Venemaâs CDT logic [3]  are highly undecidable.) Recently, however, the discovery  of expressive decidable fragments of HS has generated  renewed interest in this subject. The most significant of these  fragments are the logics of temporal neighbourhood [4] and  the logics of sub-interval and super-interval structures [5].  Decidability of temporal neighbourhood logics over various  classes of linear orders can be proved by reducing their  satisfiability problems to that of the two-variable fragment  of first-order logic over the same classes of linear orders  [6]. In fact, neighbourhood temporal logic turns out to be a  maximal decidable fragment of HS, when interpreted over  any class of linear orders that contains at least one linear  order with an infinitely ascending/descending sequence [4],  [7], [8]. In this paper, we focus on interval logics of subinterval and super-interval structures.  There are three natural definitions of the sub-interval  Pietro Sala  Dept. of Mathematics and  Computer Science  University of Verona, Italy  pietro.sala@univr.it  relation [5]: reflexive  (the current interval is a sub-interval  of itself), proper  (sub-intervals share at most one endpoint  with the current interval), and strict   Âˇ (both endpoints of  the sub-intervals are strictly inside the current interval).  And interval temporal logics based on all of these versions  of the sub-interval relationâinterpreted over the class of  dense linear ordersâhave been studied in the literature.  Thus, the logic D of reflexive sub-intervals is studied by  van Benthem in [9], where it is proved to be equivalent  to the standard modal logic S4. In [10], Shapirovsky and  Shehtman establish a connection between the logic of strict  sub-intervals DÂˇ and the logic of Minkowski space-time.  They provide a sound and complete axiomatic system for  DÂˇ ; moreover, they prove PS PACE-completeness of DÂˇ  by means of a suitable filtration technique [10], [11]. An  optimal tableau system for DÂˇ is given by Bresolin et al in  [5]. Finally, the logic D is treated extensively in [5]. The  authors prove decidability and PS PACE-completeness of D ,  and provide an optimal tableau system.  All of the above results concern logics interpreted over  dense linear orders; and the question naturally arises as  to what happens if we consider classes of discrete orders  instead. In this paper, we go some way to answering this  question. Specifically, we study the satisfiability problem of  interval temporal logics based on the reflexive sub-interval  and super-interval relations interpreted over finite linear  orders.  The paper is organized as follows. In Section II, we  give the syntax and semantics of three propositional modal  languages: LD , featuring the modal operator [D], LDĚ ,  featuring the modal operator [DĚ], and LD,DĚ , featuring both  operators. Informally, we read [D]Ď as âĎ is true at all subintervals of the current intervalâ, and [DĚ]Ď as âĎ is true at all  super-intervals of the current intervalâ. We interpret all three  languages over the class of finite linear orders. In Section III,  we prove PS PACE-hardness of the satisfiability problem for  LD and LDĚ , by reduction from the satisfiability problem for  quantified Boolean formulas. In Section IV, we prove that  the satisfiability problem for LD is in PS PACE. In Section  V, we generalize this latter result to LDDĚ . It can easily be  1, m  m, m  i, j  so  @  Rsq , q  @  p1 , p s  1  ?  ?  s q2 , q  p2 , p s  j, j  [i, j]  i, i  i  j  Figure 2.  A relational frame satisfying (1)â(10).  1, 1  Figure 1.  Geometrical depiction of intervals.  shown that the proposed techniques cannot be directly lifted  to the strict and proper cases. Moreover, the undecidability  of various extensions of the logics of sub-interval and superinterval structures has been recently proved [4], [7], [12].  II. P RELIMINARIES  Fix a set P of proposition letters, and denote its power  set by P(P). The language LD is defined to be the smallest  set of expressions satisfying:  (i) P â LD ;  (ii) if Ď, Ď â LD , then Ď â§ Ď, ÂŹĎ, [D]Ď â LD .  The language LDĚ is defined similarly, but with [DĚ] in place  of [D]; the language LDDĚ contains both modalities.  In the following, we employ the usual abbreviations Ď â¨  Ď (for ÂŹ(ÂŹĎ â§ ÂŹĎ)), DĎ (for ÂŹ[D]ÂŹĎ), and DĚĎ (for  ÂŹ[DĚ]ÂŹĎ). We denote by Ď the total number of symbols  occurring in Ď. For the purposes of this paper, an interval  is a set of the form {h â N | i  h  j}, where i, j are  positive integers with i  j; we write [i, j] to denote this  interval. Note that intervals are finite and non-empty, but  may be singletons. If I is an interval, we write Sub(I) to  denote the set of intervals J such that J â I. A structure  is a pair A = (IA , ÂˇA ), where IA = [1, m] for some m  1,  and ÂˇA is a function from Sub(IA ) to P(P). We refer to  IA as the domain of A, m as the size of A, and ÂˇA as the  interpretation function of A. We define a truth-relation for  LDDĚ -formulas (hence for LD -formulas and LDĚ -formulas),  relative to structures A and intervals I â IA , as follows:  (i) for p â P, A |=I p if and only if p â I A ;  (ii) the usual rules for â§ and ÂŹ;  (iii) A |=I [D]Ď if and only if, for all intervals J â I,  A |=J Ď;  (iv) A |=I [DĚ]Ď if and only if, for all intervals J â Sub(IA )  such that J â I, A |=J Ď.  If ÎŚ is a set of formulas, we write A |=I ÎŚ if A |=I Ď for  all Ď â ÎŚ. If A |=I Ď for some I â Sub(IA ), we say that  A is a model of Ď. If Ď has a model, then Ď is satisfiable;  if ÂŹĎ has no model, then Ď is valid. We denote the set of  valid LD -formulas by D.  If I = [1, m], it is useful to depict Sub(I) as the upper  left-hand half of an m Ă m integer grid, as shown in Fig. 1,  where each interval [i, j] â Sub(I) corresponds to the cell  in the grid having co-ordinates i, j. In this representation,  all intervals sharing a common end-point j lie in the jth row  (counting from the bottom upwards), all intervals sharing a  common start-point i lie in the ith column (counting leftto-right), and all singleton intervals [i, i] lie on the diagonal  section of the boundary. Motivated by this representation, if  A is a structure of size m, and 1  j  m, then we refer to  the set of intervals {[i, j] | for some i (1  i  j)} as the  jth row of A, and to the interval [i, j] as the ith cell in that  row. We refer to the mth row of A as the top row.  Evidently, we may identify LD with the language of  propositional modal logic, where [D] replaces the modal  operator ; and it is natural to ask how D is related,  under this identification, to the modal logics of various  familiar frame-classes. Thus, for example, it is easy to show  that every satisfiable LD -formula (using the semantics for  LD given above) has a relational (Kripke) model over a  finite, reflexive, transitive tree. Since the logic S4Grz is  known to be sound and complete for the class of finite,  reflexive, transitive trees [13, p. 101], we have S4Grz â D.  However, a little thought shows that this inclusion is strict.  For consider the following set of LD -formulas featuring the  proposition letters o, p, q, p1 , p2 , q1 and q2 :  o  (1)  [D](o â¨ p1 â¨ p2 â¨ q1 â¨ q2 )  [D](o â D(p1 â§ ÂŹo) â§ D(q1 â§ ÂŹo))  (2)  (3)  [D](p1 â D(p2 â§ ÂŹp1 ))  [D](q1 â D(q2 â§ ÂŹq1 ))  (4)  (5)  [D](p1 â¨ p2 â p)  [D](q1 â¨ q2 â q)  [D]ÂŹ(p â§ q)  (6)  (7)  (8)  [D](p â [D]p)  [D](q â [D]q).  (9)  (10)  The corresponding -formulas are easily seen to be satisfied  at the root of the reflexive, transitive tree with two depth-3  branches illustrated in Fig. 2 (where only the true proposition  letters are indicated); hence these formulas are S4Grzconsistent.  Now suppose (1)â(10) are true at an interval I in some  structure A (under LD -semantics). From (3)â(5), every sub-  interval of I satisfying o has length at least 3, and every  sub-interval of I satisfying p1 or q1 , length at least 2. Hence,  by (2), all unit-length sub-intervals of I satisfy either p2 or  q2 , and by (6)â(8), no such interval satisfies both. By (1),  (3)â(7) and (9)â(10), there exists at least one unit-length  subinterval of I satisfying p2 and similarly for q2 . Therefore,  we can find adjacent unit-length intervals, say, Jp satisfying  p2 and Jq , satisfying q2 . Now consider the length-2 interval  J which includes Jp and Jq . Since J is of length less than  3, J cannot satisfy o; since Jp satisfies p by (6), J cannot  satisfy q1 or q2 by (7)â(8) and (10); likewise, J cannot  satisfy p1 or p2 by (6) and (8)â(9). This falsifies (2).  q0  Î¸ = Q1 p1 . . . Qn pn Ď,  (11)  where Ď is a formula of propositional logic and, for all i (1   i  n), Qi is either â or â. Given a truth-value assignment to  its free variables, Î¸ is assigned a truth-value in the obvious  way; in particular, if Î¸ is closed (has no free variables), it is  either true or false simpliciter. The problem of determining  the truth-value of closed quantified Boolean formulas was  shown to be PS PACE-complete in [14].  Theorem 1. The satisfiability problems for LD -formulas  and LDĚ -formulas over finite linear orders are both PS PACEhard.  Proof: By (logarithmic space) reduction from the satisfiability problem for quantified Boolean formulas. Let the  quantified Boolean formula Î¸, of the form (11), be given,  where Ď is a formula of propositional logic featuring only  the proposition letters p1 , . . . , pn . We construct an LD formula Î¸Ě, and show that Î¸Ě is satisfiable over finite linear  orders if and only if Î¸ is true. For all i (0  i  n), define Î¸i  to be the formula Qi+1 pi+1 . . . Qn pn Ď, with free variables  p1 , . . . , pi . Thus, Î¸0 = Î¸ and Î¸n = Ď.  The LD -formula Î¸Ě will feature the proposition letters p1 , . . . , pn together with additional proposition letters  q0 , . . . , qn . We define Î¸Ě to be the conjunction of the following set of formulas:  q0  (1  j  i < k  n)  [D](qi â§ pj â [D](qk â pj ))  [D](qi â§ ÂŹpj â [D](qk â ÂŹpj )) (1  j  i < k  n)  (0  i < n)  [D](qi â Dqi+1 )  (0  i < n, Qi+1 = â)  [D](qi â D(qi+1 â§ pi+1 )  [D](qi â D(qi+1 â§ ÂŹpi+1 )  (0  i < n, Qi+1 = â)  (12)  (13)  (14)  (15)  (16)  (17)  q3 , p 3  q2 ,ÂŹp2  q4 ,ÂŹp4  q3 ,ÂŹp3  q4 , p 4  q1 ,ÂŹp1  q2 , p 2  q3 , p 3  q3 ,ÂŹp3  q4 , p 4  p3 /0  ÂŹp1 , p2 , ÂŹp3  â  p1 /1  ÂŹp1  ÂŹp1 , p2  p4 /1  Figure 3.  p1 /0  p2 /1  q4 ,ÂŹp4  III. L OWER B OUND  The task of this section is to establish the PS PACEhardness of the satisfiability problems for D and D over  finite linear orders. The argument is straightforward, and  proceeds by reduction from the satisfiability problem for  quantified Boolean formulas, the canonical PS PACE-hard  problem. Recall, in this context, that a quantified Boolean  formula is an expression of the form  q1 , p 1  p3 /1  ÂŹp1 , p2 , p3  p4 /0  p1  p3 /0  p2 /0  p1 , ÂŹp2  p1 , ÂŹp2 , ÂŹp3  p4 /1  p3 /1  p1 , ÂŹp2 , p3  p4 /0  ÂŹp1 , p2 ,  ÂŹp1 , p2 ,  p1 , ÂŹp2 ,  p1 , ÂŹp2 ,  ÂŹp3 , p4  p3 , ÂŹp4  ÂŹp3 , p4  p3 , ÂŹp4  A tree-model and its embedding into a grid structure.  [D](qn â Ď)  (18)  It is routine to check that the construction of Î¸Ě requires only  space bounded by a logarithmic function of Î¸ . Suppose  A |=I0 Î¸Ě. We think of the truth of a proposition letter qi  (0  i < n) at an interval as indicating that the quantifier  Qi+1 is being âconsideredâ. Formula (12) starts the process  by considering Q1 . Now, suppose A |=I qi , where 0  i < n  and I â I0 . By Formulas (13) and (14), every sub-interval of  I satisfying qk (k > i) must agree with I on the truth-values  assigned to p1 , . . . , pi ; thus these proposition letters may be  regarded as fixed for all such intervals. If Qi+1 = â, then,  by Formulas (15), I has a sub-interval J satisfying qi+1 (at  which pi+1 must be either true or false); on the other hand,  if Qi+1 = â, then, by Formulas (16) and (17), I has two  sub-intervals satisfying qi+1 : one in which pi+1 is true, and  one in which pi+1 is false. Finally, Formula (18) ensures  that, if I â I0 and A |=I qn , then Ď is true at I. Now,  any I â I0 such that A |=I qi defines a natural truth-value  assignment Î˝I with domain {p1 , . . . , pi } obtained by taking  Î˝(pj ) =  just in case A |=I pj , for all j (1  j  i).  Using a (backwards) inductive argument, we claim that, if  I â I0 and A |=I qi , then Î˝I |= Î¸i . For i = n, the claim is  guaranteed by Formula (18). Assuming the result holds for  i (0 < i  n) Formulas (13), (14), (16) and (17) guarantee  that it holds for i â 1 if Qi = â, and Formulas (13)â(15) do  the same if Qi = â. Formula (12) then guarantees that Î¸ is  true.  Conversely, suppose Î¸ is true. We define a tree tr(Î¸) as  follows. Each node Î˝ of tr(Î¸) will be a truth-value assignment with domain {p1 , . . . , pi } for some i (0  i  n),  with the property that Î˝ |= Î¸i ; we call i the level of  Î˝. We take the root node Î˝0 of tr(Î¸) to be the empty  assignment (i.e., the unique assignment with level 0). Since  Î¸ = Î¸0 is a true formula with no free variables, we have  Î˝0 |= Î¸0 . Suppose now that Î˝ is a node of tr(Î¸), with level i  (0  i < n), such that Î˝ |= Î¸i . If Î¸i = âpi+1 Î¸i+1 , let Î˝  be  an assignment with domain {p1 , . . . , pi+1 } such that Î˝ â Î˝  ,  and Î˝  |= Î¸i+1 ; we then take Î˝  to be the sole daughter  of Î˝ in tr(Î¸). If, on the other hand, Î¸i = âpi+1 Î¸i+1 , let  Î˝  = Î˝ âŞ {pi+1 â }, Î˝  = Î˝ âŞ {pi+1 â âĽ}, and take Î˝   and Î˝  to be the daughters of Î˝ in tr(Î¸); evidently, Î˝  |= Î¸i+1  and Î˝  |= Î¸i+1 . This completes the definition of tr(Î¸). Note  that, in particular, if Î˝ is a node with level n, then Î˝ |= Î¸n ;  i.e., Î˝ |= Ď.  A straightforward induction on n shows that, setting m =  2n+1 , we may define an embedding f : tr(Î¸) â Sub([1, m])  in such a way that f (Î˝) â f (Î˝  ) if and only if Î˝ is a  descendant of Î˝  in tr(Î¸). This is illustrated by the lefthand diagram in Fig. 3, where a tree-model for the QBF  formula Î¸ = âp1 âp2 âp3 âp4 (p1 â¨ p2 ) â§ (ÂŹp1 â¨ ÂŹp2 ) â§ (p3 â¨  p4 ) â§ (ÂŹp3 â¨ ÂŹp4 ) is given, together with its embedding  into a grid structure. To show that Î¸Ě is satisfiable, define  A with domain [1, m] as follows. For all i (0  i  n),  we set A |=I qi if and only if I = f (Î˝) for some node  Î˝ of tr(Î¸) with level i. Further, for each node Î˝ with level  i, and each j (1  j  i), we set A |=f (Î˝) pj if and  only if Î˝(pj ) = . The truth-values of the other proposition  letters may be assigned arbitrarily. It is then obvious that  A |=f (Î˝0 ) Î¸Ě. An example of this construction is shown in  the right-hand diagram of Fig. 3.  By replacing every occurrence of [D] with [DĚ], we  similarly establish the PS PACE-hardness of LDĚ .  IV. U PPER B OUND  The task of this section is to establish the membership in  PS PACE of the satisfiability problem for LD -formulas over  the class of finite linear orders.  Fix an LD -formula Ď. Let ÎŚ be the set of all sub-formulas  of Ď (including Ď itself), and let ÎŚ be the set of all formulas  Ď or ÂŹĎ, where Ď â ÎŚ . A 1-type is a subset Îą â ÎŚ  satisfying the properties:  (T1) for all formulas ÂŹĎ â ÎŚ, either Ď â Îą or ÂŹĎ â Îą;  (T2) Îą is propositionally consistent;  (T3) if [D]Ď â Îą, then Ď â Îą.  Let A be a structure and I â Sub(IA ). Evidently, there is a  unique 1-type Îą such that A |=I Îą; we say that A realizes  Îą at I.  For the purposes of this paper, a vector is a finite, nonempty sequence of positive integers. The following notation  will be used. If wĚ = (w1 , . . . , ws ) is a vector of length s, we  write |wĚ| = s, and if m is a positive integer, we write mwĚ for  the vector (mw1 , . . . , mws ). If vĚ = (v1 , . . . , vs ) is a vector  of the same length, we write wĚ  vĚ (equivalently: vĚ  wĚ) if  wi  vi for all i (1  i  s). Less conventionally, we take  corresponding upper-case letters to denote the successive  partial sums of vectors, thus: Wi = w1 + Âˇ Âˇ Âˇ + wi , for all i  (0  i  s). Note that, for any vector wĚ, W0 = 0.  Let A be a structure of size m, I1 , . . . , Is , a selection  of intervals in IA occurring left-to right across a single  wi  w1  Îą1  Figure 4.  ÂˇÂˇÂˇ  Îą1  ÂˇÂˇÂˇ  Îąi  ÂˇÂˇÂˇ  ws  Îąi  ÂˇÂˇÂˇ  Îąs  ÂˇÂˇÂˇ  Îąs  Geometrical depiction of the realization of a profile by a row.  row in the grid-representation of Sub(IA ), and Îą1 , . . . , Îąs  the respective 1-types realized in A by these intervals. In  addition, suppose that the final cell in that row realizes Îąs .  Evidently:  (C1) if 1  h < h  s and [D]Ď â Îąh , then [D]Ď â Îąh ;  (C2) if DĎ â Îąs , then Ď â Îąs .  Accordingly, we say that a configuration is a finite, nonempty sequence ÎąĚ = (Îą1 , . . . , Îąs ) of 1-types satisfying  conditions (C1) and (C2). Again, we denote the length of  this sequence by |ÎąĚ|. A profile is a pair ÎąĚ, wĚ, where ÎąĚ is  a configuration of length s  1, and wĚ = (w1 , . . . , ws ) a  vector, also of length s; we say that the length of this profile  is s. For 1  j  m, we say that the jth row of A realizes the  profile (Îą1 , . . . , Îąs ), (w1 , . . . , ws ) if Ws = j and, for all h  (1  h  s) and all i (Whâ1 < i  Wh ), A |=[i,j] Îąh . Pictorially, this means that the successive 1-types Îą1 , . . . , Îąs are  realized horizontally in uniform blocks of length w1 , . . . , ws ,  respectively, and that these blocks cover the entire row, as  shown in Fig. 4. For all j (1  j  m), the jth row of A  obviously realizes at least one profile; however, since there is  no requirement that neighbouring Îąi are distinct, this profile  will not in general be unique.  The following lemma shows that we may, without loss of  generality, confine attention to âshortâ profiles.  Lemma 2. If an LD -formula Ď has a model, then it has a  model over the same domain in which every row realizes a  profile of length at most Ď + 1.  Proof: Fix a model A of Ď, of size m. If Ď â ÎŚ, a  witness for Ď is an interval I â Sub(IA ) such that A |=I Ď.  We call an interval I = [i, j] â Sub(IA ) special if there  exists Ď â ÎŚ such that A |=I Ď and, for all k (i < k  j)  A |=[k,j] Ďâthat is, if there is some formula of ÎŚ for which  I is the right-most witness in its row. Since every singleton  interval, [j, j], is special, it follows that, for any I = [i, j] â  Sub(IA ), there is a least k (i  k  j) such that K = [k, j]  is special. We refer to K as the first special interval to the  right of I. Evidently, K = I if and only if I is itself special.  Moreover, since |ÎŚ|  2 Ď , and the right-most interval of  any row is the right-most witness for at least |ÎŚ|/2 of the  formulas of ÎŚ in that row, it follows that the number of  special intervals in any row is at most Ď + 1.  Now define the structure B, over the same domain as A,  by setting, for all I â Sub(IA ), I B = K A , where K is the  first special interval to the right of I. We claim that, for all  I â Sub(IA ) and all Ď â ÎŚ:      Vh  Vh â1  v1 v2 . . . vtâ1   -  -  vt  -  6  Î˛h    Uh  Figure 5.  Îąh  -  Neighbouring rows of a structure  Vt â Us  Î˛1 Î˛2 . . . Î˛tâ1  ?  (S1) for all h (1  h  s) and all h (1  h  t), if  [D]Ď â Î˛h and Uh > Vh â1 , then [D]Ď â Îąh ;  (S2) for all h (1  h  t), if DĎ â Î˛h , either there  exists h (h  h  t) such that Ď â Î˛h , or there  exists h (1  h  s) such that Uh  Vh and DĎ â  Îąh ;  (S3) Vtâ1  Us < Vt .  The following two lemmas motivate this definition.  Lemma 3. Let A be a structure of size m, let 1  j < m,  and let ÎąĚ, uĚ, Î˛Ě, vĚ be profiles realized by the jth and  -  A  B |=I Ď if and only if A |=K Ď, where K is the  first special interval to the right of I.  We prove the claim by structural induction. If Ď = p is a  proposition letter, the claim is immediate by the construction  of B; furthermore, the Boolean cases are trivial. So suppose  Ď = [D]Î¸ (whence ÂŹĎ, ÂŹÎ¸ â ÎŚ). Pick any I â Sub(IA ), and  let K be the first special interval to the right of I. Suppose  first that B |=I Ď. Then B |=J Î¸ for some J â I. Let  K  be the first special interval to the right of J, so that,  by inductive hypothesis, A |=K  Î¸. Since K  â J â I, we  have A |=I ÂŹ[D]Î¸; so let I  be the right-most witness for  ÂŹ[D]Î¸ in the same row as I. By definition, I  is special, and  hence must lie (non-strictly) to the right of K; thus, I  â K.  But then A |=K ÂŹ[D]Î¸, i.e., A |=K Ď. Conversely, suppose  A |=K Ď. Then A |=J ÂŹÎ¸ for some J â K. So now let J   be the right-most witness for ÂŹÎ¸ in the same row as J. By  definition, J  is special, and thus (trivially) the first special  interval to the right of J  , whence, by inductive hypothesis,  B |=J  ÂŹÎ¸. But J  â J â K â I, so that B |=I Ď. This  completes the induction, and establishes the claim.  To conclude the proof, suppose A |=I Ď, and suppose,  without loss of generality, that I is the right-most witness for  Ď in its row. Thus, I is special, and, furthermore, is (trivially)  the first special interval to the right of I. Constructing B as  above, BI |= Ď. Finally, the claim shows that every row in  B realizes a profile of length no greater than the number of  special intervals in that row. But we have already noted that  this number is bounded by Ď + 1.  Now suppose ÎąĚ = (Îą1 , . . . , Îąs ) and Î˛Ě = (Î˛1 , . . . , Î˛t ) are  configurations. A solution for ÎąĚ, Î˛Ě is a pair uĚ, vĚ, where  uĚ is a vector of length s and vĚ a vector of length t, satisfying  the following conditions:  Us  Î˛t  Figure 6.  The structure B of Lemma 4.  (j + 1)th rows of A, respectively. Then uĚ, vĚ is a solution  for ÎąĚ, Î˛Ě.  Proof: Numbering the cells of the jth row from left to  right (starting with 1), we observe that, for all h (1  h   |ÎąĚ|), the cells in positions Uhâ1 + 1 to Uh all satisfy Îąh ;  similar remarks apply to row j +1. Conditions (S1)â(S2) are  then evident by inspection of Fig. 5, which depicts the two  rows of A in question. For condition (S3), note that Us = j,  Vt = j + 1 and, by assumption, vt > 0.  Lemma 4. Let ÎąĚ and Î˛Ě be configurations. Suppose that  uĚ, vĚ is a solution for ÎąĚ, Î˛Ě, and that A is a structure  whose top row realizes the profile ÎąĚ, uĚ. Then there exists  a structure B whose top row realizes the profile Î˛Ě, vĚ.  Proof: Write Î˛Ě = (Î˛1 , . . . , Î˛t ), and let s = |ÎąĚ|. The  structure B shown in Fig. 6 has the required properties. A  label Î˛h in a region indicates that all the intervals in that  region make true exactly the proposition letters Î˛h âŠP. Condition (S3) guarantees that the dimensions of the rectangles  labelled Î˛1 , . . . , Î˛tâ1 are such that the âtrapeziumâ labelled  Î˛t exists. In particular, each of the new rows (above the top  row of A) contains a final block of cells in the region labelled  Î˛t . (This is important, because (Î˛1 , . . . , Î˛h ) need not be a  configuration for h < t.) Using Conditions (C1)â(C2) and  (S1)â(S2), a routine structural induction establishes that, for  all h (1  h  t), and any interval I lying in the region  labelled Î˛h , B |=I Î˛h .  Thus, Lemma 3 states that configurations belonging to  profiles realized by successive rows in a structure always  have a solution, while Lemma 4 provides a partial converse:  given a solution uĚ, vĚ for ÎąĚ, Î˛Ě, we can extend any structure whose top row realizes the profile ÎąĚ, uĚ to one whose  top row realizes the profile Î˛Ě, vĚ (notice that reflexivity of  the sub-interval relation plays an essential role in Lemma  4.3). Indeed, the next lemma allows us to create, ex nihilo,  a structure whose top-row realizes any profile of length 1.  Lemma 5. Let Îą be a 1-type such that DĎ â Îą implies  Ď â Îą, and let m be a positive integer. Then there exists a  structure A whose top row realizes the profile (Îą), (m).  Proof: Set IA = [1, m], and I A = Îą âŠ P for all I â  Sub(IA ).  The following sequence of lemmas shows that, if ÎąĚ, Î˛Ě  has one solution, then it has many.  Lemma 6. Let ÎąĚ and Î˛Ě be configurations, and m a positive  integer, and suppose that uĚ, vĚ is a solution for ÎąĚ, Î˛Ě. Then  muĚ, mvĚ is also a solution for ÎąĚ, Î˛Ě.  Proof: Satisfaction of inequalities x1 + Âˇ Âˇ Âˇ + xh  y1 +  Âˇ Âˇ Âˇ + yk and x1 + Âˇ Âˇ Âˇ + xh < y1 + Âˇ Âˇ Âˇ + yk is preserved  under multiplication by m.  Lemma 7. Let ÎąĚ and Î˛Ě be configurations, and suppose that  uĚ, vĚ is a solution for ÎąĚ, Î˛Ě. If uĚ is a vector satisfying  uĚ  uĚ , then there exists a vector vĚ  satisfying vĚ  vĚ  such  that uĚ , vĚ   is a solution for ÎąĚ, Î˛Ě.  Proof: It suffices to prove the lemma where uĚ =  (u1 , . . . , us ), vĚ = (v1 , . . . , vt ), and uĚ = (u1 , . . . , uiâ1 ,  ui + 1, ui+1 , . . . , us ). Since Vt > Us , pick the least j  (1  j  t) such that Vj > Uiâ1 , and set vĚ  =  (v1 , . . . , vjâ1 , vj + 1, vj+1 , . . . , vt ). It is then obvious that,  for all i (0  i  s) and all j (0  j  t), Ui > Vj if and  only if Ui > Vj .  Lemma 8. Let ÎąĚ and Î˛Ě be configurations, with |ÎąĚ| = s  m  and |Î˛Ě| = t  n, such that ÎąĚ, Î˛Ě has a solution. Then ÎąĚ, Î˛Ě  has a solution uĚ, vĚ satisfying uĚ  (n, . . . , n). Indeed, it  has a solution uĚ, vĚ satisfying uĚ  (n, . . . , n) and vĚ   (m + 1, . . . , m + 1).  Proof: Let uĚ, vĚ be a solution with uĚ = (u1 , . . . , us )  and vĚ = (v1 , . . . , vt ). For the first statement of the  lemma, suppose ui > n for some i (1  i  s).  We claim that there exists j (1  j  t) such that,  writing uĚ = (u1 , . . . , uiâ1 , ui â 1, ui+1 , . . . , us ) and vĚ  =  (v1 , . . . , vjâ1 , vj â1, vj+1 , . . . , vt ), uĚ , vĚ   is also a solution.  By repeated applications of this claim, we obtain the desired  solution. The claim is obvious if n = 1; so assume n > 1  (whence ui  3). Now, since Vt > Us  Usâ1 + 1, let j   be the smallest positive integer such that Vj  > Uiâ1 + 1.  If vj  > 1, then, since ui  3, setting j = j  gives the  required vĚ  . So suppose vj  = 1, in which case, we also  have j   2 and indeed Vj  = Uiâ1 + 2. Since, in addition,  ui  n + 1, there exists j (j  < j  t) such that vj > 1 and  Vjâ1  Ui â 2. Again, it is easy to check that this value of  j gives the required vĚ  . The second statement of the lemma  follows by an almost identical argument.  Lemma 9. Let ÎąĚ and Î˛Ě be configurations whose length  is bounded by a polynomial function of Ď . Then we can  determine, using space likewise bounded by a polynomial  function of Ď , whether ÎąĚ, Î˛Ě has a solution.  Proof: Try all pairs of vectors uĚ, vĚ satisfying the  bounds given in Lemma 8.  Lemma 10. Let ÎąĚ and Î˛Ě be configurations, with |Î˛Ě|  n,  such that ÎąĚ, Î˛Ě has a solution; and let m be a positive  integer. For any vector uĚ satisfying uĚ  (mn, . . . , mn),  there exists a vector vĚ satisfying vĚ  (m, . . . , m), such that  uĚ, vĚ is a solution for ÎąĚ, Î˛Ě.  Proof: By Lemma 8, let uĚ , vĚ   be a solution satisfying  uĚ  (n, . . . n). By Lemma 6, muĚ , mvĚ   is a solution, with  muĚ  uĚ, and (trivially) mvĚ   (m, . . . , m). By Lemma 7,  there exists a vector vĚ with vĚ  mvĚ  such that uĚ, vĚ is a  solution.  Define the directed graph GĎ = (C, E) as follows:    C  = {ÎąĚ | ÎąĚ is a configuration s.t. |ÎąĚ|  Ď + 1}  E  = {ÎąĚ, Î˛Ě â C 2 | ÎąĚ, Î˛Ě has a solution}.  Since the number of 1-types is at most 2Ď , |C|  2n ,  where n = Ď ( Ď + 1). The main lemma of this section states necessary and sufficient conditions for Ď to be  satisfiable.  Lemma 11. Let Ď be an LD -formula, and let the graph  GĎ = (C, E) be constructed as above. Then Ď is satisfiable  if and only if there is a path in GĎ from some configuration  ÎąĚ of length 1 to some configuration Î˛Ě containing a 1-type  Î˛ such that Ď â Î˛.  Proof: Suppose first that A is a model of Ď. By  Lemma 2, we may assume that each row of A realizes  some profile (ÎąĚ, uĚ) of length at most Ď + 1, so that  ÎąĚ â C. The first row necessarily realizes a profile of  length 1; by Lemma 3, the configurations corresponding to  successive rows are joined by an edge in E; and, since A  is a model of Ď, some row of A realizes a profile in which  Ď occurs somewhere. That is: there is a path in GĎ from  some configuration ÎąĚ of length 1 to some configuration Î˛Ě  containing a 1-type Î˛ such that Ď â Î˛.  Conversely, suppose there is a path ÎąĚ1 , . . . , ÎąĚz in GĎ  where: (i) ÎąĚ1 = (Îą) is a configuration of length 1; (ii)  ÎąĚi , ÎąĚi+1  is an edge of E for all i (1  i < z); and (iii)  ÎąĚz contains a 1-type Î˛ such that Ď â Î˛. Let n = Ď + 1.  By definition, each configuration in C is of length at most  n. We show by induction that, for all j (1  j  z), there  exists a structure Aj whose top row realizes a profile of the  form ÎąĚj , uĚ, with uĚ  (nzâj , . . . , nzâj ). It follows that Az  is a model of Ď, proving the lemma.  Case j = 1: By Lemma 5, there exists a structure whose  top row realizes the profile (Îą), (nzâ1 ).  Case 1 < j  z: Suppose Ajâ1 has been defined, and that  the top row of Ajâ1 realizes the profile ÎąĚjâ1 , uĚjâ1 , with  uĚjâ1  (nzâj+1 , . . . , nzâj+1 ). Since (ÎąĚjâ1 , ÎąĚj ) â E, the  pair ÎąĚjâ1 , ÎąĚj , has a solution, and hence, by Lemma 10,  a solution uĚjâ1 , uĚj  with uĚj  (nzâj , . . . , nzâj ). By  Lemma 4, there exists a model Aj whose top row realizes  the profile ÎąĚj , uĚj . This completes the induction, and the  proof.  Theorem 12. The satisfiability problem for LD is in  PS PACE.  Proof: Denote Ď ( Ď + 1) by n, and consider the  following nondeterministic procedure  1. set N = 0;  2. guess a configuration Î˛Ě of length 1;  3. until N = 2n or Î˛Ě contains a 1-type Î˛ such that  Ď â Î˛ do:  4.  set ÎąĚ = Î˛Ě and increment N ;  5.  guess a configuration Î˛Ě s.t. |Î˛Ě|  Ď + 1;  6.  if ÎąĚ, Î˛Ě has no solution, then fail;  7. end until  8. if N = 2n then fail;  9. succeed.  By Lemma 9, the test in Line 6 requires only space bounded  by a polynomial function of Ď ; further, the counter N  requires only n + 1 bits. Evidently, the procedure has a  successful run if and only if there exists a path in GĎ from  some configuration ÎąĚ of length 1 to some configuration Î˛Ě  containing a 1-type Î˛ such that Ď â Î˛. The result then  follows by Lemma 11 and Savitchâs theorem.  V. A DDING THE O PERATOR [DĚ]  In this section, we show how to generalize Theorem 12 to  the satisfiability problem for LDDĚ over finite linear orders  (LDĚ is just a special case). First, we modify the definitions  of configuration and profile by adding to conditions (C1)â  (C2) the further condition:  (C3) if 1  h < h  s and [DĚ]Ď â Îąh , [DĚ]Ď â Îąh .  Next, we prove an analogue of Lemma 2.  Lemma 13. If an LDDĚ -formula Ď has a model, then it has  a model over the same domain in which every row realizes  a profile of length at most 4 Ď + 3.  Proof: Fix a model A of Ď. If Ď â ÎŚ, a witness for  Ď is an interval I â Sub(IA ) such that A |=I Ď. We call  an interval I = [i, j] â Sub(IA ) right (resp., left) special if  there exists Ď â ÎŚ such that A |=I Ď and, for all k (i < k   j) (resp., (1  k < i)) A |=[k,j] Ďâthat is, if there is some  formula of ÎŚ for which I is the right-most (resp., left-most)  witness in its row. A special interval is a right special or  left special interval. Evidently, for any I = [i, j] â Sub(IA ),  there is a least k (i  k  j) (resp., greatest k  (1  k  < i))  such that Kr = [k, j] (resp., Kl = [k  , j]) is special. We refer  to Kr (resp., Kl ) as the closest-to-the-right (resp., closestto-the-left) special intervals for I. Finally, since |ÎŚ|  2 Ď ,  and the right-most (resp., left-most) interval of any row is  the right-most (resp., left-most) witness for at least |ÎŚ|/2 of  the formulas of ÎŚ in that row, it follows that the number of  special intervals in any row is at most 2 Ď + 2.  Let f : Sub(IA ) â Sub(IA ) be a function that satisfies  the following properties:  (F1) for every special interval I, f (I) = I;  (F2) for every non-special interval I, f (I) = I  , where I  is  a non-special interval such that the closest-to-the-left  and closest-to-the-right special intervals for I and I   are the same;  (F3) for every pair of non-special intervals I, I  , if the  closest-to-the-left and closest-to-the-right special intervals for I and I  are the same, then f (I) = f (I  ).  Observe that, for any Ď = [D]Î¸ â ÎŚ and any I â Sub(IA ),  A |=I Ď if and only if A |=f (I) Ď; similarly for Ď = [DĚ]Î¸.  Let B be a structure with the same domain as A (that is,  Sub(IB ) = Sub(IA )) such that I B = f (I)A . We claim that,  for every I â Sub(IA ) and every Ď â ÎŚ:  B |=I Ď if and only if A |=f (I) Ď.  We prove the claim by structural induction. If Ď = p is a  proposition letter, the claim is immediate by the construction  of B. Boolean cases are trivial. So suppose Ď = [D]Î¸  (whence ÂŹĎ, ÂŹÎ¸ â ÎŚ). Pick I â Sub(IA ), and let f (I) = I  .  For the left-to-right implication, suppose that A |=I  ÂŹĎ.  Let K be the right-most witness for ÂŹĎ in the same row  as I. Since K is special and non-strictly to the right of I  ,  we have K â I. Now, there exists an interval KĚ such that  KĚ â K, A |=KĚ ÂŹÎ¸, and KĚ is the right-most witness for  ÂŹÎ¸ in its row. Since KĚ is special, f (KĚ) = KĚ, and thus,  by inductive hypothesis, B |=KĚ ÂŹÎ¸, whence B |=I ÂŹĎ.  Conversely, suppose B |=I ÂŹĎ. Then, there exists J â I  such that B |=J ÂŹÎ¸, whence A |=f (J) ÂŹÎ¸, by inductive  hypothesis. Let K be the right-most witness for ÂŹÎ¸ in the  same row as J. Since K is special and non-strictly to the  right of f (J), we have K â J, whence A |=I ÂŹ[D]Î¸. But  we have already observed that A |=I [D]Î¸ if and only if  A |=f (I) [D]Î¸. Hence, A |=f (I) ÂŹĎ as required. The case  Ď = [DĚ]Î¸ is completely symmetric.  Now, suppose A |=I Ď. We may assume without loss  of generality that I is special, whence I = f (I), so that,  constructing B as above, B |=I Ď. To conclude the proof,  it suffices to observe that every row in B realizes a profile  that features one 1-type for every special interval in that row  (at most 2 Ď +2) plus at most one 1-type for every maximal  consecutive sequence of non-special intervals in that row (at  most 2 Ď + 1).  Next, we modify the definition of a solution for a pair  of configurations ÎąĚ, Î˛Ě, given in Section IV, by adding to  conditions (S1)â(S3) the further conditions  (S4) for all h (1  h  s) and all h (1  h  t), if  [DĚ]Ď â Îąh and Uh > Vh â1 , then [DĚ]Ď â Î˛h ;  (S5) for all h (1  h  s), if DĚĎ â Îąh , either there  exists h (1  h  h) such that Ď â Îąh , or there  exists h (1  h  t) such that Vh â1  Uhâ1 and  DĚĎ â Î˛h .  We construct the graph GĎ exactly as described in Section IV, except that we employ the revised definitions of  configuration and solution, and set  C = {ÎąĚ | ÎąĚ is a configuration s.t. |ÎąĚ|  4 Ď + 3}.  In place of Lemma 11, we then have:  Lemma 14. Let Ď be an LDDĚ -formula, and let the graph  GĎ = (C, E) be constructed as above. Then Ď is satisfiable  over finite linear orders if and only if there is a path in GĎ  from some configuration Îą of length 1 to some configuration  Î˛Ě containing a 1-type Î˛ such that Ď â Î˛, and a path in GĎ  from Î˛Ě to some configuration (Îł1 , . . . , Îłk ) such that, for  every j (1  j  k) and every DĚĎ â Îłj , there exists j   (1  j   j) with Ď â Îłj  .  The following theorem is the counterpart of Theorem 12  for LDDĚ , and may be proved similarly.  Theorem 15. The satisfiability problem for LDDĚ is in  PS PACE.  VI. C ONCLUSIONS  In this paper, we have shown that the satisfiability problems for the interval logics of the reflexive sub-interval and  super-interval relations interpreted over finite linear orders  are PS PACE-complete. The authors are currently investigating the problem of establishing whether decidability, and  complexity, of LDDĚ are preserved if we replace finite linear  orders by the natural numbers or the integers. The problem  is of interest, because, as is easily shown, DĚ can be used to  write formulas satisfiable over infinite discrete linear orders,  but not over finite linear orders. As we have already pointed  out, some basic steps of our proof do not work if we replace  reflexive sub-interval and super-interval relations by strict or  proper ones. To the best of our knowledge, the satisfiability problems for interval logics of the strict (respectively,  proper) sub-interval and super-interval relations, interpreted  over finite linear orders, are still open.  ACKNOWLEDGMENTS  This paper resulted from a visit of the first and third  authors to Manchester University in January 2010, funded by  the ESF Research Networking Programme GAMES (Games  for Design and Verification). The same authors acknowledge the support of the Italian PRIN and GNCS projects  Innovative and multi-disciplinary approaches for constraint  and preference reasoning and Logics, automata, and games  for the formal verification of complex systems. The second  author acknowledges the support of the EPSRC, grant reference EP/E035248.  R EFERENCES  [1] V. Goranko, A. Montanari, and G. Sciavicco, âA road map  of interval temporal logics and duration calculi,â Journal of  Applied Non-Classical Logics, vol. 14, no. 1â2, pp. 9â54,  2004.  [2] J. Halpern and Y. Shoham, âA propositional modal logic of  time intervals,â Journal of the ACM, vol. 38, pp. 279â292,  1991.  [3] Y. Venema, âA modal logic for chopping intervals,â Journal  of Logic and Computation, vol. 1, no. 4, pp. 453â476, 1991.  [4] D. Bresolin, V. Goranko, A. Montanari, and G. Sciavicco,  âPropositional interval neighborhood logics: expressiveness,  decidability, and undecidable extensions,â Annals of Pure and  Applied Logic, vol. 161, no. 3, pp. 289â304, 2009.  [5] D. Bresolin, V. Goranko, A. Montanari, and P. Sala, âTableaux  for logics of subinterval structures over dense orderings,â  Journal of Logic and Computation, vol. 20, no. 1, pp. 133â  166, 2010.  [6] M. Otto, âTwo variable first-order logic over ordered domains,â Journal of Symbolic Logic, vol. 66, no. 2, pp. 685â  702, 2001.  [7] D. Bresolin, D. Della Monica, V. Goranko, A. Montanari,  and G. Sciavicco, âDecidable and undecidable fragments of  Halpern and Shohamâs interval temporal logic: towards a  complete classification,â in Proc. of the 15th International  Conference on Logic for Programming, Artificial Intelligence,  and Reasoning, ser. LNCS, vol. 5330. Springer, 2008, pp.  590â604.  [8] A. Montanari, G. Puppis, and P. Sala, âMaximal decidable  fragments of Halpern and Shohamâs modal logic of intervals,â  in Proc. of the 37th International Colloquium on Automata,  Languages and Programming, 2010.  [9] J. van Benthem, The Logic of Time: A Model-Theoretic  Investigation into the Varieties of Temporal Ontology and  Temporal Discourse, Second Edition. Kluver, 1991.  [10] I. Shapirovsky and V. Shehtman, âChronological future  modality in Minkowski spacetime,â in Advances in Modal  Logic. London: Kingâs College Publications, 2003, vol. 4,  pp. 437â459.  [11] I. Shapirovsky, âOn PSPACE-decidability in Transitive Modal  Logic,â in Advances in Modal Logic. London: Kingâs College  Publications, 2005, vol. 5, pp. 269â287.  [12] E. Kieronski, J. Marcinkowski, and J. Michaliszyn, âB and D  are enough to make the Halpern-Shoham logic undecidable,â  in Proc. of the 37th International Colloquium on Automata,  Languages and Programming, 2010.  [13] K. Segerberg, âAn essay in classical modal logic,â Filosofiska  Studier, vol. 13, 1971.  [14] L. J. Stockmeyer and A. Meyer, âWord problems requiring  exponential time,â in Proc. of the 5th ACM Symposium on the  Theory of Computing, 1973, pp. 1â9. 