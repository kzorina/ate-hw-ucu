AllenÃ¢Â€Â™s hourglass: probabilistic treatment of interval relations  Sergios Petridis, Georgios Paliouras and Stavros J. Perantonis  NCSR Ã¢Â€ÂœDemokritosÃ¢Â€Â, IIT  15310 Aghia Paraskevi, Greece  {petridis, paliourg, sper}@iit.demokritos.gr  Abstract  The paper is motivated by the need to handle robustly the  uncertainty of temporal intervals, e.g. as it occurs in automated event detection in video streams. The paper introduces a two-dimensional mapping of AllenÃ¢Â€Â™s relations, based  on orthogonal characteristics of interval relations, namely  relative position and relative size. The hourglass-shaped  mapping also represents limit cases that correspond to durationless intervals. Based on this mapping, we define two  sets of primitive interval relations in terms of the relative positioning and relative size of intervals. These primitives are  then used to derive a probabilistic set of AllenÃ¢Â€Â™s relations. A  number of example cases are presented to illustrate how the  proposed approach can improve the robustness of interval  relations.  1. Introduction  AllenÃ¢Â€Â™s interval calculus [1] has been used extensively  for temporal reasoning [2], human mental modeling [6] and  temporal databases [4]. In the context of automated information extraction from multimedia content [10], AllenÃ¢Â€Â™s  relations provide a mechanism for inferring higher level  knowledge and/or querying over detected events. However,  the rigid nature of qualitative relations does not encourage  their direct use, since they do not suit the inexact nature of  the information extraction algorithms [5]. In particular, as  pointed out in [7], qualitative interval relations may not be  robust enough to small temporal perturbations.  Addressing this issue, one may consider extending  AllenÃ¢Â€Â™s relations with uncertainty values. In [8], probability  temporal interval networks are introduced, where nodes are  intervals and edges are probabilistic relations. In [9] probabilities are attached to intervals, while in [3] a fuzzy extension of AllenÃ¢Â€Â™s algebra has been proposed. In all of these  approaches, the use of uncertainty is mostly motivated by  the need to impose soft constraints on temporal relations,  while the focus is on providing the algebra and algorithms  to deal with uncertainty values, once these are available.  A somehow different issue, which is the focus of this article, is how to assign uncertainty values to AllenÃ¢Â€Â™s relations,  so as to compensate for the inherent uncertainty of the automated event detection process. Once uncertainty values are  assigned to interval relations, they can be used, for example, as input to probability temporal interval networks to be  checked for consistency [8] and to provide a reliable confidence index with respect to a database query [4]. We believe  that this extension can improve significantly the robustness  and the applicability of AllenÃ¢Â€Â™s relations.  Assigning probabilities to interval relations, one has to  account for symmetries between relations. Such symmetries  have been studied in terms of reorientation and transposition transforms (see [6] and references therein). Nevertheless, to our knowledge, the relative size of intervals has not  been used as a primary axis of symmetry. As we show here,  it turns out the relative size, together with relative duration,  create a two-dimensional space, which greatly facilitates the  understanding of the relations and the assignment of probabilities.  Overall, this article has three main contributions. First,  it sheds light to the geometry of AllenÃ¢Â€Â™s relations by mapping them onto a two-dimensional hourglass configuration,  where the horizontal axis corresponds to relative time and  the vertical one to relative size of intervals. Along its vertical limits, the mapping also allows to visualize cases where  either the target or the reference interval is durationless.  Second, for each dimension, a probability set of ordered  primitive relations is defined, namely (beforeÃ¢Â€Â“concurrent  withÃ¢Â€Â“after) and (smallerÃ¢Â€Â“equisizedÃ¢Â€Â“larger). A sound way  to determine the probabilities of these relations, as functions  of the relative size and relative position of the intervals, is  detailed.  Last, a probabilistic set of AllenÃ¢Â€Â™s relations is presented  and a way to evaluate the probabilities using the primitive  relations, is defined.  The rest of the article is structured as follows. Section 2  explains the shortcomings of AllenÃ¢Â€Â™s relations that have motivated our work. Section 3 introduces the two-dimensional  hourglass configuration of AllenÃ¢Â€Â™s relations. Section 4 describes the primitive relation sets and their association to the  relative size and duration of the intervals, whereas Section 5  presents the probabilistic extension of AllenÃ¢Â€Â™s relations. Finally, Section 6 shows the utility of the defined extension  for a number of cases and Section 7 summarizes the results  and highlights open issues.  2. Motivation  AllenÃ¢Â€Â™s relations An interval is defined as a set of real  numbers with the property that any number that lies between  any two numbers in the set is also included in the set. Allen  (1983) introduced a calculus for representing the temporal  relation of events delimited by time intervals. In particular, he defined 13 jointly exhaustive and pairwise disjoint  (JEPD) qualitative relations between intervals.  These are summarized in Table 1.  .  .  (a) Overlaps  .  (b) During  (c) During-i  .  (d)  Overlaps-i  Figure 1. AllenÃ¢Â€Â™s relations lack of robustness.  .  .  (a) Overlaps  (b) Overlapsalmost  Equals  .  (c) Overlaps- almost  Before  Figure 2. AllenÃ¢Â€Â™s relations inadequacy.  .  Lack of Robustness Automated analysis results are inherently uncertain, due to the limited accuracy of the recognition algorithms. One source of uncertainty is the inaccuracy of segment boundaries. It is important that small differences of segmentation results should not result in significant  differences in their inferred relations. This can happen with  AllenÃ¢Â€Â™s qualitative relations, for two reasons. First, several  relations (such as Meets) require equality of time points,  something which can only hold approximately in real-word  extracted time intervals. Second, negligible changes to one  of the end-points, with respect to the size of the time interval  may result in a different qualitative relation.  To see that, let us examine the case of two intervals of  approximately the same size. More formally, let a time  duration , such that  < ÃÄ…|Xi |, Ã¢ÂˆÂ€xi and ÃÄ… Ã¢ÂˆÂˆ (0, 1) is a  real number that can be chosen to be arbitrary small. Using , we define a uniform random variable U Ã¢ÂˆÅº U (Ã¢ÂˆÂ’, ).  Now let a referred time interval X = [Xb , Xe ] and let  Y = [Xb + u1 , Xe + u2 ] where u1 and u2 are generated  by U . By definition, interval Y is almost equal to X but  not necessarily exactly equal. In fact, as depicted in Figure  1, several of AllenÃ¢Â€Â™s relations may hold between X and Y,  depending on u1 and u2 .  Consequently, the information that a particular relation  holds between two intervals looses its significance, since  most other could characterize approximately the same situation equally well.  To give an example, if X is a time interval with boundaries X = [10sec, 12sec] and Y is a time interval with  boundaries Y = [2sec, 40sec], then the (only) relation holding is: (X During Y). Although AllenÃ¢Â€Â™s relations are complete, they may not fit very well to temporal segments that  result from automated analysis, which are inherently uncertain. In what follows, we discuss two particular such shortcomings: lack of robustness and inadequacy.  Inadequacy Another issue with AllenÃ¢Â€Â™s relations is their  inadequacy in discriminating between very different situations occurring between intervals. This failure is a consequence of the fact that no quantitative information is taken  into account. In particular, there are cases where a a different relation would result if the end points were slightly  perturbed. Figure 2 depicts this failure in the case of three  quite different situations, all being qualified as Overlaps.  name  definition  Before (b)  Xb < Xe < Yb < Ye  Meets (m)  Xb < Xe = Yb < Ye  Overlaps (o)  Xb < Yb < Xe < Ye  Starts (s)  Yb = Xb < Xe < Ye  During (d)  Yb < Xb < Xe < Ye  Finishes (f)  Yb < Xb < Ye = Xe  Equals (=)  Xb = Yb < Ye = Xe  Finishes-i (fi)  Xb < Yb < Ye = Xe  During-i (di)  Xb < Yb < Ye < Xe  Starts-i (fi)  Xb = Yb < Ye < Xe  Overlaps-i (oi)  Yb < Xb < Ye < Xe  Meets-i (mi)  Yb < Ye = Xb < Xe  After (a)  Yb < Ye < Xb < Xe  example  .  .  .  .  .  .  .  .  .  .  .  .  .  Table 1. AllenÃ¢Â€Â™s qualitative relations between two  intervals X = [Xb , Xe ] and Y = [Yb , Ye ]  .Size  -i  .Starts  .Meets-i  .  .During-i  i  hes-  .Finis  .>  .Overlaps  .Before  .  .During  .  .After  es  .Ã¢Â‰ÅŸ  .  .Overlaps-i  .Equals  .Finish  .Meets  .<  .Starts  .Ã¢ÂˆÅº  .Position  .  Figure 3. Two-dimensional hourglass configuration of AllenÃ¢Â€Â™s relations  3. A two-dimensional interval relation space  The idea that the 13 relations of Allen have some geometry is implicitly conveyed by the names of the relations:  most of them come in pairs, where one is considered the  inverse of the other (e.g. Starts vs Starts-i). It is instructive to examine how the Ã¢Â€ÂœinverseÃ¢Â€Â attribute modifies each  relation. In most cases, it implies reverting the direction of  time. This is the case for the BeforeÃ¢Â€Â“After, MeetsÃ¢Â€Â“Meets-i  and OverlapsÃ¢Â€Â“Overlaps-i pairs.  Interestingly, the pair DuringÃ¢Â€Â“During-i cannot be obtained by the same principle: if X happens During Y then  it would still happen During Y if the time axis was reversed.  To obtain During-i we have to actually change the relative  size of the intervals, i.e. letting X being larger than Y, instead of being smaller. Furthermore, a careful examination  of the StartsÃ¢Â€Â“Starts-i and FinishesÃ¢Â€Â“Finishes-i pairs reveals  that the inverse characteristic refers to both relative time position and relative size.  The Hourglass Configuration This observation led us  to explore a two-dimensional configuration of AllenÃ¢Â€Â™s relations, where one dimension corresponds to the relative position of the intervals and the other to their relative size.  Figure 3 shows how these relations may be depicted in a  two-dimensional configuration that resembles an hourglass.  The horizontal axis corresponds here to the relative posi-  tion of the intervals, while the vertical one to their relative  size. The coordinate axes also introduce some symbols that  correspond roughly to the probabilistic primitive relations  that will be defined in Section 4 (Ã¢Â‰ÅŸ: before, : concurrent  with, : after, >: larger, Ã¢ÂˆÅº: equisized and <: smaller).  The hourglass configuration has some nice properties.  First, by letting Y be a fixed interval and X an interval that  progressively moves forward in time, the hourglass enables  us to quickly visualize the relations it will go through, provided that we chose a particular relative size of intervals. For  example, when X has the same size as Y, these are: Before,  Meets, Overlaps, Equals, Overlaps-i, Meets-i and After.  Moreover, the hourglass allows to distinguish between  relations that are defined solely by inequalities from those  that are defined also by equalities. The regions inside and  outside the hourglass correspond to the six relations defined by inequalities: Before, Overlaps, During, During-i,  Overlaps-i and After. The lines defining these regions correspond to the six relations that include an equality in their  definition: Meets, Starts, Finishes, Finishes-i, Starts-i and  Meets-i. Last, the central point of the hourglass corresponds  to the only relation defined by two equalities, namely the  Equals relation.  Another useful property of the hourglass configuration  is that it reveals the two distinct axes of symmetry of the  relations: Ã¢Â€ÂœfoldingÃ¢Â€Â the hourglass along the horizontal axis  and around the center (relative position symmetry) makes,  for example, the Before and After regions coincide, whereas  Ã¢Â€ÂœfoldingÃ¢Â€Â it along the vertical axis (relative size symmetry)  makes the During and During-i regions coincide.  The hourglass also distinguishes between relations with  respect to of the relative size of the intervals: the relations  appearing at its lower part (Starts, During and Finishes) are  applicable only if the first interval is smaller than the second. whereas the relations appearing only at its upper part  (Finishes-i, During-i and Starts-i) are applicable only if the  first interval is larger than the second, All other relations are  applicable regardless of the relative size of the intervals.  The Limits of the Hourglass The hourglass configuration allows us also to visualize the relations applicable in  three limit cases, with respect to the relative size of the intervals. Namely, the lower line (bottom) of the hourglass  corresponds to the case where the first interval is infinitely  smaller than the second, i.e. it reduces to a durationless interval. Notice that, as one should expect, the Overlaps and  Overlaps-i relations do not apply here: at the limit, a time  point cannot overlap with an interval. Still on the lower line,  the MeetsÃ¢Â€Â“Starts and FinishesÃ¢Â€Â“Meets-i pairs become indistinguishable when the first interval is infinitely smaller than  the second. As a result, they are displayed as single points  at the lower left and right corner of the hourglass.  Similar conclusions can be drawn by looking at the up-  per line (top) of the hourglass, where the first interval is infinitely larger than the second, i.e. the second interval becomes durationless. Here, the Overlaps and Overlaps-i relations also do not apply, while the MeetsÃ¢Â€Â“Finishes-i and  the Starts-iÃ¢Â€Â“Meets-i relations converge to the upper left and  right corners of the hourglass.  A third limit case worth mentioning is when the intervals  have the same size. In this case, one can easily verify that  the Starts, Starts-i, Finishes and Finishes-i relations coincide  with the Equals relation.  4. Primitive probabilistic relations  Motivated by the two-dimensional configuration of  AllenÃ¢Â€Â™s relations, and in order to extend the relations with  probabilities, we follow a two-step approach. At the first  step, discussed in this section, we define a number of primitive interval relations for each of the two dimensions. In  order to distinguish them from AllenÃ¢Â€Â™s original relations, we  will denote the new ones with bold letters. These relations  are not binary (hold/do not hold) but quantitative, i.e. they  hold up to a certain degree, between zero and one. We shall  discuss how this degree may be given a probabilistic interpretation.  At a second step, deferred to Section 5, we use these  primitives as a basis for a probabilistic extension of AllenÃ¢Â€Â™s  relations defined by inequalities.  Note that, in all definitions, we assume intervals to have  strictly positive size.  4.1. Primitives for relative position  from the smallest interval, and thus define P (X  Y) as  {  P (t Ã¢ÂˆÂˆ Y|t Ã¢ÂˆÂˆ X) |X| Ã¢Â‰Â¤ |Y|,  def  P (X  Y) =  (1)  P (t Ã¢ÂˆÂˆ X|t Ã¢ÂˆÂˆ Y) |X| > |Y|  where | Ã‚Ë‡ | denotes the size of the interval:  |X| = Xe Ã¢ÂˆÂ’ Xb  Note that P (X  Y) = P (Y  X). Moreover, we will make  the assumption that there is no reason to choose one time  point over another. In this case, Eq. (1) simplifies to  { |XÃ¢ÂˆÅ Y|  |X| Ã¢Â‰Â¤ |Y|,  |X|  P (X  Y) = |XÃ¢ÂˆÅ Y|  |X| > |Y|  |Y|  When this ratio equals 1, then the smallest interval is entirely into the larger one. Smaller probability values indicate  that some part of the smaller interval is not into the larger  one. Last, zero probability will indicate that no part of one  interval is within the other.  The Before and After relations The before and after relations will be denoted as Ã¢Â‰ÅŸ and  respectively. When some  part of X is not in Y then X is either before or after Y. We  will first deal with the case where X is not larger than Y, to  ensure that all parts of X not in Y will be either only before  Y or only after Y but not both.  For this definition, we need to introduce some notation.  Namely, the left complement of the interval Y = [Yb , Ye ],  i.e. the interval that covers the entire time axis until Yb , is  (  denoted as Y:  (  Y = (Ã¢ÂˆÂ’Ã¢ÂˆÂ, Yb )  Similarly, the right complement of Y, i.e. the interval that  The Concurrent relation Let us first define the concurrent with primitive, which we will mathematically denote  as . To do this, let us see how AllenÃ¢Â€Â™s During is defined  and see how we may extend it and attach a probability measure. AllenÃ¢Â€Â™s During holds iff X is entirely into Y. As shown  in Figure 1, even if a small part of X is not into Y then this  relation will not hold.  In case the relation holds, we may say that Ã¢Â€Âœthe probability of X being concurrent with YÃ¢Â€Â equals 1. However, we  may also relax the definition so that when the part of X not  in Y is very small, then the concurrent with relation almost  holds. To that end, we adopt the following view:  Let a point t chosen randomly in X. What is the  probability that t is also in Y?  In other words, we measure the probability P (X  Y) by  considering P (t Ã¢ÂˆÂˆ Y|t Ã¢ÂˆÂˆ X).  In order to define a symmetric relation, instead of choosing t from X in all cases, we will be choosing t randomly  *  covers the entire time starting from Ye , is denoted as Y:  *  Y = (Ye , +Ã¢ÂˆÂ)  Now, following the same arguments as with the concurrent  with relation, the probability of X being before Y is defined  as the probability of choosing a random point in X that lies  (  before Y, i.e. in Y. Formally,  Ã¢ÂˆÂ€|X| Ã¢Â‰Â¤ |Y| :  (  def  Pr(X Ã¢Â‰ÅŸ Y) = P (t Ã¢ÂˆÂˆ Y|t Ã¢ÂˆÂˆ X)  (  |X Ã¢ÂˆÅ  Y|  =  |X|  (2)  Along the same line of argument, the probability of X  being after Y is defined as:  Ã¢ÂˆÂ€|X| Ã¢Â‰Â¤ |Y| :  *  def  Pr(X  Y) = P (t Ã¢ÂˆÂˆ Y|t Ã¢ÂˆÂˆ X)  *  |X Ã¢ÂˆÅ  Y|  =  |X|  (3)  Now, when |X| > |Y|, the same definitions hold but with  the X and Y arguments inverted. Namely:  Ã¢ÂˆÂ€|X| > |Y| :  =  .Pr(X > Y)  *  def  Pr(X Ã¢Â‰ÅŸ Y) = P (t Ã¢ÂˆÂˆ X|t Ã¢ÂˆÂˆ Y)  *  Ã¢ÂˆÂ€|X| > |Y| :  .Pr(X Ã¢ÂˆÅº Y)  |Y Ã¢ÂˆÅ  X|  |Y|  (4)  .Ã¢ÂˆÂ’1  .Ã¢ÂˆÂ’nÄÂƒ  .  .0  .p(s)  .nÄÂƒ .|X|Ã¢ÂˆÂ’|Y|  |X|+|Y|  .1  (  def  Pr(X  Y) = P (t Ã¢ÂˆÂˆ X|t Ã¢ÂˆÂˆ Y)  (  |Y Ã¢ÂˆÅ  X|  =  |Y|  (5)  Figure 4. The equisized and larger probabilities as  areas of N (s, ÄÂƒ), delimited by Ã¢ÂˆÂ’nÃ‚Ë‡ÄÂƒ and nÃ‚Ë‡ÄÂƒ . Here,  smaller is negligible and not explicitly depicted.  One may easily verify that the before and after relations  are inversely related, i.e  Ã¢ÂˆÂ€X, Y :  Pr(X Ã¢Â‰ÅŸ Y) = Pr(Y  X)  Probability base with respect to relative position Altogether, the three relative position primitives introduced  above (before, concurrent with and after) are complementary: the more one holds, the less the others do. In particular, the primitives form a complete base, in the sense that,  for any two intervals X and Y:  Pr(X Ã¢Â‰ÅŸ Y) + Pr(X  Y) + Pr(X  Y) = 1  One may easily verify this, when |X| Ã¢Â‰Â¤ |Y|:  Pr(X Ã¢Â‰ÅŸ Y) + Pr(X  Y) + Pr(X  Y)  (  *  |X Ã¢ÂˆÅ  Y| + |X Ã¢ÂˆÅ  Y| + |X Ã¢ÂˆÅ  Y|  =  |X|  (  *  |X Ã¢ÂˆÅ  (Y Ã¢ÂˆÅ Y Ã¢ÂˆÅ Y)|  |X|  =  =  =1  |X|  |X|  and similarly for the |X| > |Y| case.  4.2. Primitives for relative size  We now discuss the second dimension of interval relations, namely the relation between interval sizes. In what  follows we define three relative duration primitives that correspond roughly to the following cases:  Ã¢Â€Ë˜ both intervals have the same size  Ã¢Â€Ë˜ the first interval is smaller than the second  Ã¢Â€Ë˜ the first interval is larger than the second  Consider the measured ratio  |X| Ã¢ÂˆÂ’ |Y|  sÄšÂ‚ =  |X| + |Y|  that takes values from (Ã¢ÂˆÂ’1, +1) where the upper, respectively the lower, limit correspond to the case X has Ã¢Â€ÂœinfinitelyÃ¢Â€Â greater, respectively smaller, size than Y . Assuming that the boundaries of intervals are uncertain, we may  consider that sÄšÂ‚ is the mean value of a random variable S,  following the normal distribution S Ã¢ÂˆÅº N (sÄšÂ‚, ÄÂƒ).  We may then define the probability of X being larger (in  short >), equisized (in short Ã¢ÂˆÅº) and smaller (in short <)  than Y, as the cumulative probability of S taking negative  values, close to zero or positive values respectively. Figure 4 illustrates these definitions. Formally, by letting n be  a parameter n Ã¢ÂˆÂˆ <+ , this is expressed as:  Pr(X < Y) = ÃÅš(Ã¢ÂˆÂ’n Ã‚Ë‡ ÄÂƒ|sÄšÂ‚, ÄÂƒ)  Pr(X Ã¢ÂˆÅº Y) = ÃÅš(n Ã‚Ë‡ ÄÂƒ|sÄšÂ‚, ÄÂƒ) Ã¢ÂˆÂ’ ÃÅš(Ã¢ÂˆÂ’n Ã‚Ë‡ ÄÂƒ|sÄšÂ‚, ÄÂƒ)  (6)  (7)  Pr(X > Y) = 1 Ã¢ÂˆÂ’ ÃÅš(n Ã‚Ë‡ ÄÂƒ|sÄšÂ‚, ÄÂƒ)  (8)  Furthermore, by making use of the complementary error  function:  Ã¢ÂˆÅ¤ Ã¢ÂˆÂ  2  2  erfc(x) = Ã¢ÂˆÂš  eÃ¢ÂˆÂ’t dt  ÄÂ€ x  the above definitions reduce to  (  )  sÄšÂ‚  1  Pr(X < Y) = erfc n +  2  ÄÂƒ  (  (  )  (  ))  1  sÄšÂ‚  sÄšÂ‚  Pr(X Ã¢ÂˆÅº Y) = 1 Ã¢ÂˆÂ’  erfc n Ã¢ÂˆÂ’  + erfc n +  2  ÄÂƒ  ÄÂƒ  (  )  1  sÄšÂ‚  Pr(X > Y) = erfc n Ã¢ÂˆÂ’  2  ÄÂƒ  Probability base for relative duration Altogether, the  smaller, equisized and larger primitives are complementary. One may easily verify that:  Pr(X < Y) + Pr(X Ã¢ÂˆÅº Y) + Pr(X > Y) = 1  i.e. they form a complete probability base.  .1  .0.5  .0 .  .0  .Pr(X < Y)  5. Probabilistic extension of AllenÃ¢Â€Â™s relations  .Pr(X > Y)  .Pr(X Ã¢ÂˆÅº Y)  .1  .2  .3  .4  .5 .|X|/|Y|  .4  .5 .|X|/|Y|  .4  .5 .|X|/|Y|  .4  .5 .|X|/|Y|  (a) ÄÂƒ = 0.1, n = 1  .1  .0.5  .0 .  .0  .1  .2  .3  (b) ÄÂƒ = 0.1, n = 2  .1  .0.5  .0 .  .0  .1  .2  .3  (c) ÄÂƒ = 0.2, n = 1  .1  .0.5  .0 .  .0  .1  .2  .3  (d) ÄÂƒ = 0.2, n = 2  Figure 5. Relative size primitives as a function of  the ÄÂƒ and n parameters.  Dependence on the ÄÂƒ and n parameters Figure 5 illustrates how relative size probability primitives are affected  when varying ÄÂƒ and n.  These parameters allow us to model our uncertainty towards the measurement and our tolerance in considering two  intervals to be equisized. Namely, ÄÂƒ quantifies our uncertainty regarding the relative size measurement: small values  of ÄÂƒ, e.g. ÄÂƒ  0.1 should be used when there is a significant confidence regarding the measurement, whereas large  values when measurement confidence is low.  On the other hand, n regulates our tolerance in favor of  the equisized relation. To see the consequences of choosing  a particular n, let us examine the case when the measured  relative size ratio is zero (s = 0). This is the case where  Pr(X Ã¢ÂˆÅº Y) is maximized. The maximum value obtained is  not 1, but equals the area of the normal distribution N (0, ÄÂƒ)  within the confidence interval (Ã¢ÂˆÂ’nÄÂƒ, +nÄÂƒ):  n  Pr(X Ã¢ÂˆÅº Y)sÄšÂ‚=0 = erf( Ã¢ÂˆÂš )  2  For example, when n = 1, respectively n = 2 the maximum  value of equisized obtainable is 0.68, respectively 0.95.  In the previous section, we defined six primitive relations: before, concurrent with, after and smaller, equisized, larger. One may use them directly to describe the  relation between intervals. However, our main motivation  has been to use them as a basis upon which to build a probabilistic extension of AllenÃ¢Â€Â™s relations. Extending AllenÃ¢Â€Â™s  relations with probabilities means that two intervals may be  related by more than one relations (e.g. During and Overlaps) with specific probability degrees and that these degrees  should add to 1.  We now describe this extension. To keep notation simple, we will use the same names and symbols as AllenÃ¢Â€Â™s.  The difference will be evident by the probability symbol.  To give an example, the fact that Ã¢Â€Âœthe probability that X and  Y are related by AllenÃ¢Â€Â™s During-i relation (di) is 0.7Ã¢Â€Â will be  denoted as Pr(X di Y) = 0.7.  The reader can easily verify that the proposed extension  will form a probability set, in the sense that:  Ã¢ÂˆÂ€X, Y :  Pr(X b Y) + Pr(X o Y) + Pr(X d Y)  + Pr(X di Y) + Pr(X oi Y) + Pr(X a Y) = 1  5.1. The before and after relations  From Figure 3 one may observe that AllenÃ¢Â€Â™s Before and  After relations are independent of the relative size dimension. Therefore, their probabilistic extension should also be  independent of the relative size of the intervals. Namely, we  may use directly the relative position primitives, as defined  in Eq. (2)-(5), and define Before and After simply as  def  Pr(X b Y) = Pr(X Ã¢Â‰ÅŸ Y)  def  Pr(X a Y) = Pr(X  Y)  Note that we have used the symbols b and a for AllenÃ¢Â€Â™s  relations instead of the commonly used < and > which are  used here for the relative size primitives.  5.2. The during and during-i relations  The definition of these relations is facilitated by three  limits along the relative duration axis of the hourglass, i.e.  when the first interval is (a) infinitely smaller, (b) equisized  and (c) infinitely larger than the second.  At the infinitely smaller limit, the probability of Duringi will always be zero, whereas the probability of During is  complementary to the probability of being before or after,  since no other relation is possible. Therefore the probability  of During is measured here directly by the concurrent with  primitive as defined in Eq. (1):  lim  Pr(X d Y) = Pr(X  Y)  lim  Pr(X di Y) = 0  Pr(X < Y)Ã¢Â†Â’1  Pr(X < Y)Ã¢Â†Â’1  Following similar arguments, for the infinitely larger limit,  the following constraints should be respected:  lim  Pr(X di Y) = Pr(X  Y)  lim  Pr(X d Y) = 0  Pr(X > Y)Ã¢Â†Â’1  Pr(X > Y)Ã¢Â†Â’1  Finally, at the equisized limit, both probabilities should go  to zero:  lim  Pr(X di Y) = 0  lim  Pr(X d Y) = 0  Pr(X Ã¢ÂˆÅº Y)Ã¢Â†Â’1  Pr(X Ã¢ÂˆÅº Y)Ã¢Â†Â’1  Taking into account that both Pr(X < Y) and Pr(X > Y)  go to zero when Pr(X Ã¢ÂˆÅº Y) goes to one (see Eq. (6)-(8)), all  the above constraints are satisfied by the following definitions:  def  Pr(X d Y) = Pr(X < Y) Pr(X  Y)  and  def  Pr(X di Y) = Pr(X > Y) Pr(X  Y)  .  .  (1) X = [1, 12], Y = [10, 20]  b  o  d  0.82  0.14 0.00  di  oi  a  0.04 0.00 0.00  .  .  (3) X = [12, 19], Y = [10, 20]  b  o  d  0.00 0.14  0.86  di  oi  a  0.00 0.00 0.00  .  (5) X = [12, 23], Y = [10, 20]  b  o  d  0.00 0.00 0.01  di  oi  a  0.17  0.55  0.27  lim  Pr(X o Y) = 0  lim  Pr(X oi Y) = 0  Pr(X < Y)Ã¢Â†Â’1  lim  the Overlaps-i) relation is correlated to the probability of  Before (respectively After) relation and that Overlaps and  Overlaps-i can not be simultaneously non-zero. Therefore,  one may add the following constraints:  Pr(X  Y) = 0 :  lim  Pr(X o Y) = Pr(X  Y)  lim  Pr(X oi Y) = 0  Pr(X Ã¢ÂˆÅº Y)Ã¢Â†Â’1  and  Pr(X  Y) > 0 :  lim  Pr(X o Y) = 0  Pr(X Ã¢ÂˆÅº Y)Ã¢Â†Â’1  (Pr(X o Y) + Pr(X oi Y)) = Pr(X  Y)  lim  Pr(X Ã¢ÂˆÅº Y)Ã¢Â†Â’1  Pr(X Ã¢ÂˆÅº Y)Ã¢Â†Â’1  lim  Pr(X o Y) = 0  lim  Pr(X oi Y) = 0  Pr(X > Y)Ã¢Â†Â’1  Pr(X > Y)Ã¢Â†Â’1  These can be verified easily by looking at the hourglass configuration in Figure 3.  In particular, the second constraint here implies that  when two intervals are equisized and they overlap, whether  left or right, the overall extent of the overlap is given by  the ratio of their intersection to their total size. Moreover,  one may notice that the probability of Overlaps (respectively  (6) X = [22, 26], Y = [10, 20]  b  o  d  0.00 0.00 0.00  di  oi  a  0.00 0.00  1.00  Figure 6. Expressiveness and Robustness of probabilistic primitives for ÄÂƒ = 0.10, r = 0.10  Pr(X Ã¢ÂˆÅº Y)Ã¢Â†Â’1  Pr(X < Y)Ã¢Â†Â’1  (4) X = [8, 21], Y = [10, 20]  b  o  d  0.15 0.00 0.00  di  oi  a  0.51  0.26 0.08  .  5.3. The overlaps and overlaps-i relations  Similarly to the During and During-i cases, a number  of constraints may be derived for the three limit cases.  Namely:  (2) X = [8, 19], Y = [10, 20]  b  o  d  0.18  0.62  0.02  di  oi  a  0.19 0.00 0.00  Pr(X oi Y) = Pr(X  Y)  Following similar arguments to Section 5.2, these relations are defined as:  {  Pr(X Ã¢ÂˆÅº Y) Pr(X  Y) Pr(X  Y) = 0  def  Pr(X o Y) =  0  Pr(X  Y) = 0  and  {  Pr(X Ã¢ÂˆÅº Y) Pr(X  Y)  Pr(X oi Y) =  0  def  Pr(X  Y) > 0  .  Pr(X  Y) = 0  6. Examples  To illustrate how the proposed approach improves the robustness and expressiveness of interval relations, we present  here its application to examples similar to those described  in Section 2. In particular, Figure 6 illustrates cases with  different (qualitative) interval relations, namely Overlaps,  During, Overlaps-i and During-i and After. Using the probabilistic extension proposed here, probabilities are obtained  for several relations in each case. The most probable relation is highlighted with bold letters.  In almost all cases, the most probable relation coincides  with the qualitative one, i.e. the one that would have been  obtained by directly applying AllenÃ¢Â€Â™s definitions. However,  probabilities provide additional expressiveness, since their  values depend on the extent to which each relation holds.  For instance, the Overlaps relation in case (2) has greater  probability than the Overlaps-i relation in case (5). This is  because in case (5), the intervals overlap more than in case  (5).  Furthermore, by applying the probabilistic extension proposed here, relations become more robust with respect to  boundary uncertainties. In particular, as one may notice by  looking in case (1), a direct application of AllenÃ¢Â€Â™s definitions  would qualify the relation between X and Y as Overlaps.  However, this hides the fact that X is almost before Y and  the fact that they overlap may be due to uncertain measurements. Using the probabilistic extension, the information  regarding the intervals relation is richer: both Before and  Overlaps have significant probabilities, while Before is the  most probable one.  7. Conclusion and Open Issues  The two-dimensional mapping of AllenÃ¢Â€Â™s interval relations onto parts of an hourglass configuration has been  proven constructive in two ways. First, it allowed us to decompose interval relations into two basic orthogonal dimensions: relative position and relative size of intervals. This  has motivated the definition of two primitive interval relation sets, whose probabilities are defined independently on  one of the two dimensions. Second, it simplified the probabilistic extension of AllenÃ¢Â€Â™s relations by revealing the symmetries of relations and shedding light upon the expected  behavior at the durationless and equisized limits.  To our knowledgeÃ¢Â€Â™, this is the first attempt to assign probability values to interval relations, aiming to make reasoning with uncertain temporal relations more practical. Both  probabilistic primitive relations and probabilistic AllenÃ¢Â€Â™s relations can be used to quantitatively describe the relation  between two intervals. However, the proposed set of probabilistic AllenÃ¢Â€Â™s relations cannot account for relations defined by equalities (e.g. AllenÃ¢Â€Â™s Meets relation). Therefore,  an open issue is to extend the current approach and define  a probability base for AllenÃ¢Â€Â™s relations defined by both inequalities and equalities.  Finally, the framework defined in this paper may be used  in various ways that deviate from the event detection scenario introduced in this article. For instance, in the context of constraint reasoning for planning and scheduling, one  may be given directly the probabilities of Allen relations that  hold between pairs of intervals. The goal in this case, would  be to derive information about the relative size and position  of the corresponding intervals. This is applicable to softdeadline problems and scheduling tasks.  Acknowledgments.  This paper has been supported by the EU, in the context  of the CASAM project (Contract number FP7-217061, Web  site: www.casam-project.eu).  References  [1] J. Allen. An interval-based representation of temporal  knowledge. In Proc. 7th International Joint Conference on  Artificial Intelligence, Vancouver, Canada, pages 221Ã¢Â€Â“226,  1981.  [2] J. Allen. Maintaining knowledge about temporal intervals.  Communications of the ACM, 26(11):832Ã¢Â€Â“843, 1983.  [3] S. Badaloni and M. Giacomin. A fuzzy extension of AllenÃ¢Â€Â™s  interval algebra. AI* IA 99: Advances in Artificial Intelligence, pages 155Ã¢Â€Â“165.  [4] A. Dekhtyar, R. Ross, and V. Subrahmanian. Probabilistic temporal databases, I: algebra. ACM Transactions on  Database Systems (TODS), 26(1):41Ã¢Â€Â“95, 2001.  [5] Z. Ibrahim, I. Ferrane, and P. Joly. Temporal Relation Analysis in Audiovisual Documents for Complementary Descriptive Information. In Adaptive multimedia retrieval: user,  context, and feedback, page 141. Springer-Verlag New York  Inc, 2006.  [6] M. Knauff. The cognitive adequacy of AllenÃ¢Â€Â™s interval calculus for qualitative spatial representation and reasoning. Spatial Cognition and Computation, 1(3):261Ã¢Â€Â“290, 1999.  [7] F. Morchen. A better tool than allenÃ¢Â€Â™s relations for expressing temporal knowledge in interval data. In Workshop on  Temporal Data Mining at the Twelveth ACM SIGKDD International Conference on Knowledge Discovery and Data  Mining, pages 25Ã¢Â€Â“34, 2006.  [8] V. Ryabov and A. Trudel. Probabilistic Temporal Interval  Networks. In Proceedings of the 11th International Symposium on Temporal Representation and Reasoning, page 67.  IEEE Computer Society, 2004.  [9] E. Santos Jr and J. Young. Probabilistic temporal networks:  A unified framework for reasoning with time and uncertainty. International Journal of Approximate Reasoning,  20(3):263Ã¢Â€Â“291, 1999.  [10] C. Snoek and M. Worring. Multimodal video indexing: A  review of the state-of-the-art. Multimedia Tools and Applications, 25(1):5Ã¢Â€Â“35, 2005. 