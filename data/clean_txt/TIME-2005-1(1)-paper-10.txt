Quantitative Temporal Logics: PS PACE and below  Carsten Lutz1 , Dirk Walther2 , and Frank Wolter2  Inst. fuÄšÂˆr Theoretische Informatik, TU Dresden, Germany  lutz@tcs.inf.tu-dresden.de  2  Dept. of Computer Science, University of Liverpool, UK  {D.Walther,frank}@liv.csc.ac.uk  1  Abstract  Often, the addition of metric operators to qualitative  temporal logics leads to an increase of the complexity of  satisfiability by at least one exponential. In this paper, we  exhibit a number of metric extensions of qualitative temporal logics of the real line that do not lead to an increase  in computational complexity. We show that the language  obtained by extending since/until logic of the real line with  the operators Ã¢Â€Â˜sometime within n time unitsÃ¢Â€Â™, n coded in binary, is PS PACE-complete even without the finite variability assumption. Without qualitative temporal operators the  complexity of this language turns out to depend on whether  binary or unary coding of parameters is assumed: it is still  PS PACE-hard under binary coding but in NP under unary  coding.  1  Introduction  The extension of qualitative temporal logics (TLs) with  metric operators has been studied for almost fifteen years  [5, 4, 8]. Of particular interest are metric extensions of temporal logics of the real line, since the resulting quantitative  TLs are an important tool for the specification and verification of real-time systems [2]. Unfortunately, moving from  qualitative to quantitative logics is often accompanied by  an increase in computational complexity of the satisfiability problem. The most important example witnessing this  effect is the PS PACE-complete since/until logic of the real  line [7], whose extension with a metric operator Ã¢Â€Â˜sometime  in at least n but not more than m time unitsÃ¢Â€Â™ (n and m coded  in binary) becomes E XP S PACE-complete if the case n = m  is not admitted, and even undecidable if it is [1, 3, 5].  It is well known that the complexity of the metric temporal logic obtained by this extension can be reduced to  PS PACE again by further restricting the values of n and m,  e.g., by enforcing that n = 0 [1]. However, in contrast to the  E XP S PACE-completeness and undecidability results above,  this improvement has only been proven under the finite variability assumption (FVA) which states that no propositional  variable changes its truth-value infinitely many times in any  finite interval. While the FVA is a natural condition for various computer science applications, we believe that there  are at least two reasons to consider also the non-FVA case:  first, qualitative temporal logic originated in philosophy and  mathematics to study time itself, rather than the behaviour  of systems with discrete state changes as considered in computer science. If quantitative TL is used for the former purpose, the FVA is less convincing than in computer science  applications. Second, even in computer science reasoning  without the FVA can be fruitfully employed: assume that a  formula ÄÂ• of a quantitative TL describes the specification of  a real-time system. Further assume that ÄÂ• has been found  to be unsatisfiable under FVA, indicating that the described  specification is not realizable. If an additional satisfiability  check without FVA is made revealing that dropping FVA  regains satisfiability of ÄÂ•, then the user obtains additional  information on the source of the unrealizability of her specification: namely that it enforces an infinite number of state  changes in a finite interval.  The purpose of this paper is to investigate metric temporal logics of the real line that are at most PS PACE-complete.  More precisely, we prove three results. Our first result is  that extending since/until logic of the real line with metric  operators Ã¢Â€Â˜sometime in at most n time unitsÃ¢Â€Â™, n coded in  binary, is PS PACE-complete even without FVA. (Note that  the logic without FVA is more general than with FVA in  the sense that the latter logic can be polynomially reduced  to the former [5].) To show this result, we propose a new  method for polynomially reducing satisfiability in metric  TLs whose numerical parameters are coded in binary to satisfiability in the same logic with numbers coded in unary.  The essence of the reduction is to introduce new propositional variables that serve as the bits of a binary counter  measuring distances. For the metric TL mentioned above,  we obtain a PSpace upper bound since Hirshfeld and Rabinovich have shown that QTL, i.e., the same logic with num-  bers coded in unary, is PS PACE-complete without FVA [5].  In the technical report accompanying this paper, we show  that our proof method can be used for other logics as well.  For instance, metric extensions of (discrete-time) LTL and  the branching time logic CTL are shown to be in PS PACE  and E XP T IME, respectively [6].  Our second result concerns a sharpening of PS PACE  lower bounds for metric temporal logics of the real line. In  the current literature, such logics usually contain qualititative since/until logic as a proper fragment, and thus trivially  inherit PS PACE-hardness [2, 5, 7]. We consider metric TLs  with weaker qualitative operators and show that PS PACEhardness can already be observed in the following three  cases: (i) a future diamond and a future operator Ã¢Â€Â˜sometime in at most n time unitsÃ¢Â€Â™, n coded in unary; (ii) only the  future operator Ã¢Â€Â˜sometime in at most n time unitsÃ¢Â€Â™, n coded  in binary (i.e., no qualitative operators at all); (iii) only a  metric version of the until operator for the interval [0, 1].  As a third result, we explore the transition from NP  to PS PACE. In particular, we show that the quantitative  TL with only the metric operator Ã¢Â€Â˜sometime within n time  unitsÃ¢Â€Â™, n coded in unary, is NP-complete. This result extends the result of [10] that satisfiability of the qualitative  TL with operators Ã¢Â€Â˜eventually in the futureÃ¢Â€Â™ and Ã¢Â€Â˜eventually  in the pastÃ¢Â€Â™ over the real line is decidable in NP. When compared with result (ii) above, it also shows that the complexity of metric TLs without qualitative operators depends on  the coding of numbers. To establish the NP upper bound,  we show that satisfiability of a formula ÄÂ• can be decided by  first Ã¢Â€Â˜guessingÃ¢Â€Â™ a system of rational linear inequalities, and  checking whether this system has a solution over the real  (or, equivalently, rational) numbers.  2  Preliminaries  We introduce the metric temporal language QTL of [5],  which is closely related to the language MITL of [1]. Fix  a countably infinite supply p0 , p1 , . . . of propositional variables. A QTL-formula is built according to the syntax rule  ÄÂ• := p | Ã‚Å¹ÄÂ• | ÄÂ• Ã¢ÂˆÂ§ ÄÂˆ | ÄÂ• S ÄÂˆ | ÄÂ• U ÄÂˆ | ÄÂ•S I ÄÂˆ | ÄÂ•U I ÄÂˆ  with p ranging over the propositional variables and I ranging over intervals of the forms (0, n), (0, n], [0, n), and  [0, n], where n > 0 is a natural number. The Boolean operators , Ã¢ÂˆÂ¨, Ã¢Â†Â’, and Ã¢Â†Â” are defined as abbreviations in the  usual way. Moreover, we introduce additional future modalities as abbreviations: Ã¢Â™ÅšIF ÄÂ• =  U I ÄÂ•, IF ÄÂ• = Ã‚Å¹Ã¢Â™ÅšIF Ã‚Å¹ÄÂ•,  Ã¢Â™ÅšF ÄÂ• =  U ÄÂ•, and F ÄÂ• = Ã‚Å¹Ã¢Â™ÅšF Ã‚Å¹ÄÂ•. Their past counterparts are defined analogously and have a subscript P .  Note that formulas with rational numbers as parameters  of metric operators S I and U I can be translated (in polynomial time) to satisfiability equivalent formulas contain-  ing only the natural numbers by multiplying with the least  common denominator of all (rational) parameters.  Formulas of QTL are interpreted on the real line. A  model M =  , V is a pair consisting of the real numbers  and a valuation V mapping every propositional variable p  to a set V(p) Ã¢ÂŠÂ† . The satisfaction relation Ã¢Â€Â˜|=Ã¢Â€Â™ is defined  inductively as follows, where we write w + I to denote the  set {w + x | x Ã¢ÂˆÂˆ I} for each time point w Ã¢ÂˆÂˆ and interval  I of one of the above forms; w Ã¢ÂˆÂ’ I is defined analogously.  Ä‚ÂŠ  Ä‚ÂŠ  Ä‚ÂŠ  M, w  M, w  M, w  M, w  |= p  |= Ã‚Å¹ÄÂ•  |= ÄÂ• Ã¢ÂˆÂ§ ÄÂˆ  |= ÄÂ• U ÄÂˆ  iff  iff  iff  iff  M, w |= ÄÂ• S ÄÂˆ  iff  M, w |= ÄÂ• U I ÄÂˆ  iff  M, w |= ÄÂ• S I ÄÂˆ  iff  w Ã¢ÂˆÂˆ V(p)  M, w |= ÄÂ•  M, w |= ÄÂ• and M, w |= ÄÂˆ  there exists u > w such that  M, u |= ÄÂˆ and M, v |= ÄÂ•  for all v such that w < v < u  there exists u < w such that  M, u |= ÄÂˆ and M, v |= ÄÂ•  for all v such that u < v < w  there exists u Ã¢ÂˆÂˆ w + I such that  M, u |= ÄÂˆ and M, v |= ÄÂ•  for all v such that w < v < u  there exists u Ã¢ÂˆÂˆ w Ã¢ÂˆÂ’ I such that  M, u |= ÄÂˆ and M, v |= ÄÂ•  for all v such that u < v < w  Ä‚ÂŠ  We will also write w |=V ÄÂ• for  , V, w |= ÄÂ•. A QTLformula ÄÂ• is satisfiable if there exists a model M and a  w Ã¢ÂˆÂˆ such that M, w |= ÄÂ•. It is satisfiable under the finite  variability assumption (FVA) if it is satisfiable in a model  in which no propositional variable changes its truth-value  infinitely many times in any finite interval.  Our presentation of QTL deviates from that of [5], where  (0,1)  (0,1)  only the metric operators Ã¢Â™ÅšF and Ã¢Â™ÅšP are admitted. If  the numerical parameters of the metric operators are coded  in unary, there exists an easy polynomial translation from  Hirshfeld and RabinovichÃ¢Â€Â™s version of QTL to ours and vice  versa. However, in this paper we also consider binary coding of numbers. If we want to emphasize this fact, we shall  write QTLb instead of QTL, and likewise, QTLu will denote  unary coding of numbers.  We close this section with a discussion of the relation  between temporal logics with and without FVA. The satisfiability of a formula ÄÂ• of a temporal logic with operators  since and until and with FVA can be polynomially reduced  to satisfiability  in the same logic without FVA; see [5]: Let    (P ÃÂ´p Ã¢ÂˆÂ§ ÃÂ´p Ã¢ÂˆÂ§ F ÃÂ´p ) where  ÃÂ´=  Ä‚ÂŠ  p used in ÄÂ•      ÃÂ´p = (p U p) Ã¢ÂˆÂ¨ (Ã‚Å¹p U Ã‚Å¹p)      Ã¢ÂˆÂ§ (p S p) Ã¢ÂˆÂ¨ (Ã‚Å¹p S Ã‚Å¹p) .  Then it is not hard to verify that ÄÂ• is satisfiable with FVA  iff ÄÂ• Ã¢ÂˆÂ§ ÃÂ´ is without FVA. Note that the length of ÄÂ• Ã¢ÂˆÂ§ ÃÂ´ is  polynomial in the length of ÄÂ•. To the best of our knowledge there is no polynomial reduction of this type for the  language without since or until.  3  QTLb is PS PACE-complete without FVA  The purpose of this section is to prove that QTLb satisfiability without FVA is decidable in PS PACE. Note  that, due to polynomial reducibility of QTLb with FVA to  this logic, the upper complexity bound carries over. This result is already known for QTLu without FVA [5] and QTLu  with FVA [1]. We first show that our result indeed improves  upon the existing ones by proving that QTLb is exponentially more succinct than QT Lu .  Theorem 1. Let ÄÂˆ be a QTL-formula with numbers coded  [0,n]  in unary that is equivalent to F p. Then ÄÂˆ has length at  least n.  Proof. Suppose by contradiction that there exists a QTLformula ÄÂˆ with numbers coded in unary such that ÄÂˆ is  [0,n]  equivalent to F p, for some n Ã¢Â‰Ä½ 1, and the length of  ÄÂˆ is strictly smaller than n. We may assume that ÄÂˆ contains  no other propositional letters than p: otherwise, just replace  them with . Then, for n Ã¢Â‰Ä½ 1, set Vn (p) := [Ã¢ÂˆÂ’n, n]  [0,n]  and Mn := R, Vn . Then Mn , 0 |= F p. Therefore,  Mn , 0 |= ÄÂˆ. Now, it is straightforward to prove the following by induction: for every subformula ÄÂ‡ of ÄÂˆ of length Ã¢Â‰Â¤ k  and all x Ã¢Â‰Ä½ k such that n Ã¢ÂˆÂ’ x Ã¢Â‰Ä½ Ã¢ÂˆÂ’n + k:  M, (n Ã¢ÂˆÂ’ k) |= ÄÂ‡ iff Mn , (n Ã¢ÂˆÂ’ x) |= ÄÂ‡.  Since the length of ÄÂˆ is smaller than n, it follows that, in  Mn , the points 0 and 1 satisfy the same subformulas of ÄÂˆ.  In particular, Mn , 1 |= ÄÂˆ. We have derived a contradiction  [0,n]  since Mn , 1 |= F p.  Ã¢ÂÂ  We now establish the first result of this paper.  Theorem 2. Satisfiability in QTL with numbers coded in  binary is PS PACE-complete without FVA.  Since (qualitative) since/until logic on the real line is  PS PACE-hard [7], it suffices to prove the upper bound. For  simplicity, we prove the upper bound for the future fragment  of QTL, i.e., we omit past operators. The proofs are easily  extended to the general case. Within the future fragment,  (0,1)  (0,1]  [0,1)  we consider only the metric operators Ã¢Â™ÅšF , Ã¢Â™ÅšF , Ã¢Â™ÅšF ,  [0,n]  and Ã¢Â™ÅšF . This can be done w.l.o.g. due to the following  observations:  First, satisfiability in QTLb can be reduced to satisfiability in QTLb without the metric operators ÄÂˆ1 U I ÄÂˆ2 : to  decide satisfiability of a QTLb -formula ÄÂ•, introduce a new  propositional variable pÄÂˆ2 for every ÄÂˆ2 which occurs in a  subformula of the form ÄÂˆ1 U I ÄÂˆ2 of ÄÂ•. Inductively define  a translation on QTLb -formulas such that, for any subformula ÄÂ‡ of ÄÂ•, ÄÂ‡p to denotes the result of replacing all outermost subformulas ÄÂˆ1 U I ÄÂˆ2 of ÄÂ‡ by ÄÂˆ1p U pÄÂˆ2 Ã¢ÂˆÂ§ Ã¢Â™ÅšIF pÄÂˆ2 . Set  +  F ÄÂˆ = ÄÂˆ Ã¢ÂˆÂ§ F ÄÂˆ. Then ÄÂ• is satisfiable iff        ÄÂ•p Ã¢ÂˆÂ§ +  (pÄÂˆ2 Ã¢Â†Â” ÄÂˆ2p )  F  ÄÂˆ1 U I ÄÂˆ2 Ã¢ÂˆÂˆsub(ÄÂ•)  is satisfiable. Note that the length of the latter formula is  polynomial in the length of ÄÂ•. Second, for any interval I  of the form (0, n), (0, n], or [0, n) with n > 1, Ã¢Â™ÅšIF ÄÂ• is  [0,nÃ¢ÂˆÂ’1]  equivalent to Ã¢Â™ÅšJF Ã¢Â™ÅšF  ÄÂ•, where J is obtained from I by  replacing the upper interval bound n by 1.  In the following, we reduce satisfiability of QTLb formulas to the satisfiability of QTL1 -formula, i.e., QTLformulas in which all upper interval bounds have value 1.  As the coding of numbers is not an issue in the latter logic,  we obtain a PS PACE upper bound from the result of [5] that  QTLu -satisfiability in models without FVA is decidable in  PS PACE.  Let ÄÂ• be a QTL-formula meeting the restrictions laid out  above. Let k be the greatest number occurring as a parameter to a metric operator in ÄÂ•, nc = log2 (k + 2), and  ÄÂ‡1 , . . . , ÄÂ‡ the subformulas of ÄÂ• that occur as an argument  [0,n]  to a metric operator of the form Ã¢Â™ÅšF with n > 1. We reserve, for 1 Ã¢Â‰Â¤ i Ã¢Â‰Â¤ , fresh propositional variables xi , yi ,  and cinc Ã¢ÂˆÂ’1 , . . . , ci0 that do not occur in ÄÂ•. The sequences  cinc Ã¢ÂˆÂ’1 , . . . , ci0 of propositional variables will be used to implement binary counters, one for each ÄÂ‡i . Intuitively, these  counters measure the distance to the Ã¢Â€ÂœnearestÃ¢Â€Â future occurrence of the formula ÄÂ‡i , rounded up to the next largest natural number. A counter value greater than or equal to k + 1  is a special case indicating that the nearest occurrence is too  far away to be of any relevance. The variables xi and yi will  serve as markers with the following meaning: xi holds in a  point iff there is a natural number n such that ÄÂ‡i holds at distance n, but not in between; similarly, yi holds iff there is a  natural number n such that ÄÂ‡i does not hold at any distance  up to (and including) n, but ÄÂ‡i holds at future points that  converge from the right to the future point with distance n.  In the following, we call the structure imposed on the real  line by the markers xi and yi the (one-dimensional) Ã¢Â€Â˜gridÃ¢Â€Â™.  To implement the counters, we introduce auxiliary formulas. For 1 Ã¢Â‰Â¤ i Ã¢Â‰Â¤ , let  Ã¢Â€Ë˜ (Ci = m) be a formula saying that, at the current  point, the value of the i-th counter is m, for 0 Ã¢Â‰Â¤ m <  2nc . There are exponentially many such formulas, but  we will use only polynomially many of them in the reduction.  Ã¢Â€Ë˜ (Ci Ã¢Â‰Â¤ m) is a formula saying that, at the current point,  the value of the i-th counter does not exceed m, for  0 Ã¢Â‰Â¤ m < 2nc .  Ã¢Â€Ë˜ ÄÂ• := Ã‚Å¹(xi Ã¢ÂˆÂ¨ yi ) U ((xi Ã¢ÂˆÂ¨ yi ) Ã¢ÂˆÂ§ ÄÂ•) says that, at the  next grid point, ÄÂ• is satisfied.  To deal with effects of convergence, it is convenient to introduce an additional abbreviation. The formula rc(ÄÂˆ) :=  Ã‚Å¹(Ã‚Å¹ÄÂˆ U ) Ã¢ÂˆÂ§ Ã‚Å¹ÄÂˆ describes convergence of ÄÂˆ-points from  the right against a point where ÄÂˆ does not hold. We now  inductively define a translation of QTLb -formulas to QTL1 formulas:  pÃ¢ÂˆÂ—  (Ã‚Å¹ÄÂˆ)Ã¢ÂˆÂ—  (ÄÂˆ1 Ã¢ÂˆÂ§ ÄÂˆ2 )Ã¢ÂˆÂ—  (ÄÂˆ1 U ÄÂˆ2 )Ã¢ÂˆÂ—  (Ã¢Â™ÅšIF ÄÂˆ)Ã¢ÂˆÂ—  [0,n]  (Ã¢Â™ÅšF ÄÂ‡i )Ã¢ÂˆÂ—  :=  :=  :=  :=  :=  :=  p  Ã‚Å¹ÄÂˆ Ã¢ÂˆÂ—  ÄÂˆ1Ã¢ÂˆÂ— Ã¢ÂˆÂ§ ÄÂˆ2Ã¢ÂˆÂ—  ÄÂˆ1Ã¢ÂˆÂ— U ÄÂˆ2Ã¢ÂˆÂ—  Ã¢Â™ÅšIF ÄÂˆ Ã¢ÂˆÂ—      (Ci Ã¢Â‰Â¤ n Ã¢ÂˆÂ’ 1) Ã¢ÂˆÂ¨ (Ci = n) Ã¢ÂˆÂ§ Ã‚Å¹yi  ÄÂ‘i4  (0,1]  := Ã‚Å¹(Ci = 0) Ã¢ÂˆÂ§ Ã¢Â™ÅšF (xi Ã¢ÂˆÂ¨ yi ) Ã¢Â†Â’        cit Ã¢ÂˆÂ§ Ã‚Å¹cit Ã¢ÂˆÂ§  (Ã‚Å¹ci Ã¢ÂˆÂ§ ci )    Ã¢ÂˆÂ§  (ci Ã¢Â†Â” ci )  =t+1..nc Ã¢ÂˆÂ’1  ÄÂ‘i5  [0,1)  := Ã‚Å¹Ã¢Â™ÅšF  =0..tÃ¢ÂˆÂ’1    Ã¢ÂˆÂ¨    (ci Ã¢ÂˆÂ§ ci )  Qualitative since/until logic on the real line is PS PACEcomplete, and thus not computationally simpler than QTLb .  However, several natural fragments are only NP-complete,  an important example being the qualitative TL with temporal operators Ã¢Â€Â˜eventually in the futureÃ¢Â€Â™ and Ã¢Â€Â˜eventually in the  pastÃ¢Â€Â™ [10]. In this section, we explore the transition from  NP to PS PACE for fragments of quantitative logics of the  real line, i.e., for QTL and its fragments. We start with determining several weak, but still PS PACE-hard fragments of  QTL. Observe that two of the fragments are purely quantitative, i.e., they do not admit qualitative temporal operators  at all.  [0,n]     (0,1)  := yi Ã¢Â†Â” rc(ÄÂ‡Ã¢ÂˆÂ—i ) Ã¢ÂˆÂ¨ F (Ã‚Å¹ÄÂ‡Ã¢ÂˆÂ—i Ã¢ÂˆÂ§ Ã‚Å¹xi Ã¢ÂˆÂ§ Ã‚Å¹yi )    (0,1]  Ã¢ÂˆÂ§ Ã¢Â™ÅšF yi Ã¢ÂˆÂ§ Ã¢Â™ÅšF rc(ÄÂ‡Ã¢ÂˆÂ—i )  t=0..nc Ã¢ÂˆÂ’1  From NP to PS PACE  Theorem 4. Satisfiability (with and without FVA) is  PS PACE-hard for the fragments of QTL whose only temporal operators are:  Here, I ranges over intervals (0, 1], (0, 1), and [0, 1). It  remains to enforce the existence of the grid and the behavior  of the counters as described above. This is done with the  following auxiliary formulas, for 1 Ã¢Â‰Â¤ i Ã¢Â‰Â¤ :      ÄÂ‘i1 := (Ci = 0) Ã¢Â†Â” ÄÂ‡Ã¢ÂˆÂ—i Ã¢ÂˆÂ¨ rc(ÄÂ‡Ã¢ÂˆÂ—i )     (0,1)  ÄÂ‘i2 := xi Ã¢Â†Â” ÄÂ‡Ã¢ÂˆÂ—i Ã¢ÂˆÂ¨ F (Ã‚Å¹ÄÂ‡Ã¢ÂˆÂ—i Ã¢ÂˆÂ§ Ã‚Å¹xi Ã¢ÂˆÂ§ Ã‚Å¹yi )    (0,1]  Ã¢ÂˆÂ§ Ã¢Â™ÅšF xi Ã¢ÂˆÂ§ Ã¢Â™ÅšF ÄÂ‡Ã¢ÂˆÂ—i  ÄÂ‘i3  4    =0..nc Ã¢ÂˆÂ’1  (xi Ã¢ÂˆÂ¨ yi ) Ã¢Â†Â’ (Ci = 2nc Ã¢ÂˆÂ’ 1)  Intuitively, ÄÂ‘i1 initializes the counter, ÄÂ‘i2 and ÄÂ‘i3 ensure that  the grid points xi and yi behave as described above, ÄÂ‘i4 increments the counter when travelling to the left, and ÄÂ‘i5 ensures that, when travelling left, the counter stays in maximal  value after the last occurrence of ÄÂ‡Ã¢ÂˆÂ—i . Let ÄÂ‘i be the conjunction of ÄÂ‘i1 to ÄÂ‘i5 . The following is proved in [6] and finishes  the reduction.  Lemma 3. ÄÂ• is satisfiable iff F (ÄÂ‘1 Ã¢ÂˆÂ§ Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ Ã¢ÂˆÂ§ ÄÂ‘ ) Ã¢ÂˆÂ§ ÄÂ•Ã¢ÂˆÂ— is  satisfiable.  (i) Ã¢Â™ÅšF and Ã¢Â™ÅšF  [0,n]  (ii) Ã¢Â™ÅšF  with n > 0 coded in unary;  with n > 0 coded in binary;  (iii) U [0,1] .  Point (i) is proved by reducing satisfiability in LTL (i.e.,  qualitative temporal logic of the natural numbers) with the  only temporal operators  and Ã¢Â™ÅšF (which is PS PACE-hard  [9]) to satisfiability in the logic defined in (i). To do so, the  main task is to represent the discrete natural numbers on the  real line by alternating intervals making a true and intervals making Ã‚Å¹a true, with the former representing the time  points of discrete time. This structure is enforced such that  the length of the a-intervals is between 2 and 3 (including  2), the length of the Ã‚Å¹a-intervals is between 7 and 8 (including 7), and the length of an a-interval together with the  subsequent Ã‚Å¹a interval is between 9 and 10. This is done  by the formula ÄÂ‘ = ÄÂ‘1 Ã¢ÂˆÂ§ ÄÂ‘2 Ã¢ÂˆÂ§ ÄÂ‘3 :  ÄÂ‘1  ÄÂ‘2  ÄÂ‘3  [0,2]  = F a,  [0,3] [0,7]  = F (a Ã¢Â†Â’ Ã¢Â™ÅšF F Ã‚Å¹a),  [0,10] [0,2]  = F (a Ã¢Â†Â’ Ã¢Â™ÅšF F a).  For the reduction, inductively define a translation (Ã‚Ë‡)Ã¢ÂˆÂ— as  follows:  pÃ¢ÂˆÂ—  (Ã‚Å¹ÄÂˆ)Ã¢ÂˆÂ—  (ÄÂˆ1 Ã¢ÂˆÂ§ ÄÂˆ2 )Ã¢ÂˆÂ—  (ÄÂˆ)Ã¢ÂˆÂ—  (Ã¢Â™ÅšF ÄÂˆ)Ã¢ÂˆÂ—  :=  :=  :=  :=  :=  p  Ã‚Å¹ÄÂˆ Ã¢ÂˆÂ—  ÄÂˆ1Ã¢ÂˆÂ— Ã¢ÂˆÂ§ ÄÂˆ2Ã¢ÂˆÂ—    [0,3]  [0,7]  [0,8]  Ã¢Â™ÅšF F Ã‚Å¹a Ã¢ÂˆÂ§ Ã¢Â™ÅšF (ÄÂˆ Ã¢ÂˆÂ— Ã¢ÂˆÂ§ a)  Ã¢Â™ÅšF (Ã‚Å¹a Ã¢ÂˆÂ§ Ã¢Â™ÅšF (ÄÂˆ Ã¢ÂˆÂ— Ã¢ÂˆÂ§ a))  Additionally, a formula ÄÂ‘ is needed to take care of uniformity, i.e., to make sure that the same propositional variables  hold in all points of an interval that makes a true:       [0,3]  p Ã¢ÂˆÂ§ a Ã¢Â†Â’ F (a Ã¢Â†Â’ p)  ÄÂ‘ = F  p used in ÄÂ•      [0,3]  Ã¢ÂˆÂ§ Ã‚Å¹p Ã¢ÂˆÂ§ a Ã¢Â†Â’ F (a Ã¢Â†Â’ Ã‚Å¹p) .  Now, ÄÂ• is satisfiable over the natural numbers iff ÄÂ•Ã¢ÂˆÂ— Ã¢ÂˆÂ§ ÄÂ‘ Ã¢ÂˆÂ§  ÄÂ‘ Ã¢ÂˆÂ§ a is satisfiable over the real numbers with FVA iff it is  satisfiable over the real numbers without FVA.  A similar reduction can be used to prove (ii). Notice that  satisfiability in LTL is already PS PACE-hard if the natural  numbers are replaced by a finite strict linear order (an initial  segment of the natural numbers). Moreover, any formula ÄÂ•  which is satisfiable in a finite strict linear order is also satisfiable in a finite strict linear order of length not exceeding  [0,n]  2|ÄÂ•| . Based on this observation, using the operator Ã¢Â™ÅšF ,  n > 0 coded in binary, instead of Ã¢Â™ÅšF , we can reduce satisfiability of an LTL-formula ÄÂ• in such a finite strict linear  order to satisfiability over the real line (with and without  FVA).  Finally, (iii) can be proved by reducing satisfiability over  the real line in the qualitative fragment of QTL with the  only temporal operator U (which is PS PACE-hard) to satisfiability of formulas with the operator U [0,1] over the interval  (0, 1); details can be found in [6].  We now exhibit a purely quantitative temporal logic of  the real line for which satisfiability is NP-complete: the  fragment of QTL with only the quantitative diamond and  numbers coded in unary, with and without FVA. This logic  may appear rather weak since it does not allow to make  statements about all time points. Still, it is useful for reasoning about the behaviour of systems up to a previously  fixed time point. Note that our NP-completeness result  shows that Points (i) and (ii) of Theorem 4 are optimal in  the following sense: in Point (i) we cannot drop Ã¢Â™ÅšF , and in  Point (ii) we cannot switch to unary coding.  Theorem 5. In the fragment of QTL with temporal operators Ã¢Â™ÅšIF and Ã¢Â™ÅšIP , I of the form (0, n), [0, n), [0, n], or (0, n],  and n > 0 coded in unary, satisfiability is decidable in NP,  both, with and without FVA.  The lower bound is immediate from propositional logic and  thus we only have to prove the upper bound. Since numbers  are coded in unary, we may restrict our attention to temporal  operators whose upper interval bound is 1. In the proof, we  [0,1]  only consider the temporal operator Ã¢Â™ÅšF . An extension to  past operators and open intervals is straightforward.  Let ÄÂ• be a formula whose satisfiability is to be decided.  We introduce some convenient abbreviations: mÄÂ• denotes  the nesting depth of operators Ã¢Â™ÅšIF in ÄÂ• (henceforth diamond  depth), nÄÂ• = 2|ÄÂ•|3 + |ÄÂ•|2 , and rÄÂ• = |ÄÂ•| Ä‚Â— nÄÂ• . Denote  by cl(ÄÂ•) the closure of the set of subformulas of ÄÂ• under  single negation. A type t for ÄÂ• is a subset of cl(ÄÂ•) such that  (i) Ã‚Å¹ÄÂˆ Ã¢ÂˆÂˆ t iff ÄÂˆ Ã¢ÂˆÂˆ t for each Ã‚Å¹ÄÂˆ Ã¢ÂˆÂˆ cl(ÄÂ•), and (ii) ÄÂˆ1 Ã¢ÂˆÂ§ÄÂˆ2 Ã¢ÂˆÂˆ  t iff ÄÂˆ1 , ÄÂˆ2 Ã¢ÂˆÂˆ t for each ÄÂˆ1 Ã¢ÂˆÂ§ ÄÂˆ2 Ã¢ÂˆÂˆ cl(ÄÂ•). For a model   , V and w Ã¢ÂˆÂˆ , set  Ä‚ÂŠ  Ä‚ÂŠ  t(w)  t< (w)  = {ÄÂˆ Ã¢ÂˆÂˆ cl(ÄÂ•) | w |=V ÄÂˆ},  = {Ã¢Â™ÅšIF ÄÂˆ Ã¢ÂˆÂˆ cl(ÄÂ•) | w |=V Ã¢Â™ÅšIF ÄÂˆ}.  Notice that t(w) is a type for ÄÂ•. First, we devise an algorithm for satisfiability without FVA. To begin with, we show  that satisfiability of ÄÂ• implies satisfiability of ÄÂ• in a Ã¢Â€Â˜homogeneousÃ¢Â€Â™ model. In particular, in such models the number  of realized types is polynomial in the length of ÄÂ•.  Lemma 6. Let ÄÂ• be satisfiable without FVA. Then there is a  sequence x0 , . . . , xnÄÂ• in such that 0 = x0 < x1 < Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ <  xnÄÂ• = mÄÂ• , and a valuation V such that  , V, 0 |= ÄÂ•  and  Ä‚ÂŠ  Ä‚ÂŠ  Ã¢Â€Ë˜ |{t(w) | 0 Ã¢Â‰Â¤ w Ã¢Â‰Â¤ mÄÂ• }| Ã¢Â‰Â¤ rÄÂ• ;  Ã¢Â€Ë˜ for every n with 0 Ã¢Â‰Â¤ n < nÄÂ• and each type t for ÄÂ•, the  set {w Ã¢ÂˆÂˆ | xn < w < xn+1 and w |=V t} is either  empty or dense in the interval (xn , xn+1 ).  Ä‚ÂŠ  Ä‚ÂŠ  Proof. Consider a model M =  , V  with M, 0 |= ÄÂ•. By  the semantics, we clearly have the following:  Ä‚ÂŠ  |0Ã¢Â‰Â¤w Ã¢Â‰Â¤  (Ã¢ÂˆÂ—) for any Ã¢Â™ÅšIF ÄÂˆ Ã¢ÂˆÂˆ sub(ÄÂ•), the set {w Ã¢ÂˆÂˆ  mÄÂ• and w |=V Ã¢Â™ÅšIF ÄÂˆ} is a union of intervals of length  at least 1 and at most two intervals of length smaller  than 1.  The two possibly shorter intervals are the one starting at 0  and the one ending at mÄÂ• . Using (Ã¢ÂˆÂ—), we can show that there  is a sequence y0 , . . . , yk in for some k Ã¢Â‰Â¤ 2|ÄÂ•|2 +|ÄÂ•| such  that  Ä‚ÂŠ  Ã¢Â€Ë˜ 0 = y0 < Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ < yk = mÄÂ• and  Ã¢Â€Ë˜ t< (w) = t< (w ) whenever yi < w < w < yi+1 for  any i < k.  To see this, take a formula Ã¢Â™ÅšIF ÄÂˆ Ã¢ÂˆÂˆ sub(ÄÂ•). The toggle  points for Ã¢Â™ÅšIF ÄÂˆ in the interval [0, mÄÂ• ] are those points x  such that either (i) there is a y > x such that the truth value  of Ã¢Â™ÅšIF ÄÂˆ at x is different from the truth value of Ã¢Â™ÅšIF ÄÂˆ at all  points z with x < z < y or (ii) there is a y < x such that  the truth value of Ã¢Â™ÅšIF ÄÂˆ at x is different from the truth value  of Ã¢Â™ÅšIF ÄÂˆ at all points z with y < z < x. By (Ã¢ÂˆÂ—), there are at  most 2 Ã‚Ë‡ mÄÂ• + 1 < 2 Ã‚Ë‡ |ÄÂ•| + 1 toggle points for each formula  Ã¢Â™ÅšIF ÄÂˆ, and thus at most 2|ÄÂ•|2 + |ÄÂ•| toggle points altogether.  These points form the required sequence y0 , . . . , yk .  We convert this sequence into the desired sequence  x0 , . . . , xnÄÂ• by arranging the elements of the set  {y0 , . . . , yk } Ã¢ÂˆÅ  {yi + j | yi + j < mÄÂ• }  i<k  1Ã¢Â‰Â¤j<mÄÂ•  in ascending order according to Ã¢Â€Â˜<Ã¢Â€Â™, possibly introducing (arbitrary) intermediate points to obtain a sequence of  length nÄÂ• + 1.  To obtain a valuation V as required by the lemma, fix a  set Ti of types for each i < nÄÂ• as follows: for each Ã¢Â™ÅšIF ÄÂˆ Ã¢ÂˆÂˆ  sub(ÄÂ•), choose a w Ã¢ÂˆÂˆ (xi , xi+1 ) with ÄÂˆ Ã¢ÂˆÂˆ t(w) if such a  w exists. Then, Ti is the set of types t(w) of all points w  chosen in this way. Clearly |Ti | Ã¢Â‰Â¤ |ÄÂ•|. For each i < nÄÂ• ,  take a collection (Xti )tÃ¢ÂˆÂˆTi , of subsets of (xi , xi+1 ) which  form a partitioning of (xi , xi+1 ) such that each Xti is dense  in (xi , xi+1 ). Now define a valuation V by setting, for every  propositional variable p,  V(p) := (V (p) Ã¢ÂˆÅ  {x0 , . . . , xnÄÂ• }) Ã¢ÂˆÅ  {Xti | p Ã¢ÂˆÂˆ t}.  i<nÄÂ• ,tÃ¢ÂˆÂˆTi  Let ti , i Ã¢Â‰Â¤ nÄÂ• , be the type {ÄÂˆ Ã¢ÂˆÂˆ sub(ÄÂ•) | xi |=V ÄÂˆ} for  ÄÂ• realized in point xi of the original model M. To show  that V is as required, it is sufficient to show that, for each  k Ã¢Â‰Â¤ mÄÂ• , each ÄÂˆ Ã¢ÂˆÂˆ sub(ÄÂ•) with diamond depth bounded  by k, and each w Ã¢ÂˆÂˆ [0, mÄÂ• Ã¢ÂˆÂ’ k], we have  w |=V ÄÂˆ  iff there is an i Ã¢Â‰Â¤ nÄÂ• such that  (a) w = xi and ÄÂˆ Ã¢ÂˆÂˆ ti , or  (b) w Ã¢ÂˆÂˆ Xti and ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Ti .  Proof. Let k, ÄÂˆ, and w be as above. The proof is by induction on the structure of ÄÂˆ. The cases for propositional  variables, Ã‚Å¹, and Ã¢ÂˆÂ§ are left to the reader. Consider the case  [0,1]  for Ã¢Â™ÅšF .  [0,1]  Ã¢Â€ÂœÃ¢Â‡Â’Ã¢Â€Â: Suppose w |=V Ã¢Â™ÅšF ÄÂˆ. Then there is a w Ã¢ÂˆÂˆ  w + [0, 1] such that w |=V ÄÂˆ by the semantics. Distinguish four cases:  Ã¢Â€Ë˜ w = xi for some i Ã¢Â‰Â¤ nÄÂ• and w = xj for some j Ã¢Â‰Ä½ i.  By (a), the induction hypothesis yields ÄÂˆ Ã¢ÂˆÂˆ tj . Then  [0,1]  xj |=V ÄÂˆ. From xj Ã¢ÂˆÂ’ xi Ã¢Â‰Â¤ 1 follows xi |=V Ã¢Â™ÅšF ÄÂˆ.  [0,1]  Hence Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ ti .  Ã¢Â€Ë˜ w = xi for some i Ã¢Â‰Â¤ nÄÂ• and w Ã¢ÂˆÂˆ Xtj for some j with  i Ã¢Â‰Â¤ j < nÄÂ• and t Ã¢ÂˆÂˆ Tj . The induction hypothesis  in (b) yields ÄÂˆ Ã¢ÂˆÂˆ t. Then, by definition of Tj , there  is a w Ã¢ÂˆÂˆ (xj , xj+1 ) such that w |=V ÄÂˆ. Note that  there is an  with i <  Ã¢Â‰Â¤ nÄÂ• such that x = xi + 1.  But then xj+1 Ã¢Â‰Â¤ x ; otherwise w Ã¢ÂˆÂˆ Xtj contradicts  w Ã¢ÂˆÂˆ w + [0, 1]. Now, from w Ã¢ÂˆÂ’ w < 1 follows  [0,1]  [0,1]  w |=V Ã¢Â™ÅšF ÄÂˆ. Hence Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ ti .  Ã¢Â€Ë˜ w Ã¢ÂˆÂˆ Xti for some i < nÄÂ• and t Ã¢ÂˆÂˆ Ti , and w = xj  for some j > i. By (a), the induction hypothesis yields  ÄÂˆ Ã¢ÂˆÂˆ tj . Then xj |=V ÄÂˆ. Now, from xj Ã¢ÂˆÂ’ w Ã¢Â‰Â¤ 1  [0,1]  follows w |=V Ã¢Â™ÅšF ÄÂˆ. But then, by definition of  the sequence x0 , . . . , xnÄÂ• , it holds that, for all w Ã¢ÂˆÂˆ  [0,1]  [0,1]  (xi , xi+1 ), w |=V Ã¢Â™ÅšF ÄÂˆ. Therefore, Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ t  [0,1]  for any t Ã¢ÂˆÂˆ Ti . Hence Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ t.  Ã¢Â€Ë˜ w Ã¢ÂˆÂˆ Xti for some i < nÄÂ• and t Ã¢ÂˆÂˆ Ti , and w Ã¢ÂˆÂˆ Xtj  for some j with i Ã¢Â‰Â¤ j < nÄÂ• and t Ã¢ÂˆÂˆ Tj . This case is  similar to the previous cases and left to the reader, see  [6].  Ã¢Â€ÂœÃ¢Â‡ÂÃ¢Â€Â: Let i Ã¢Â‰Â¤ nÄÂ• such that  [0,1]  [0,1]  (a) w = xi and Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ ti . Then xi |=V Ã¢Â™ÅšF ÄÂˆ. There  is a w Ã¢ÂˆÂˆ xi + [0, 1] such that w |=V ÄÂˆ. Distinguish  two cases:  Ã¢Â€Â“ w = xj for some j with i Ã¢Â‰Â¤ j Ã¢Â‰Â¤ nÄÂ• . Then  ÄÂˆ Ã¢ÂˆÂˆ tj . The induction hypothesis in (a) yields  w |=V ÄÂˆ. From w Ã¢ÂˆÂ’ xi Ã¢Â‰Â¤ 1 follows xi |=V  [0,1]  Ã¢Â™ÅšF ÄÂˆ.  Ã¢Â€Â“ w Ã¢ÂˆÂˆ (xj , xj+1 ) for some j with i Ã¢Â‰Â¤ j < nÄÂ• .  By definition of Tj , there is a t Ã¢ÂˆÂˆ Tj such that  ÄÂˆ Ã¢ÂˆÂˆ t. The induction hypothesis in (b) yields  w |=V ÄÂˆ for any w Ã¢ÂˆÂˆ Xtj . Since Xtj is dense  in (xj , xj+1 ), there is such a w such that w Ã¢Â‰Â¤  [0,1]  w . Then w Ã¢ÂˆÂ’ xi Ã¢Â‰Â¤ 1. Hence, xi |=V Ã¢Â™ÅšF ÄÂˆ.  [0,1]  (b) w Ã¢ÂˆÂˆ Xti and Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Ti . This case is  similar to the previous one and left to the reader.  Ã¢ÂÂ  Lemma 6 suggests the following idea for deciding in nondeterministic polynomial time whether a formula ÄÂ• is satisfiable: guess a (polynomially bounded) set of types for  ÄÂ• to be realized in a homogeneous model, a sequence  v0 , . . . , vnÄÂ• of variables, and construct a system of linear  inequalities whose solution in determines a sequence of  points x0 , . . . , xnÄÂ• from which we can build a homogeneous model realizing the guessed types. More precisely,  to decide the satisfiability of ÄÂ•, we non-deterministically  choose  Ä‚ÂŠ  Ã¢Â€Ë˜ a set T of types for ÄÂ• such that |T | Ã¢Â‰Â¤ rÄÂ• ;  Ã¢Â€Ë˜ a type ti Ã¢ÂˆÂˆ T such that ÄÂ• Ã¢ÂˆÂˆ t0 , for every i Ã¢Â‰Â¤ nÄÂ• ;  Ã¢Â€Ë˜ a non-empty set of types Ti Ã¢ÂŠÂ† T , for every i < nÄÂ• .  Intuitively, the type ti is to be realized at point xi , and the  types in Ti are those types realized in the interval (xi , xi+1 ).  Then, we take variables v0 , . . . , vnÄÂ• and check whether the  system of inequalities given in Figure 1 has a solution in .  The Inequalities 2 to 9 are only added if i < nÄÂ• . To understand the inequalities (in particular 4 and 5), note that the  point xi described by variable vi is not intended to realize  the whole type ti , but only those elements of ti whose diamond depth is at most mÄÂ• Ã¢ÂˆÂ’ xi . Similarly, points from  Ä‚ÂŠ  (1) 0 = v0 < v1 < Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ < vnÄÂ• = mÄÂ•  [0,1]  ÄÂˆ Ã¢ÂˆÂˆ ti , j Ã¢Â‰Ä½ i, and ÄÂˆ Ã¢ÂˆÂˆ tj  [0,1]  ÄÂˆ Ã¢ÂˆÂˆ ti , j Ã¢Â‰Ä½ i, and ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Tj  (2) vj Ã¢ÂˆÂ’ vi > 1  if Ã‚Å¹Ã¢Â™ÅšF  (3) vj Ã¢ÂˆÂ’ vi Ã¢Â‰Ä½ 1  if Ã‚Å¹Ã¢Â™ÅšF  [0,1]  ÄÂˆ Ã¢ÂˆÂˆ ti , but there is no j Ã¢Â‰Ä½ i such that ÄÂˆ Ã¢ÂˆÂˆ tj or ÄÂˆ Ã¢ÂˆÂˆ t for a t Ã¢ÂˆÂˆ Tj  [0,1]  ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Ti , there is no j > i such that ÄÂˆ Ã¢ÂˆÂˆ tj ,  (4) mÄÂ• Ã¢ÂˆÂ’ vi < 1 if Ã¢Â™ÅšF  (5) mÄÂ• Ã¢ÂˆÂ’ vi Ã¢Â‰Â¤ 1 if Ã¢Â™ÅšF  and there is no j Ã¢Â‰Ä½ i such that ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Tj  (6) vj Ã¢ÂˆÂ’ vi Ã¢Â‰Â¤ 1  [0,1]  if Ã¢Â™ÅšF  ÄÂˆ Ã¢ÂˆÂˆ ti and j Ã¢Â‰Ä½ i is minimal such that ÄÂˆ Ã¢ÂˆÂˆ tj and,  for every j  with i Ã¢Â‰Â¤ j  < j, ÄÂˆ Ã¢ÂˆÂˆ t for any t Ã¢ÂˆÂˆ Tj   (7) vj Ã¢ÂˆÂ’ vi < 1  [0,1]  if Ã¢Â™ÅšF  ÄÂˆ Ã¢ÂˆÂˆ ti and j Ã¢Â‰Ä½ i is minimal such that ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Tj and  there is no j  with i Ã¢Â‰Â¤ j  Ã¢Â‰Â¤ j such that ÄÂˆ Ã¢ÂˆÂˆ tj   (8) vj Ã¢ÂˆÂ’ vi Ã¢Â‰Â¤ 1  [0,1]  if Ã¢Â™ÅšF  ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Ti , ÄÂˆ Ã¢ÂˆÂˆ t for any t Ã¢ÂˆÂˆ Ti , and j > i is minimal  such that ÄÂˆ Ã¢ÂˆÂˆ tj or ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Tj  [0,1]  (9) vj Ã¢ÂˆÂ’ vi+1 Ã¢Â‰Ä½ 1 if Ã‚Å¹Ã¢Â™ÅšF  ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Ti , and (j Ã¢Â‰Ä½ i and ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Tj ) or  (j > i and ÄÂˆ Ã¢ÂˆÂˆ tj )  Figure 1. The system of inequalities.  (xi , xi+1 ) described by a type t Ã¢ÂˆÂˆ Ti realize only elements  of t whose diamond depth is at most mÄÂ• Ã¢ÂˆÂ’ xi ; cf. the  structural induction in the proof of Lemma 6.  The algorithm runs in non-deterministic polynomial time  and returns Ã¢Â€Â˜ÄÂ• is satisfiableÃ¢Â€Â™ if there is a solution to this system of inequalities, and Ã¢Â€Â˜ÄÂ• is not satisfiableÃ¢Â€Â™ otherwise. By  considering the contrapositive, it is easily seen that ÄÂ• is unsatisfiable if the algorithm answers Ã¢Â€Â˜noÃ¢Â€Â™: if ÄÂ• has a model,  then by Lemma 6 it also has a homogeneous model, and this  model suggests a choice of types such that the corresponding system of inequalities is satisfiable. Conversely, if the  algorithm returns Ã¢Â€Â˜yesÃ¢Â€Â™, we can construct a homogeneous  model:  Lemma 7. If the algorithm returns Ã¢Â€Â˜ÄÂ• is satisfiableÃ¢Â€Â™, then  ÄÂ• is satisfiable.  Proof. Suppose there are types ti , i Ã¢Â‰Â¤ nÄÂ• , and sets of types  Ti , i < nÄÂ• , such that there is a solution x0 , . . . , xnÄÂ• for  the corresponding system of inequalities. For i < nÄÂ• , take  a partitioning (Xti )tÃ¢ÂˆÂˆTi of (xi , xi+1 ) such that each Xti is  dense in (xi , xi+1 ). Now define a valuation V by putting,  for every propositional variable p,      V(p) :=  {Xti | p Ã¢ÂˆÂˆ t} .  {xi | p Ã¢ÂˆÂˆ ti } Ã¢ÂˆÅ  iÃ¢Â‰Â¤nÄÂ•  i<nÄÂ• ,tÃ¢ÂˆÂˆTi  In [6], the following is proved: for all k Ã¢Â‰Â¤ mÄÂ• , all  ÄÂˆ Ã¢ÂˆÂˆ sub(ÄÂ•) with diamond depth bounded by k, and all  w Ã¢ÂˆÂˆ [0, mÄÂ• Ã¢ÂˆÂ’ k], we have  w |=V ÄÂˆ  iff  there is an i Ã¢Â‰Â¤ nÄÂ• such that  (a) w = xi and ÄÂˆ Ã¢ÂˆÂˆ ti , or  (b) w Ã¢ÂˆÂˆ Xti and ÄÂˆ Ã¢ÂˆÂˆ t for some t Ã¢ÂˆÂˆ Ti .  It is an immediate consequence that 0 |=V ÄÂ•.  Ã¢ÂÂ  We now come to the proof of Theorem 5 with FVA. Again,  the first step is to show that if ÄÂ• is satisfiable under FVA,  then it is satisfiable in a homogeneous model (this time with  FVA) in which only polynomially many types are realized:  Lemma 8. Suppose ÄÂ• is satisfiable with FVA. Then there  exists a sequence z0 , . . . , zrÄÂ• in such that 0 = z0 < z1 <  Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ < zrÄÂ• = mÄÂ• , and a valuation V such that  , V, 0 |=  ÄÂ• and  Ä‚ÂŠ  Ä‚ÂŠ  Ã¢Â€Ë˜ |{t(w) | 0 Ã¢Â‰Â¤ w Ã¢Â‰Â¤ mÄÂ• }| Ã¢Â‰Â¤ rÄÂ• ;  Ã¢Â€Ë˜ for all n with 0 Ã¢Â‰Â¤ n < rÄÂ• , all ÄÂˆ Ã¢ÂˆÂˆ sub(ÄÂ•), and all  zn < w < w < zn+1 , w |=V ÄÂˆ iff w |=V ÄÂˆ.  Ä‚ÂŠ  Proof. Consider a model M =  , V  with FVA satisfying  ÄÂ• in 0. First, construct a sequence 0 = y0 < y1 < Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ <  yk = mÄÂ• , k Ã¢Â‰Â¤ 2|ÄÂ•|2 + |ÄÂ•|, as in Lemma 6. Then the  sequence x0 , . . . , xnÄÂ• is obtained by arranging the elements  of the set  {y0 , . . . , yk } Ã¢ÂˆÅ  {yi + j | yi + j < mÄÂ• }  i<k  1Ã¢Â‰Â¤j<mÄÂ•  Ã¢ÂˆÅ  {yi Ã¢ÂˆÂ’ j | yi Ã¢ÂˆÂ’ j > 0}  iÃ¢Â‰Â¤k  1Ã¢Â‰Â¤j<mÄÂ•  in ascending order according to < (where we possibly have  to add new xi to obtain a sequence of length nÄÂ• + 1). Let  ÄÂƒ = min{xi+1 Ã¢ÂˆÂ’ xi | 0 Ã¢Â‰Â¤ i < nÄÂ• },  and set, for i < nÄÂ• , ÄÂƒi =  1  |ÄÂ•|i+1  Ä‚Â— ÄÂƒ. The sequence  0 = z0 < z1 < Ã‚Ë‡ Ã‚Ë‡ Ã‚Ë‡ < zrÄÂ• = mÄÂ•  is obtained by adding to the sequence x0 , . . . , xnÄÂ• the  points  j  yij = xi +  Ä‚Â— ÄÂƒi ,  |ÄÂ•|  for all i < nÄÂ• and j Ã¢Â‰Â¤ |ÄÂ•|. For i < nÄÂ• , denote by tÃ¢ÂˆÂ’i the  type t which is realized in some interval of the form (xi , y).  Note that such an interval exists since we are in a model  with FVA. Also, denote by t+i the type which is realized in  some interval of the form (y, xi+1 ). Now, for i < nÄÂ• , take  for any Ã¢Â™ÅšIF ÄÂˆ Ã¢ÂˆÂˆ sub(ÄÂ•) such that there exists w Ã¢ÂˆÂˆ (xi , xi+1 )  with ÄÂˆ Ã¢ÂˆÂˆ t(w) such a type t(w) and denote the collection of  selected types plus the types tÃ¢ÂˆÂ’i and t+i by Ti . Notice that  |Ti | Ã¢Â‰Â¤ |ÄÂ•|. Let ti0 , . . . , ti|ÄÂ•|Ã¢ÂˆÂ’1 be an ordering of the types in  Ti such that ti0 = tÃ¢ÂˆÂ’i (if Ti has cardinality < |ÄÂ•|, then take  some t from Ti more than once in this ordering.) Define a  valuation V by setting, for every propositional variable p,  V(p) = {xi | i Ã¢Â‰Â¤ nÄÂ• , xi |=V p}  {(yij , yij+1 ] | p Ã¢ÂˆÂˆ tij }  Ã¢ÂˆÅ  i<nÄÂ• ,j<|ÄÂ•|  |ÄÂ•|  Ã¢ÂˆÅ  i<nÄÂ•  {(yi , xi+1 ) | p Ã¢ÂˆÂˆ t+i }.  We show that V is as required. To this end, it is sufficient  to show by induction that, for each k Ã¢Â‰Â¤ mÄÂ• , every ÄÂˆ Ã¢ÂˆÂˆ  [0,1]  sub(ÄÂ•) in which the number of nestings of Ã¢Â™ÅšF does not  exceed k, and all w Ã¢ÂˆÂˆ [0, mÄÂ• Ã¢ÂˆÂ’ k]:  w |=V ÄÂˆ Ã¢Â‡Â” there is an i Ã¢Â‰Â¤ nÄÂ• such that  (a) w = xi and xi |=V ÄÂˆ, or  (b) w Ã¢ÂˆÂˆ (yi , yi+1 ] and ÄÂˆ Ã¢ÂˆÂˆ ti for  some  < |ÄÂ•|, or  |ÄÂ•|  (c) w Ã¢ÂˆÂˆ (yi , xi+1 ) and ÄÂˆ Ã¢ÂˆÂˆ t+i .  Proof. Let k, ÄÂˆ, and w be as above. The proof is by induction on the structure of ÄÂˆ. The cases for propositional  variables, Ã‚Å¹, and Ã¢ÂˆÂ§ are left to the reader. Consider the case  [0,1]  for Ã¢Â™ÅšF .  [0,1]  Ã¢Â€ÂœÃ¢Â‡Â’Ã¢Â€Â: Suppose w |=V Ã¢Â™ÅšF ÄÂˆ. Then there is a w Ã¢ÂˆÂˆ    w + [0, 1] such that w |=V ÄÂˆ. Similarly to the previous  proof distinguish four cases. Here only the most intricate  case is considered; the other cases are left to the reader and  can also be found in [6]:  Ã¢Â€Ë˜ w Ã¢ÂˆÂˆ (xi , xi+1 ) for some i < nÄÂ• , and w Ã¢ÂˆÂˆ (xj , xj+1 )  for some j Ã¢Â‰Ä½ i. If w Ã¢ÂˆÂˆ (yj , yj+1 ] for some  < |ÄÂ•|,  then the induction hypothesis in (b) yields ÄÂˆ Ã¢ÂˆÂˆ tj .  |ÄÂ•|  Otherwise, i.e., if w Ã¢ÂˆÂˆ (yj , xj+1 ), ÄÂˆ Ã¢ÂˆÂˆ t+j by the  induction hypothesis in (c). Since tj , t+j Ã¢ÂˆÂˆ Tj , it follows by definition of Tj that there is a w Ã¢ÂˆÂˆ (xj , xj+1 )  such that w |=V ÄÂˆ. Note that there is an i > i + 1  such that xi = xi+1 + 1. But then xj+1 Ã¢Â‰Â¤ xi ; otherwise xj Ã¢Â‰Ä½ xi and thus w Ã¢ÂˆÂ’ w > 1 contradicting  w Ã¢ÂˆÂˆ w+[0, 1]. Thus there is a v Ã¢ÂˆÂˆ (xi , xi+1 ) such that  [0,1]  w Ã¢ÂˆÂ’ v Ã¢Â‰Â¤ 1. By the semantics, v |=V Ã¢Â™ÅšF ÄÂˆ. Then it  follows by definition of the sequence x0 , . . . , xnÄÂ• that  [0,1]  v  |=V Ã¢Â™ÅšF ÄÂˆ for all v  Ã¢ÂˆÂˆ (xi , xi+1 ). Therefore,  [0,1]  [0,1]  Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ t for any t Ã¢ÂˆÂˆ Ti . Hence Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ ti if  [0,1]  w Ã¢ÂˆÂˆ (yi , yi+1 ] for some  < |ÄÂ•|, and Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ t+i if  |ÄÂ•|  w Ã¢ÂˆÂˆ (yi , xi+1 ).  Ã¢Â€ÂœÃ¢Â‡ÂÃ¢Â€Â: Here only Case (b) is considered; the cases (a) and  (c) are left to the reader and can also be found in [6]. Let  [0,1]  i Ã¢Â‰Â¤ nÄÂ• such that (b) w Ã¢ÂˆÂˆ (yi , yi+1 ] and Ã¢Â™ÅšF ÄÂˆ Ã¢ÂˆÂˆ ti for  some  < |ÄÂ•|. By definition of Ti , there is a w Ã¢ÂˆÂˆ (xi , xi+1 )  [0,1]  such that w |=V Ã¢Â™ÅšF ÄÂˆ. Then it follows by definition of  [0,1]  x0 , . . . , xnÄÂ• that w |=V Ã¢Â™ÅšF ÄÂˆ for any w Ã¢ÂˆÂˆ (xi , xi+1 ).  [0,1]  In particular, w |=V Ã¢Â™ÅšF ÄÂˆ. Then v |=V ÄÂˆ for some  v Ã¢ÂˆÂˆ w + [0, 1] by the semantics. Distinguish three cases:  Ã¢Â€Ë˜ v = xj for some j > i. The induction hypothesis in  (a) yields v |=V ÄÂˆ. Since v Ã¢ÂˆÂ’ w Ã¢Â‰Â¤ 1, it follows by the  [0,1]  semantics that w |=V Ã¢Â™ÅšF ÄÂˆ.  Ã¢Â€Ë˜ v Ã¢ÂˆÂˆ (xi , xi+1 ). By definition of Ti , there is a t Ã¢ÂˆÂˆ  Ti such that ÄÂˆ Ã¢ÂˆÂˆ t. Distinguish two subcases: First,  suppose that ÄÂˆ Ã¢ÂˆÂˆ ti for some  Ã¢Â‰Ä½ , or ÄÂˆ Ã¢ÂˆÂˆ t+i .  The induction hypothesis in (b) or (c) yields v  |=V      |ÄÂ•|  ÄÂˆ for all v  Ã¢ÂˆÂˆ (yj , yj +1 ], or all v  Ã¢ÂˆÂˆ (yi , xi+1 ),    respectively. Then there is such a v such that v  Ã¢ÂˆÂ’w <  [0,1]  1. Hence w |=V Ã¢Â™ÅšF ÄÂˆ.  Second, suppose there is no  Ã¢Â‰Ä½  such that ÄÂˆ Ã¢ÂˆÂˆ ti ,  and ÄÂˆ Ã¢ÂˆÂˆ  / t+i . Note that this implies  > 0. Since  +i  ÄÂˆÃ¢ÂˆÂˆ  / t , there is an interval of the form (y, xi+1 ) such  that y  |=V ÄÂˆ for all y  Ã¢ÂˆÂˆ (y, xi+1 ). Take such a  [0,1]  y  . Since w |=V Ã¢Â™ÅšF ÄÂˆ, it follows by definition of  [0,1]  x0 , . . . , xnÄÂ• that y  |=V Ã¢Â™ÅšF ÄÂˆ. Then there is a v  Ã¢ÂˆÂˆ  y  + [0, 1] such that v  |=V ÄÂˆ and v  Ã¢Â‰Ä½ xi+1 . By  definition of x0 , . . . , xnÄÂ• , there is an i such that xi =  xi + 1. Consider only the case where v  Ã¢ÂˆÂˆ (xj , xj+1 )  where j = i ; the other cases are straightforward. Note  that there is no such j > i . For suppose otherwise, it  holds that xi + 1 < xj < xi+1 + 1. By definition  of x0 , . . . , xnÄÂ• , there is a j  such that xj  = xj Ã¢ÂˆÂ’ 1.  Thus xi < xj  < xi+1 ; a contradiction. Therefore  j = i , i.e., xj = xi + 1. By definition of Tj , there  is an  < |ÄÂ•| such that tj Ã¢ÂˆÂˆ Tj and ÄÂˆ Ã¢ÂˆÂˆ tj . Then  the induction hypothesis in (b) yields v  |=V ÄÂˆ for all      v  Ã¢ÂˆÂˆ (yj , yj +1 ]. Take such a v  . Since  > 0 and  ÄÂƒi  by definition of ÄÂƒj , it holds that yi + 1 Ã¢Â‰Ä½  ÄÂƒj Ã¢Â‰Â¤ |ÄÂ•|    xj + ÄÂƒj . Then yj +1 Ã¢ÂˆÂ’  [0,1]  Hence w |=V Ã¢Â™ÅšF ÄÂˆ.  yi    < 1 and thus v Ã¢ÂˆÂ’ w < 1.  Ã¢Â€Ë˜ v Ã¢ÂˆÂˆ (xj , xj+1 ) for some j > i. By definition of  x0 , . . . , xnÄÂ• , there is an i such that xi = xi + 1.  Consider only the case where j = i ; the other cases  are straightforward. Note that there is no such j > i .  For suppose otherwise, it holds that xi + 1 < xj <  xi+1 + 1. By definition of x0 , . . . , xnÄÂ• , there is a j   such that xj  = xj Ã¢ÂˆÂ’ 1. Thus xi < xj  < xi+1 ; a  contradiction.  Distinguish three subcases:  Ã¢Â€Â“  = 0 and w |=V ÄÂˆ for some w with xi <  w Ã¢Â‰Â¤ xj . Then it is easy to see that there is a  v  Ã¢Â‰Ä½ w such that v  |=V ÄÂˆ and v  Ã¢ÂˆÂ’ w Ã¢Â‰Â¤ 1.  [0,1]  Hence w |=V Ã¢Â™ÅšF ÄÂˆ.  Ã¢Â€Â“  = 0 and w |=V ÄÂˆ for all w with xi < w Ã¢Â‰Â¤  [0,1]  xj . Since w |=V Ã¢Â™ÅšF ÄÂˆ, it follows by definition  [0,1]  of x0 , . . . , xnÄÂ• that w |=V Ã¢Â™ÅšF ÄÂˆ for all w    with xi < w < w. Take such a w . Then there  is a v  Ã¢ÂˆÂˆ w + [0, 1] such that v  |=V ÄÂˆ and  v  > xj . This implies that ÄÂˆ Ã¢ÂˆÂˆ tÃ¢ÂˆÂ’j = tj0 . Then  the induction hypothesis in (b) yields v  |=V ÄÂˆ  for all v  Ã¢ÂˆÂˆ (yj0 , yj1 ]. Clearly, there is such a v   [0,1]  such that w Ã¢ÂˆÂ’ v  Ã¢Â‰Â¤ 1. Hence w |=V Ã¢Â™ÅšF  ÄÂˆ.  Ã¢Â€Â“ 1 Ã¢Â‰Â¤  < |ÄÂ•|. By definition of Tj , there is an  <  |ÄÂ•| such that tj Ã¢ÂˆÂˆ Tj and ÄÂˆ Ã¢ÂˆÂˆ tj . The induction  hypothesis in (b) yields v  |=V ÄÂˆ for all v  Ã¢ÂˆÂˆ      ÄÂƒi  by  (yj , yj +1 ]. Take such a v  . Since ÄÂƒj Ã¢Â‰Â¤ |ÄÂ•|    definition of ÄÂƒj , it holds that yi + 1 Ã¢Â‰Ä½ xj + ÄÂƒj  [0,1]  and thus v  Ã¢ÂˆÂ’ w < 1. Hence w |=V Ã¢Â™ÅšF ÄÂˆ.  Ã¢ÂÂ  Using Lemma 8, one can now modify the decision procedure for satisfiability without FVA to obtain a decision  procedure running in nondeterministic polynomial time for  satisfiability with FVA. The crucial step is to determine a set  of rational linear inequalities which represent the truth conditions in models of the form described in Lemma 8. We  leave this exercise to the reader.  Acknowledgements.  Work on this paper was supported by the U.K. EPSRC research grants GR/S63182/01,  GR/S61966/01 and GR/S62727/01. The work reported here  was partly carried out while the first author was visiting the  University of Liverpool on a DAAD grant.  References  [1] R. Alur, T. Feder, and T. Henzinger. The benefits of relaxing punctuality. Journal of the ACM, 43:116Ã¢Â€Â“146,  1996.  [2] R. Alur and T. Henzinger. Logics and models of real  time: a survey. In Real Time: Theory and Practice,  Lecture Notes in Computer Science, pages 74Ã¢Â€Â“106,  Berlin, 1992. Springer.  [3] R. Alur and T. Henzinger. A really temporal logic.  Journal of the ACM, 41:181Ã¢Â€Â“204, 1994.  [4] E. Emerson, A. Mok, A. Sistla, and J. Srinivasan.  Quantitative temporal reasoning. Real-Time Systems,  4:331 Ã¢Â€Â“ 352, 1992.  [5] Y. Hirshfeld and A. Rabinovich. Logics for real time:  Decidability and complexity. Fundamenta Informaticae, 62:1Ã¢Â€Â“28, 2004.  [6] C. Lutz, D. Walther, and F. Wolter. Quantitative  temporal logics: PSpace and below. LTCS-Report  05-03, Technical University Dresden, 2005. see  http://lat.inf.tu-dresden.de/research/reports.html.  [7] M. Reynolds. The complexity of the temporal logic  over the reals. manuscript.  [8] P. Schobbens, J. Raskin, and T. Henzinger. Axioms  for real-time logics. Theoretical Computer Science,  274:151Ã¢Â€Â“182, 2002.  [9] A. Sistla and E. Clarke. The complexity of propositional linear temporal logics. Journal of the Association for Computing Machinery, 32:733Ã¢Â€Â“749, 1985.  [10] F. Wolter. Tense logic without tense operators. Mathematical Logic Quarterly, pages 145Ã¢Â€Â“171, 1996. 