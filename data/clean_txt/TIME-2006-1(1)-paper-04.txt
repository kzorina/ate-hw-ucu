Ultimately Periodic Simple Temporal Problems (UPSTPs)  Jean-FrancÄšÂ§ois Condotta 1  GeÄšÂrard Ligozat 2  Mahmoud Saade 1  Stavros Tripakis 3  1  CRIL-CNRS, UniversiteÄšÂ dÃ¢Â€Â™Artois, Rue de lÃ¢Â€Â™UniversiteÄšÂ, 62307 Lens, France  2  LIMSI-CNRS, UniversiteÄšÂ de Paris-Sud, 91403 Orsay, France  3  VERIMAG, Centre EÄšÂquation, 2, avenue de Vignate, 38610 Gieres, France  {condotta,saade}@cril.univ-artois.fr, ligozat@limsi.fr, tripakis@imag.fr  Abstract  In this paper, we consider quantitative temporal  or spatial constraint networks whose constraints  evolve over time in an ultimately periodic fashion. These constraint networks are an extension  of STPs (Simple Temporal Problems). We study  some properties of these new types of constraint  networks. We also propose a constraint propagation algorithm. We show that this algorithm decides the consistency problem in some particular  cases.  1 Introduction  In many areas of Computer Science, in particular in ArtiÄÅ¹Âcial Intelligence, it is necessary to reason about temporal information. Numerous formalisms for representing and reasoning about time  with constraints have been proposed. The constraint networks considered by these formalisms  differ, on the one hand, in terms of the temporal entities represented by the variables: these entities can be temporal points, temporal intervals,  durations or distances, for example; on the other  hand, they differ in terms of the nature of the constraints they use: these constraints can be qualitative [1, 2, 3], metric/quantitative [4, 5] or both  [6, 7, 8].  Simple temporal problems (STPs) [5] belong to  the class of quantitative constraint networks. They  represent temporal entities by points on the line  and allow to constrain the distances/durations between these points using numeric values speciÄÅ¹Âed  by intervals. It is well known that STPs can be  solved in polynomial time, which is one of the  reasons why these constraint networks are very  used. On many occasions the STPs have been  extended to deÄÅ¹Âne more expressive constraint networks [9, 10, 11].  In this paper, we consider temporal quantitative  constraint networks whose constraints evolve over  time in a ultimately periodic fashion. These constraint networks are extensions of the STPs and  can be used to represent Ã¢Â€Âœthe cyclic constraintsÃ¢Â€Â  deÄÅ¹Âned by Tripakis [12] for example. We call  them ultimately periodic STPs (UPSTPs in short).  These networks, interpreted in a spatial context,  can be seen as temporalized STPs. More precisely,  consider a set of punctual objects on the line whose  spatial locations change over time. At each instant,  an object has a given location. Then a UPSTP  makes it possible to express constraints on the relative locations of the objects over time, such as constraints which have to be satisÄÅ¹Âed at each new occurrence of a particular time (periodic constraints),  as well as constraints involving different instants.  In a temporal context, a recurrent activity or event  can have a ÄÅ¹Ânite or inÄÅ¹Ânite number of occurrences  over time. In some applications these occurrences  may have to satisfy a set of quantitative constraints  on their relative durations. A UPSTP allows to  specify such constraints.  The goal of this paper is to study various properties of these networks. We also propose a speciÄÅ¹Âc  constraint propagation algorithm for UPSTPs. We  show that this algorithm decides the consistency  problem in polynomial time for interesting particular cases.  The remainder of this paper is organized as follows. Section 2 recalls some basic facts about  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE  STPs. In Section 3 we introduce the ultimately  periodic simple temporal problems (UPSTPs). In  Section 4 we relate the consistency problem for  UPSTPs to the consistency problem for classical  STPs. Section 5 is devoted to the study of particular UPSTPs, namely closed UPSTPs. A constraint propagation algorithm is proposed in Section 6. Section 7 ends the paper with concluding  remarks.  2 Preliminaries on STPs  We denote the set of intervals on the line of rational numbers by INTQ . These intervals can be  ÄÅ¹Ânite or inÄÅ¹Ânite, and they can include or not their  lower and upper bounds, if any. In particular, this  set contains the empty interval, denoted by Ã¢ÂˆÂ… in the  sequel. Given two intervals I and J, Ã¢ÂˆÂ’I denotes  the interval opposite to I, i.e. the interval deduced  from I by the symmetry x Ã¢Â†Â’ Ã¢ÂˆÂ’x w.r.t. the origin.  I Ã¢ÂˆÅ  J denotes the interval corresponding to the intersection of I and J, I + J is the sum of the intervals I and J, i.e. the interval which is the union of  all translated intervals i+J = {i+x | x Ã¢ÂˆÂˆ J}, for  i Ã¢ÂˆÂˆ I. Given an integer number c, c.I is the image  of I under the transform x Ã¢Â†Â’ c.x. As an illustration, consider the intervals ] Ã¢ÂˆÂ’ Ã¢ÂˆÂ, 3] and ]1, 5]  (this last interval corresponds to the rational numbers strictly greater than 1 and less than 5). We  have Ã¢ÂˆÂ’]Ã¢ÂˆÂ’Ã¢ÂˆÂ, 3] = [Ã¢ÂˆÂ’3, +Ã¢ÂˆÂ[, Ã¢ÂˆÂ’]1, 5] = [Ã¢ÂˆÂ’5, Ã¢ÂˆÂ’1[,  ]Ã¢ÂˆÂ’Ã¢ÂˆÂ, 3]Ã¢ÂˆÅ ]1, 5] =]1, 3], ]Ã¢ÂˆÂ’Ã¢ÂˆÂ, 3]+]1, 5] =]Ã¢ÂˆÂ’Ã¢ÂˆÂ, 8]  and 2. ]1, 5] =]2, 10]. STPs [5] are binary quantitative constraint networks where the constraints  involve distances between points on the line: Each  constraint is deÄÅ¹Âned by an interval which represents the admissible values for the distance between the two points involved. All constraints of  the STPs considered in this paper will be deÄÅ¹Âned  by intervals belonging to INTQ :  DeÄÅ¹Ânition 1 A STP S is a pair (V, C) where:  Each variable vi represents a point on the rational  line. An interval C(vi , vj ) gives the admissible  values for the distance (vj Ã¢ÂˆÂ’ vi ) between the two  points represented by vi and vj . A solution of a  STP is formally deÄÅ¹Âned in the following way:  DeÄÅ¹Ânition 2 Let S = (V, C) be a STP.  Ã¢Â€Ë˜ An instantiation ÄÂƒ of S is a map from V to Q  associating to each variable vi of V a rational number ÄÂƒ(vi ) (also denoted by ÄÂƒi ).  Ã¢Â€Ë˜ An instantiation ÄÂƒ of S is a solution iff for all  vi , vj Ã¢ÂˆÂˆ V , ÄÂƒj Ã¢ÂˆÂ’ ÄÂƒi Ã¢ÂˆÂˆ Cij .  A STP is consistent iff it has a solution. The consistency problem for STPs consists in determining, given a STP, whether it is consistent or not.  This problem is a polynomial problem. A STP  S = (V, C) is a subSTP of S  = (V  , C  ), which  is denoted by S Ã¢ÂŠÂ† S  , if V = V  and C(vi , vj ) Ã¢ÂŠÂ†  C  (vi , vj ) for all vi , vj Ã¢ÂˆÂˆ V (S Ã¢ÂŠÂ‚ S  denotes the  case where S Ã¢ÂŠÂ† S  and for at least a pair of variables vi , vj Ã¢ÂˆÂˆ V we have C(vi , vj ) Ã¢ÂŠÂ‚ C  (vi , vj )).  We will say that a STP S = (V, C) is PC-closed  iff for all vi , vj , vk Ã¢ÂˆÂˆ V , C(vi , vj ) Ã¢ÂŠÂ† C(vi , vk ) +  C(vk , vj ). It is well known that a PC-closed STP  which does not contain the empty interval as a  constraint is a consistent STP. It is also globally consistent (each partial solution on a subset  of variables can be extended to a solution). Given  a STP S, there exists a unique equivalent STP  which is PC-closed; we denote it by PC(S). Polynomial methods consisting in iterating the operation of triangulation: Cij Ã¢Â†Â Cij Ã¢ÂˆÅ  (Cik + Ckj )  for each triple of variables vi , vj and vk until a  ÄÅ¹Âx-point is reached are used to obtain this equivalent STP. For example, we can use the algorithm  P C1 [13] which only uses one main loop for STPs  and whose complexity is hence 0(|V |3 ) for STPs.  Such a method will be generically called a pathconsistency method in the sequel.  Ã¢Â€Ë˜ V is a ÄÅ¹Ânite set of variables {v0 , . . . , vnÃ¢ÂˆÂ’1 },  where n is a positive integer;  3 Ultimately Periodic Simple Temporal Problems  Ã¢Â€Ë˜ C is a map from V Ä‚Â— V to INTQ , associating to each (vi , vj ) Ã¢ÂˆÂˆ V Ä‚Â— V an interval  C(vi , vj ) belonging to INTQ (also denoted by  Cij in the sequel) such that C(vi , vi ) Ã¢ÂŠÂ† [0, 0]  (actually C(vi , vi ) can be [0, 0] or the empty  interval) and C(vj , vi ) = Ã¢ÂˆÂ’C(vi , vj ) for all  vi , vj Ã¢ÂˆÂˆ V .  In a temporal context, a STP expresses quantitative constraints between a set of activities or events  represented by points. A STP can also be used in  a spatial context to represent constraints on the relative positions of a set of punctual objects on the  line.  Now we deÄÅ¹Âne the main notion of this paper which  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE  we call ultimately periodic simple temporal problems or ultimately periodic STPs (UPSTPs in  brief). This new notion, interpreted in a spatial  context, can be seen as a temporalized STP. More  precisely, consider a set of punctual objects on the  line whose spatial locations may change over the  time. At each instant, an object has a given location. With a UPSTP we can express three kinds  of constraints: constraints between the locations  of the objects at one given instant, constraints between the locations of the objects at different instants, constraints between the locations of the objects which have to be satisÄÅ¹Âed at each instant following an initial instant. We assume that time is  modeled by the natural integers. Hence, each integer t Ã¢Â‰Ä½ 0 corresponds to an instant in time.  In a temporal context, a recurrent activity or event  can have a ÄÅ¹Ânite or inÄÅ¹Ânite number of occurrences  over time. In some applications these occurrences  may have to satisfy a set of quantitative constraints  on the durations between two of them. A UPSTP  allows to specify such constraints.  Formally, we deÄÅ¹Âne an ultimately periodic STP in  the following way:  DeÄÅ¹Ânition 3 A UPSTP is a structure U  (V, C, tmin , tmax ) where:  =  Ã¢Â€Ë˜ V = {v0 , . . . , vnÃ¢ÂˆÂ’1 } is a set of n variables ;  Ã¢Â€Ë˜ tmin and tmax are two positive integers such  that tmin Ã¢Â‰Â¤ tmax ;  Ã¢Â€Ë˜ C is a map from V Ä‚Â— {0, . . . , tmax } Ä‚Â—  V Ä‚Â— {0, . . . , tmax } to INTQ such that  C(vi , ti , vj , tj ) = Ã¢ÂˆÂ’C(vj , tj , vi , ti ) and  C(vi , ti , vi , ti ) Ã¢ÂŠÂ† [0, 0] for all vi , vj Ã¢ÂˆÂˆ V and  ti , tj Ã¢ÂˆÂˆ {0, . . . , tmax }.  The application C expresses explicitly the constraints between the locations of the different occurrences of the variables of V for the instants belonging to {0, . . . , tmax }. The map C also expresses constraints which have to be satisÄÅ¹Âed at  each future instant. Indeed, the constraints given  for the instants {tmin , . . . , tmax } have to be also  satisÄÅ¹Âed on all future periods, i.e. on each interval  {tmin + i, . . . , tmax + i} with i Ã¢Â‰Ä½ 0.  Intuitively, in a spatial context, each variable vi Ã¢ÂˆÂˆ  V represents a point on the rational line whose location evolves over time. The pair (vi , ti ), with  ti Ã¢ÂˆÂˆ N, represents this location at time ti . The  constraint C(vi , ti , vj , tj ) constrains the distance  between the point vi at time ti and the point vj  at time tj . In a temporal context, the variable vi  no longer represents the punctual spatial component of the object, but instead a recurrent activity  or event. The pair (vi , ti ) Ã¢ÂˆÂˆ V Ä‚Â— N represents then  the (ti + 1)th occurrence of the event represented  by vi .  In accordance with the preceding interpretations,  we deÄÅ¹Âne a solution of a UPSTP in the following  way:  DeÄÅ¹Ânition 4 A solution ÄÂƒ of a UPSTP U =  (V, C, tmin , tmax ) is a map from V Ä‚Â— N to Q such  that, for all vi , vj Ã¢ÂˆÂˆ V and ti , tj Ã¢ÂˆÂˆ N :  1. if ti , tj Ã¢Â‰Â¤ tmax then ÄÂƒ(vj , tj ) Ã¢ÂˆÂ’ ÄÂƒ(vi , ti ) Ã¢ÂˆÂˆ  C(vi , ti , vj , tj ) ;  2. if tmin Ã¢Â‰Â¤ ti Ã¢Â‰Â¤ tj and tj Ã¢ÂˆÂ’ ti Ã¢Â‰Â¤ tmax Ã¢ÂˆÂ’  tmin then for all ti , tj such that tmin Ã¢Â‰Â¤  ti Ã¢Â‰Â¤ min{tmax , ti } and tmin Ã¢Â‰Â¤ tj Ã¢Â‰Â¤  min{tmax , tj } and tj Ã¢ÂˆÂ’ ti = tj Ã¢ÂˆÂ’ ti we have  ÄÂƒ(vj , tj ) Ã¢ÂˆÂ’ ÄÂƒ(vi , ti ) Ã¢ÂˆÂˆ C(vi , ti , vj , tj ).  We extend in an obvious way the notions of consistency and equivalence for ordinary constraint networks to the case of UPSTPs. The following examples illustrate the preceding deÄÅ¹Ânitions.  Example 1 In a spatial context, consider three  objects O0 , O1 and O2 , whose spatial locations  are represented by three variables v0 , v1 and v2  which stand for rational numbers. Assume that the  objects change positions over time with the following constraints:  Ã¢Â€Ë˜ At time 0, O0 is left of O1 and is left of O2 at  a distance comprised between 3 and 5;  Ã¢Â€Ë˜ the location of O2 at time 0 is left of its location at time 1 ;  Ã¢Â€Ë˜ at time 1, and for all future instants, O0 is  right of O1 at a maximal distance of 10;  Ã¢Â€Ë˜ after time 1, O0 moves left, and O1 moves  right ;  Ã¢Â€Ë˜ after time 2, O2 moves left and stays away O1  at a maximal distance of 4.  These constraints can be expressed by the UPSTP  U = (V, C, tmin , tmax ), where V = {v0 , v1 , v2 },  tmin = 1, tmax = 3. The constraints deÄÅ¹Âned by  C are represented in Figure 1. As usual, the following constraints are not given: the constraint  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE  between a variable and itself, the universal constraint (] Ã¢ÂˆÂ’ Ã¢ÂˆÂ, +Ã¢ÂˆÂ[), the opposite constraint of a  constraint which is already given. This UPSTP U  is a consistent UPSTP, a solution is depicted in  Figure 1.  (d = 1 in the case where all bounds are inÄÅ¹Ânite).  Let U  = (V, C  , tmin , tmax ) be the UPSTP deÄÅ¹Âned by C  (vi , ti , vj , tj ) = d.C(vi , ti , vj , tj ) for  all vi , vj Ã¢ÂˆÂˆ V and ti , tj Ã¢ÂˆÂˆ {0, . . . , tmax } . Then U  is consistent iff U  is consistent.  Example 2 Consider now two recurrent punctual  events E0 and E1 represented by two variables v0  and v1 which stand for rational numbers. Assume  that the different occurrences of these events are  constrained in the following way:  Proof Let ÄÂƒ be a solution of U. Let ÄÂƒ  be a  map from V Ä‚Â— N to Q deÄÅ¹Âned from ÄÂƒ  (vi , ti ) =  d(ÄÂƒ(vi , ti ) Ã¢ÂˆÂ’ ÄÂƒ(v0 , 0)) for all vi Ã¢ÂˆÂˆ V and ti Ã¢ÂˆÂˆ N.  We can show that ÄÂƒ  is a solution of U  . Suppose  now that a solution ÄÂƒ  of U  is given. By deÄÅ¹Âning a map ÄÂƒ from V Ä‚Â— N to Q with ÄÂƒ(vi , ti ) =  (ÄÂƒ  (vi , ti )Ã¢ÂˆÂ’ÄÂƒ  (v0 , 0))/d for all vi Ã¢ÂˆÂˆ V and ti Ã¢ÂˆÂˆ N  we obtain a solution of U.  Because of this fact, we can assume without loss of  generality that all UPSTPs have constraints whose  ÄÅ¹Ânite bounds are integers.  Ã¢Â€Ë˜ for all i Ã¢Â‰Ä½ 0, the ith occurrence of E1 is  always after the ith occurrence of E0 . At  least one second elapses between these occurrences.  Ã¢Â€Ë˜ For all i Ã¢Â‰Ä½ 0, at least two seconds elapse  between the (i + 1)th occurrence and the ithe  occurrence of E0 , exactly one second elapses  between those of E1 .  These constraints can be expressed by the UPSTP  U = (V, C, tmin , tmax ), where V = {v0 , v1 },  tmin = 0, tmax = 1. The constraints deÄÅ¹Âned by  C are represented in Figure 2. We leave it to the  reader to check that this UPSTP is not consistent.  4 Implicit constraints versus explicit  constraints  In this section we relate the consistency problems  for UPSTPs Ã¢Â€Â“ which potentially express an inÄÅ¹Ânite number of constraints Ã¢Â€Â“ to the consistency  problems for the STPs. In order to do this we take  the following steps :  1. We associate to each UPSTP a STP corresponding to its periodic constraints. This  STP is called the motif of the UPSTP.  Figure 2. The constraints C of the  UPSTP U of Example 2.  To close this section we show that the consistency  problem of any UPSTP can be can be reduced  (in polynomial time) to the consistency problem  of a UPSTP whose constraints have either inÄÅ¹Ânite  bounds, or bounds deÄÅ¹Âned by integers:  Proposition 1 Let U = (V, C, tmin , tmax ) be a  UPSTP, and d be product of the denominators  of the ÄÅ¹Ânite bounds 1 of the intervals deÄÅ¹Âning C  1 We can assume without loss of generality that each value  of a ÄÅ¹Ânite bound of a constraint is deÄÅ¹Âned by a fraction p/q,  where p is an integer and q is a strictly positive integer  2. Based on the use of the motif, we deÄÅ¹Âne  a ÄÅ¹Ânite sequence of STPs Ã¢Â€Âœwith increasing  temporal supportÃ¢Â€Â. Each one of these STPs  makes explicit the constraints of the UPSTP  on a number of initial points in time. We call  them the strengthenings of the UPSTP.  3. Finally, we relate the consistency problem of  the UPSTPs to properties of its strengthenings.  We now proceed to implement these steps in detail.  The ÄÅ¹Ârst ÄÅ¹Ânite networks we consider are the motifs  of the UPSTPs:  DeÄÅ¹Ânition 5 Let U = (V, C, tmin , tmax ) be a  UPSTP. The motif of U, denoted by motif(U),  is the STP Sm = (Vm , Cm ) where Vm =  V Ä‚Â— {0, . . . , lg} (with lg = tmax Ã¢ÂˆÂ’ tmin ) and  Cm ((vi , ti ), (vj , tj )) = C(vi , ti + tmin , vj , tj +  tmin ) for all vi , vj Ã¢ÂˆÂˆ V and for all ti , tj Ã¢ÂˆÂˆ  {0, . . . , lg}.  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE  Figure 1. The UPSTP U corresponding to Example 1 and a solution of U.  Figure 3. The motif of the UPSTP U and its 4-strengthening.  In the sequel lg will denote the difference tmax Ã¢ÂˆÂ’  tmin . The motif of the UPSTP U in Figure 1 is  represented in Figure 3.  Using the notion of motif, we are going to deÄÅ¹Âne a STP which, in some way, makes explicit  constraints of a UPSTP which must be satisÄÅ¹Âed  during the (k + 1) ÄÅ¹Ârst instants (where k Ã¢Â‰Ä½  tmax ). For such a k, the STP we deÄÅ¹Âne is called  the k-strengthening of the UPSTP. Before giving a formal deÄÅ¹Ânition, we describe them in an  intuitive way. Consider a picture representing  the constraints of the UPSTP over the instants  {0, . . . , tmax }. Imagine that a picture of the motif is drawn independently on a transparent sheet.  Given an integer number k Ã¢Â‰Ä½ tmax , we superpose  the transparent sheet on the original picture, then  we move this motif with a shift of one, then of two,  and so on, until the instant k is reached. Each time,  we add the constraints of the transparent sheet to  the existing ones (taking intersections). Then the  k-strengthening is the STP we get when reaching  instant k. We now give a formal deÄÅ¹Ânition:  DeÄÅ¹Ânition 6 Let U = (V, C, tmin , tmax ) be a  UPSTP and Sm = (V Ä‚Â— {0, . . . , lg}, Cm ) its motif. Given an integer number k Ã¢Â‰Ä½ tmax , the kstrengthening of U, denoted by kÃ¢ÂˆÂ’strenthening(U),  is the STP S k = (V k , C k ) deÄÅ¹Âned recursively 2  by:  Ã¢Â€Ë˜ V k = V Ä‚Â— {0, . . . , k};  Ã¢Â€Ë˜ C tmax ((vi , ti ), (vj , tj )) = C(vi , ti , vj , tj ) for  all vi , vj Ã¢ÂˆÂˆ V and ti , tj Ã¢ÂˆÂˆ {0, . . . , tmax };  Ã¢Â€Ë˜ for k Ã¢Â‰Ä½ tmax and for all vi , vj Ã¢ÂˆÂˆ V and  ti , tj Ã¢ÂˆÂˆ {0, . . . , k + 1} with ti Ã¢Â‰Â¤ tj ,  =  Ã¢Â€Ë˜ C k+1 ((vi , ti ), (vj , tj ))  C k ((vi , ti ), (vj , tj )), if ti < (k + 1) Ã¢ÂˆÂ’ lg and  tj < k + 1,  Ã¢Â€Ë˜ C k+1 ((vi , ti ), (vj , tj ))  =  C k ((vi , ti ), (vj , tj )) Ã¢ÂˆÅ  Cm ((vi , ti Ã¢ÂˆÂ’ ((k +  1) Ã¢ÂˆÂ’ lg)), (vj , tj Ã¢ÂˆÂ’ ((k + 1) Ã¢ÂˆÂ’ lg))), if  ti Ã¢Â‰Ä½ (k + 1) Ã¢ÂˆÂ’ lg and tj < k + 1,  Ã¢Â€Ë˜ C k+1 ((vi , ti ), (vj , tj )) = Cm ((vi , ti Ã¢ÂˆÂ’ ((k +  1)Ã¢ÂˆÂ’lg)), (vj , tj Ã¢ÂˆÂ’((k+1)Ã¢ÂˆÂ’lg))), if tj = k+1  and tj Ã¢ÂˆÂ’ ti Ã¢Â‰Â¤ lg,  Ã¢Â€Ë˜ C k+1 ((vi , ti ), (vj , tj )) =] Ã¢ÂˆÂ’ Ã¢ÂˆÂ, +Ã¢ÂˆÂ[, if tj =  k + 1 and tj Ã¢ÂˆÂ’ ti > lg,  Ã¢Â€Ë˜ C k+1 ((vj , tj ), (vi , ti ))  C k+1 ((vi , ti ), (vj , tj )).  2 Firstly, we deÄÅ¹Âne C k  from  Ck  IEEE  Ã¢ÂˆÂ’  for k = tmax then, we deÄÅ¹Âne C k+1  for an integer k Ã¢Â‰Ä½ tmax .  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  =  Figure 3 shows the 4-strengthening of the UPSTP  U depicted in Figure 1. In the sequel we also use  the notion of window of a k-strengthening which  is a STP capturing its constraints over (lg+1) consecutive time points:  DeÄÅ¹Ânition 7 Let S k = (V Ä‚Â— {0, . . . , k}, C k )  the k-strengthening of a UPSTP U  =  (V, C, tmin , tmax ), with k Ã¢Â‰Ä½ tmax . The twindow of S k , with tmin Ã¢Â‰Â¤ t Ã¢Â‰Â¤ k Ã¢ÂˆÂ’ lg,  denoted by t Ã¢ÂˆÂ’ window(S), is the STP  St = (Vt , Ct ) where: Vt = V Ä‚Â— {0, . . . , lg} and  Ct ((vi , ti ), (vj , tj )) = C k ((vi , ti +t), (vj , tj +t)),  for all vi , vj Ã¢ÂˆÂˆ V and ti , tj Ã¢ÂˆÂˆ {0, . . . , lg}.  The end of S k corresponds to its last window, i.e.  its (k Ã¢ÂˆÂ’ lg)-window. Figure 4 depicts the end of  the 4-strengthening of Figure 3.  We give a last deÄÅ¹Ânition before beginning the  study of the interactions between the various consistency properties of the constraint networks previously introduced.  DeÄÅ¹Ânition 8 Let U = (V, C, tmin , tmax ) be a  UPSTP and S k = (V Ä‚Â— {0, . . . , k}, C k ) its kstrengthening for an integer number k Ã¢Â‰Ä½ tmax . A  map ÄÂƒ from V Ä‚Â—N to Q is a solution of S k iff the restriction of ÄÂƒ to V Ä‚Â—{0, . . . , k} is a solution of S k ,  i.e. iff ÄÂƒ(vj , tj ) Ã¢ÂˆÂ’ ÄÂƒ(vi , ti ) Ã¢ÂˆÂˆ C k ((vi , ti ), (vj , tj ))  for all vi , vj Ã¢ÂˆÂˆ V and ti , tj Ã¢ÂˆÂˆ {0, . . . , k}.  A solution of a UPSTP provides solutions for  its k-strengthenings moreover, a solution of all  k-strengthenings corresponds to a solution of the  UPSTP:  Proposition 2 Let U be an UPSTP and a map ÄÂƒ  from V Ä‚Â— N to Q. The map ÄÂƒ is a solution of the  kÃ¢ÂˆÂ’strenthening(U) for all k Ã¢Â‰Ä½ tmax iff ÄÂƒ is a  solution of U.  Notice that the consistency of each kstrengthening of a UPSTP does not imply,  in the general case, the consistency of the  UPSTP. An counter-example is provided by  the UPSTP represented in Figure 2: despite its  non-consistency, we can deÄÅ¹Âne a solution for each  one of its k-strengthenings. The ÄÅ¹Ânal proposition  of this section can be straightforwardly proved  using the deÄÅ¹Ânitions of a k-strengthening and of  its end:  Proposition 3 Let U be a UPSTP. For all k Ã¢Â‰Ä½  tmax , the STP end(kÃ¢ÂˆÂ’strenthening(U)) is a subnetwork of motif(U).  5 The consistency problem for closed  UPSTPs  In this section we consider particular UPSTPs,  namely, closed UPSTPs. We have shown that the  consistency problem of these constraint networks  can be reduced to the consistency problem of its  tmax -strengthenings and hence is Ã¢Â€ÂœeasyÃ¢Â€Â to solve.  In the following section we will introduce a constraint propagation algorithm aiming to transform  any UPSTP into a closed UPSTP.  Before deÄÅ¹Âning the property of closure for a  UPSTP we introduce an operation called the  translation operation. From the motif of a UPSTP,  the translation operation gives a STP whose constraints are the constraints of the motif on which  are superposed the constraints which must be satisÄÅ¹Âed on Ã¢Â€Âœthe next periodÃ¢Â€Â (those that must be satisÄÅ¹Âed at the next instant by shifting by one the  constraints of the motif). This operation is used  by Tripakis [12] in the framework of periodic constraints which can be expressed by a UPSTP U =  (V, C, tmin , tmax ) where tmin = 0 and tmax = 1.  Formally, we deÄÅ¹Âne the translation operation in the  following way:  DeÄÅ¹Ânition 9 Let S = (V  , C) be a STP with  V  = V Ä‚Â— {0, . . . , max} (where V is a ÄÅ¹Ânite  set {v0 , . . . , vm } and m, max Ã¢Â‰Ä½ 0). The translation of S, denoted by translation(S), is the STP  Str = (Vtr , Ctr ) where Vtr = V  , and for all  vi , vj Ã¢ÂˆÂˆ V and for all ti , tj Ã¢ÂˆÂˆ {0, . . . , max},  Ctr ((vi , ti ), (vj , tj )) = C((vi , ti ), (vj , tj )) Ã¢ÂˆÅ   C((vi , ti Ã¢ÂˆÂ’ 1), (vj , tj Ã¢ÂˆÂ’ 1)) if ti > 0 and tj > 0,  and Ctr ((vi , ti ), (vj , tj )) = C((vi , ti ), (vj , tj ))  else.  The translation of the motif depicted in Figure 3  is represented in Figure 4. We extend the notion  of PC-closure and translation to UPSTPs in the  following way:  DeÄÅ¹Ânition 10 Let U  =  (V, C, tmin , tmax )  a UPSTP.  The PC-closure of U (resp.  the translation of U), denoted by PC(U)  (resp.  translation(U)), is the UPSTP  (V, C  , tmin , tmax ) where C  in the map from  V Ä‚Â— {0, . . . , tmax } Ä‚Â— V Ä‚Â— {0, . . . , tmax } to INTQ  deÄÅ¹Âned by:  Ã¢Â€Ë˜ C  (vi , ti , vj , tj ) = C(vi , ti , vj , tj ) for all  vi , vj Ã¢ÂˆÂˆ V and ti , tj Ã¢ÂˆÂˆ {0, . . . , tmax } such that  ti < tmin or tj < tmin ,  Ã¢ÂˆÂ—  =  Cm  ((vi , ti Ã¢ÂˆÂ’  Ã¢Â€Ë˜ C  (vi , ti , vj , tj )  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE  Figure 4. The end of the 4-strengthening of the UPSTP U and the translation of motif(U).  tmin ), (vj , tj Ã¢ÂˆÂ’ tmin )) for all vi , vj Ã¢ÂˆÂˆ V  Ã¢ÂˆÂ—  denotes  and ti , tj Ã¢ÂˆÂˆ {tmin , . . . , tmax }, where Cm  the constraints of the PC-closure (resp. the  translation) of the motif of U.  Using these operations we can now deÄÅ¹Âne the closure property:  DeÄÅ¹Ânition 11 Let U = (V, C, tmin , tmax ) be a  UPSTP. The UPSTP U (resp. the motif motif(U))  is closed iff U = PC(translation(U)) (resp. iff  motif(U) = PC(translation(motif(U))).  Concerning the closure property we have the following properties:  Proposition 4 Let U be a UPSTP. We have : U  is closed iff motif(U) is closed ; U is closed iff  U = translation(U) and U = PC(U) ; motif(U) is  closed iff motif(U) = translation(motif(U)) and  motif(U) = PC(motif(U)).  of end((k + 1)Ã¢ÂˆÂ’strenthening(U)). end((k + 1)Ã¢ÂˆÂ’  strenthening(U)) is a subnetwork of the STP  motif(U) which is closed and hence PC-closed.  motif(U) is hence also globally consistent. Hence  we can extend the partial solution to a solution of  motif(U). Since the constraints concerning the instant lg are the same constraints for motif(U) and  for end((k + 1)Ã¢ÂˆÂ’strenthening(R)), this solution is  also a solution of end((k + 1)Ã¢ÂˆÂ’strenthening(U)).  This solution can be used to complete the solution  ÄÂƒ to obtain a solution of (k + 1)Ã¢ÂˆÂ’strenthening(U).  A corollary of this theorem is the following result:  Corollary 1 The consistency problem for closed  UPSTPs can be solved in polynomial time; more  precisely, it can be solved by applying the pathconsistency method on the tmax -strengthening of  the UPSTP, which can be achieved in O((tmax Ã¢ÂˆÂ—  |V |)3 ).  We also have the following result:  Proposition 5 Let U = (V, C, tmin , tmax ) be a  closed UPSTP. Let S k = (V Ä‚Â— {0, . . . , k}, Ck )  and N k+1 = (V Ä‚Â— {0, . . . , k + 1}, Ck+1 ) be the  k-strengthening and the (k + 1)-strengthening of  U, respectively, with k Ã¢Â‰Ä½ tmax . The restriction of  the map Ck+1 to V Ä‚Â— {0, . . . , k} Ä‚Â— V Ä‚Â— {0, . . . , k}  is the map Ck .  Now, we give a fundamental result about the consistency problem for closed UPSTPs.  Theorem 1 Let U = (V, C, tmin , tmax ) be  a closed UPSTP.  Each solution of k Ã¢ÂˆÂ’  strenthening(U), with k Ã¢Â‰Ä½ tmax , can be extended  to a solution of (k + 1)Ã¢ÂˆÂ’strenthening(U).  Proof(sketch) Starting from a solution ÄÂƒ of kÃ¢ÂˆÂ’  strenthening(U) we can extract a partial solution  6 The closure method for the UPSTPs  In the previous section we have shown that the  consistency problem of closed UPSTPs is a polynomial problem. We will make use of this result,  and introduce a constraint propagation algorithm  which tries to transform an arbitrary UPSTP into  an equivalent UPSTP which is closed. This algorithm corresponds to the algorithm Closure (see  Algorithm 1). We will see that this algorithm is  sound, in the sense that if the algorithm Closure  terminates, then the resulting UPSTP is closed  and equivalent to the initial UPSTP. However, this  algorithm is not complete; indeed, we will see that  there are cases where the algorithm Closure cannot  terminate. In spite of this, we will characterize two  particular interesting cases for which the algorithm  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE  Algorithm 1 Closure  Compute the closure of UPSTP U  (V, C, tmin , tmax )  1:  Do  2:  U  := U  3:  U := translation(U)  4:  U := PC(U)  5:  While (U = U  )  6:  return U  =  Closure is complete. This algorithm uses the translation operation and the path-consistency method  to compute the closure of a UPSTP. As a ÄÅ¹Ârst  step, we will show that this algorithm is sound.  The following proposition asserts the equivalence  between a UPSTP and its transform under PCclosure and translation and hence allows us to assert that the algorithm Closure computes a UPSTP  which is equivalent to the initial UPSTP:  Proposition 6 The PC-closure of a UPSTP U and  its translation are equivalent to U.  The algorithm Closure does not always terminate.  Indeed, consider the UPSTP represented in Figure 2 and apply the algorithm Closure to it. We  notice that this algorithm does not terminate and  loops indeÄÅ¹Ânitely. The resulting UPSTP after the  ith loop of the algorithm Closure is shown in Figure 5. Actually, the non termination of the algo-  Figure 5. The resulting UPSTP after  the ith loop of the algorithm Closure.  rithm Closure allows us to decide the consistency  problem of the UPSTP, indeed we have the following property:  Proposition 7 The non termination of the algorithm Closure on a UPSTP U implies the non consistency of the UPSTP U.  Proof In the case where the algorithm Closure  loops indeÄÅ¹Ânitely, we can assert that there exists one of the intervals deÄÅ¹Âning a constraint  C(vi , ti , vj , tj ) of U which decreases indeÄÅ¹Ânitely  by intersection. This interval decreases at least by  one (the ÄÅ¹Ânite bounds of the intervals are integer  number) for each intersection. This interval has  necessarily a ÄÅ¹Ânite bound and an inÄÅ¹Ânite bound.  Indeed, in the contrary case C(vi , ti , vj , tj ) will  become the empty interval. Using these observations and from the fact that the algorithm Closure  is sound, we can assert that it is not possible to  deÄÅ¹Âne a map ÄÂƒ solution of U. Indeed, for any distance ÄÂƒ(vj , tj ) Ã¢ÂˆÂ’ ÄÂƒ(vi , ti ) there exists a loop of  the algorithm from which ÄÂƒ(vj , tj ) Ã¢ÂˆÂ’ ÄÂƒ(vi , ti ) Ã¢ÂˆÂˆ  C(vi , ti , vj , tj ).  An open question is: in the general case, does exist  a way to detect that the algorithm Closure will indeÄÅ¹Ânitely loop after a particular number of loops?  For particular kinds of constraints we are sure that  this algorithm will terminate after a ÄÅ¹Ânite number  of iterations. For example, we can cite the two following particular cases:  1. the intervals used as constraints have  uniquely ÄÅ¹Ânite bounds ;  2. the intervals used as constraints have inÄÅ¹Ânite  bounds or ÄÅ¹Ânite bounds (open or closed) associated with the value 0.  For the ÄÅ¹Ârst kind of constraints, the number of iterations done by the algorithm Closure is bounded  by m(|V | Ã¢ÂˆÂ— (lg + 1))2 where m is the size of the  largest interval. This is a consequence of the fact  that at each loop, at least one constraint decreases  at least one unity. Concerning the second type of  constraints we can notice that the number of iterations is bounded by 3(|V | Ã¢ÂˆÂ— (lg + 1))2 as each constraint can decrease at most three times. The second kind of constraints is used to represent qualitative constraints stemming from formalisms such  that the AllenÃ¢Â€Â™s Calculus [1] or the point calculus [2]. Hence, the consistency problem for the  UPSTPs with these two kinds of constraints is  polynomial in time.  7 Conclusion  In this paper, we have introduced the notion  of ultimately periodic simple temporal problems  (UPSTPs). This notion allows to express (spatial or temporal) quantitative constraints which, after an initial period, evolve in a periodic way by  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE  repeating the same pattern that we called motif.  For this kind of constraint network, we propose a  constraint propagation algorithm for deciding the  problem of consistency. In the general case, this  algorithm is not complete. Despite it, we showed  that for particular interesting cases. We are currently developing an implementation of this algorithm3 . This work also opens new perspectives for  future work. One of them consists in the characterization of new cases where the consistency problem of the UPSTP is polynomial in time. Another  one consists in determining the class of complexity to which the consistency problem for UPSTPs  belongs, and to deÄÅ¹Âne algorithms allowing to solve  it in the general case.  References  [1] Allen, a.J.F. : An interval-based representation of temporal knowledge. In: Proc. of the  Seventh Int. Joint Conf. on ArtiÄÅ¹Âcial Intelligence (IJCAIÃ¢Â€Â™81). (1981) 221Ã¢Â€Â“226  [2] Vilain, M., Kautz, H., Beek, P.V. : Constraint  propagation algorithms for temporal reasoning: A revised report. Qualitative Reasoning  about Physical Systems, Morgan Kaufmann,  1990 (1990) 372Ã¢Â€Â“381  [3] Navarrete, I., Marin, R.: Qualitative temporal reasoning with points and durations.  In: Proceedings of the 15th Inter. Joint Conf.  on Artif. Intel. (IJCAIÃ¢Â€Â™97), San Francisco  (1997) 1454Ã¢Â€Â“1459  Int. Joint Conf. on Art. Intel. (IJCAIÃ¢Â€Â™99).  (1999) 1259Ã¢Â€Â“1267  [8] Condotta, J.F. : The augmented interval and  rectangle networks. In: Proceedings of the  Seventh International Conference on Principles of Knowledge (KRÃ¢Â€Â™2000), Brekenbridge, USA. (2000)  [9] Gerevini, A., Cristani, M.: On ÄÅ¹Ânding a solution in temporal constraint satisfaction problems. In: Proc. of the Fifteenth Int. Joint  Conf. on Art. Int. (IJCAIÃ¢Â€Â™97). (1997) 1460Ã¢Â€Â“  1465  [10] Morris, P.H., Muscettola, N.: Managing temporal uncertainty through waypoint controllability. In Thomas, D., ed. : Proc. of the 16th  Int. Joint Conf. on Art. Int. (IJCAI-99-Vol2).  (1999) 1253Ã¢Â€Â“1258  [11] Broxvall, M.: A method for metric temporal  reasoning. In: Proc. of the Eighteenth Nat.  Conf. on Art. Int. (AAAI02). (2002) 513Ã¢Â€Â“  518  [12] Tripakis, S.:  Solving cyclic constraints.  In: Workshop on real-Time Constraints  (RTCÃ¢Â€Â™99), Taipei, Taiwan (1999)  [13] Mackworth, A.K., Freuder, E.C. :  The  Complexity of Some Polynomial Network  Consistency Algorithms for Constraint Satisfaction Problem. ArtiÄÅ¹Âcial Intelligence 25  (1985) 65Ã¢Â€Â“74  [4] Koubarakis, M.: Dense time and temporal  constraints with =. In: Proc. of the 3rd Int.  Conf. on Princ. of Knowledge Representation and Reasoning (KRÃ¢Â€Â™92). (1992) 24Ã¢Â€Â“35  [5] Dechter, R., Meiri, I., Pearl, J.: Temporal  Constraint Networks. Art. Int. 49 (1991) 61Ã¢Â€Â“  95  [6] Meiri, I.: Combining qualitative and quantitative constraints in temporal reasoning. ArtiÄÅ¹Âcial Intelligence 87 (1996) 343Ã¢Â€Â“385  [7] Pujari, A.K., Sattar, A.: A new framework  for reasoning about points, intervals and durations. In Thomas, D., ed. : Proc. of the 16th  3 The  current implementation can be found  http://www.cril.univ-artois.fr/Ã¢ÂˆÅºcondotta/upstp/.  at  Proceedings of the Thirteenth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™06)  1530-1311/06 $20.00 Ã‚Å  2006  IEEE 