2013 20th International Symposium on Temporal Representation and Reasoning  Minimal Consistency Problem of Temporal  Qualitative Constraint Networks  Jean-FrancĚ§ois Condotta  UniversiteĚ Lille-Nord de France, CRIL CNRS, UMR 8188  Lens, France  Email: condotta@cril.fr  Souhila Kaci  UniversiteĚ Montpellier 2, LIRMM CNRS, UMR 5506  Montpellier, France  Email: kaci@lirmm.fr  AbstractâVarious formalisms for representing and reasoning  about temporal information with qualitative constraints have  been studied in the past three decades. The most known are  deďŹnitely the Point Algebra (PA) and the Interval Algebra (IA)  proposed by Allen. In this paper, for both calculi, we study a  particular problem that we call minimal consistency problem  (MinCons). Given a temporal qualitative constraint network  (TQCN) and a positive integer k, this problem consists in deciding  whether or not this TQCN admits a solution using at most k  distinct points on the line. On the one hand, we prove that this  problem is NP-complete for both PA and IA, in the general case.  On the other hand, we show that for TQCNs deďŹned on the  convex relations, MinCons is polynomial. For these TQCNs, we  give a polynomial method allowing to obtain compact scenarios.  in the case of IA). We also consider a close decision problem  which we call Minimal Consistency Problem (MinCons). It  consists, given a positive integer k and a TQCN, in deciding  whether this TQCN admits a solution using at most k distinct  points of the line.  Given a TQCN, to characterize a solution or a scenario  among the most compact ones is very interesting and pertinent  for some applications. For example, consider a system allowing to handle temporal qualitative constraints in the context  of a project management tool. For each temporal constraint  added by the user, such a system can offer some functionalities  like consistency checking or visualizating possible conďŹgurations of the different temporal activities. Concerning this  last functionality, it is natural that the visualized solution or  scenario belongs to the set of the most compact solutions or  scenarios. Another ďŹeld of applications where characterizing  compact solutions of TQCNs can be pertinent is the intelligent  systems involving preference handling. In the context of a recommender system, for decision purposes, it is more convenient  to characterize a unique complete preorder associated with a  preference set [5]. In the case where preference information  can be represented by TQCNs [6], [7], these distinguished  models can correspond to particular compact solutions or  scenarios.  I. I NTRODUCTION  Representing and reasoning about temporal information is  crucial in many areas of ArtiďŹcial Intelligence. In this context, several qualitative constraint calculi have been proposed.  Allenâs calculus [1], also called Interval Algebra, and Point  Algebra [2] are certainly the most well-known qualitative  temporal calculi. These two formalisms allow to represent and  to reason about possible conďŹgurations of temporal entities by  means of Temporal Qualitative Constraint Networks (TQCNs).  Each constraint of a TQCN is deďŹned by a set of base relations  of the calculus representing the possible relative positions  between two temporal entities.  Several fundamental problems arise with TQCNs. The main  is the consistency problem which consists in deciding whether  a given TQCN admits a scenario represents consistent temporal information. This problem has been widely studied, in  particular in the context of PA and IA. It is polynomial for PA  and NP-complete for IA. We have now efďŹcient methods to  solve the consistency problem of a TQCN, see for example [3].  Concerning IA, a complete complexity map of the consistency  problem has been realized and now, we know all tractable  subclasses of this calculus [4]. Another problem is the minimal  labeling problem which consists in characterizing the feasible  base relations (base relations satisďŹed by at least a solution)  of a TQCN.  In this paper, we introduce and study a problem which  consists, given a TQCN, in ďŹnding one of the the most  compact solutions, i.e. a solution involving a minimal number  of distinct points of the line (of distinct endpoints of intervals  1530-1311/13 $26.00 ÂŠ 2013 IEEE  1550-1311/13  DOI 10.1109/TIME.2013.11  In this work, we show that, MinCons is NP-complete for  PA despite that the consistency problem is polynomial for this  calculus. Less surprisingly, MinCons is also NP-complete for  IA in the general case, but it is also NP-complete for some  subclasses known to be tractable concerning the consistency  problem. With that in mind, we focus on the subclasses of  the convex relations of PA and IA and show that for these  particular cases, MinCons is polynomial. We deďŹne, for convex  TQCNs, a polynomial method allowing to extract compact  scenarios corresponding to minimal elements of particular  partial orders.  After necessary background in Section 2, we introduce  MinCons in Section 3. We study particular orders on scenarios  in Section 4 and two aggregation operators of scenarios in  Section 5. Section 6 is devoted to MinCons restricted to the  convex TQCNs. Lastly, we conclude.  11  7  II. P RELIMINARIES ON T EMPORAL Q UALITATIVE  C ONSTRAINT N ETWORKS  pi  mi  Relation Symbol Inverse  A (binary) temporal qualitative calculus [8] is based on a  ďŹnite set B of jointly exhaustive and pairwise disjoint (JEPD)  relations deďŹned on a domain D, called base relations. The  set B contains the identity relation Id, and is closed under  the converse operation (â1 ). Given two elements x and y  belonging to D and a base relation b â B, x b y will denote that  x and y satisďŹes b, i.e. (x, y) â b. The complete set of relations  are unions of base relations. Each relation is represented by  the set of the base relations included in the corresponding  union. Hence, 2B will represent the set of relations and we  get 2|B| possible relations. Given x, y â D and r â 2B ,  x r y will denote that x and y satisďŹes a base relation b â r,  and we will say that x and y satisďŹes the relation r. The  set 2B is equipped with the usual set-theoretic operations  (union and intersection), the converse operation, and the  weak composition operation. The converse of a relation is  the union of the converses of its base relations. The weak  composition  of two base relations b and b belonging to  a set of base relations B is the relation of 2B deďŹned by  b  b = {b : âx, y, z â D such that x b y, y b z and x b z}.  For two relations r,  r â 2B , r  r is the relation of 2B    deďŹned by r  r = bâr,b âr b  b . Intuitively, r  r gives  the subset of possible base relations can be satisďŹed by two  elements x and y when x and y satisfy respectively r and r  with a third element z. Renz and Ligozat [8] discuss about  the difference between the weak composition and the usual  relational composition. A subclass of relations is a set A â 2B  closed under converse, intersection, and weak composition.  In this paper, we are just concerned with two temporal  qualitative formalisms, namely the Interval Algebra (IA) [9],  [1] and the Point Algebra [10] (PA). The domain of IA  used will be the set of the intervals of the integer line,  formally DIA = {(xâ , x+ ) â N Ă N : xâ < x+ }. The  set of base relations of this calculus is the set BIA =  {eq, p, pi, m, mi, o, oi, s, si, d, di, f, f i}. These thirteen binary  relations represent all the orderings of the four endpoints  of two intervals, see Figure 1. Concerning PA, the domain  considered will be the set of points of the integer line, i.e.  DPA = N. The set of base relations of PA, denoted by  BPA , is composed by the three binary relations <, > and  =, corresponding to the usual strict total orders and the  identity relation on N. The set 2BPA is formed by 8 relations  corresponding to the set {{<}, {>}, {=}, {<, >}, {<, =}, {>  , =}, {<, >, =}, â}. Sometimes, we will use a short hand  notation for these relations: we will write <, >, =, =, â¤, âĽ,  ? for respectively {<}, {>}, {=}, {<, >}, {<, =}, {>, =},  {<, =, >}.  Meaning  oi  X  precedes  p  pi  Y  X  meets  m  mi  overlaps  o  oi  f  si  Y  eq  X  di  Y  d  X  starts  s  si  during  d  di  Y  s  fi  X  o  Y  X  finishes  f  fi  equals  eq  eq  Y  m  X  Y  p  (a)  (b)  (a) The base relations of IA, (b) the interval lattice.  Fig. 1.  }  {<} = {<, >, =}.  For the following deďŹnitions, we assume given a set B  of base relations of a temporal qualitative calculus deďŹned  on a domain D. A Temporal Qualitative Constraint Network  (TQCN) is a pair formed by a set of variables and a set  of constraints. Each variable represents a temporal entity  and each constraint represents the set of possible qualitative  conďŹgurations between two entities. Formally, a TQCN is  deďŹned as follows:  DeďŹnition 1: A TQCN is a pair N = (V, C) where: V  is a non empty ďŹnite set of variables; C is a mapping that  associates a relation C(v, v  ) â 2B to each pair (v, v  ) of VĂV.  C is such that C(v, v) â {Id} and C(v, v  ) = (C(v  , v))â1 .  Given a TQCN, N = (V, C) we have the following deďŹnitions: N is said to be trivially inconsistent iff âv, v  â V  with C(v, v  ) = â. An instantiation of V is a mapping Ď  deďŹned from V to the domain D. A solution Ď of N is an  instantiation of V such that for every pair (v, v  ) of variables  in V, (Ď(v), Ď(v  )) satisďŹes C(v, v  ), i.e., there exists a base  relation b â C(v, v  ) such that (Ď(v), Ď(v  )) â b. N is  consistent iff it admits a solution. Two TQCNs are equivalent  iff they admit the same solutions.  v1  v0  v0  {eq, s}  {s}  {p, m}  {p, o, m}  {p}  v2  {p}  v1  {p}  {o}  {f i}  {p}  {eq, f, f i}  v3  (a)  (b)  v3  v0  0  v2  v3  v1  Example 1: For example, consider the relations of IA,  {m, s} and {d, eq}. We have the two intervals (3, 5) and  (3, 20) which satisďŹes {m, s} since (3, 5) s (3, 20). Moreover,  {m, s}â1 = {mi, si} and {m, s}  {d, eq} = {d, o, s, m}.  Concerning PA, by considering the two relations of 2BPA ,  {<, >} and {<}, we have {<, >}â1 = {<, >} and {<, >  {p}  v2  1  2  3  4  5  (c)  Fig. 2. (a) A TQCN N of IA, (b) s scenario S of N and (c) a solution of  S and N .  12  8  v0â v0+  v0â = <  v0+ > =  v1â = <  v1+ > âĽ  v2â > âĽ  v2+ > >  v3â > >  v3+ > >  v1â v1+  = <  > â¤  = <  > =  > ?  > >  > >  > >  v2â v2+  < <  â¤ <  < <  ? <  = <  > =  ? <  < =  v3â v3+  < <  < <  < <  < <  ? <  > =  = <  > =  v0â v0+  v0â = <  v0+ > =  v1â = <  v1+ > >  v2â > >  v2+ > >  v3â > >  v3+ > >  v1â v1+  = <  > <  = <  > =  > <  > >  > >  > >  v2â v2+  < <  < <  < <  > <  = <  > =  > <  < =  a solution of N corresponding to S. Figure 3 represents the  convex TQCN of PA corresponding to PA(N ) and the scenario  of PA corresponding to PA(S).  v3â v3+  < <  < <  < <  < <  < <  > =  = <  > =  From now, the term TQCN will implicitly refer to TQCNs  of PA or TQCNs of IA. We associate with each consistent  TQCN N = (V, C) of PA a directed graph denoted by  G< (N ). This graph makes explicit the constraints of the  TQCN N deďŹned by the relation {<} and is deďŹned in the following way : G< (N ) = (V, E) with (v, v  ) â E iff C(v, v  ) =  {<}. Note that, since N is consistent G< (N ) is acyclic. A  path ((v 0 , v 1 ), (v 1 , v 2 ), . . . , (v kâ1 , v k )) of G< (N ) = (V, E)  will be denoted by v 0 < v 1 < v 2 < . . . < v kâ1 < v k .  Furthermore, we associate with each variable v â V two  positive integer numbers, denoted respectively by rankâ (N , v)  and by rank+ (N , v), and deďŹned in the following way:  Fig. 3. The TQCN of PA N  = PA(N ) (left side), a scenario S  of N   (right side), the constraint between by two variables v and v  is given by the  entry of the row (resp. the column) corresponding to v (resp. v  ).  A sub-TQCN N  of N , denoted by N  â N , is a TQCN  (V, C  ) such that C  (v, v  ) â C(v, v  ) âv, v  â V . An atomic  TQCN is a TQCN where each constraint is deďŹned by exactly  one base relation. A scenario is an atomic consistent TQCN.  Given a set of variables V, the set of all scenarios deďŹned on  V is denoted by V. For the particular cases of IA and PA,  this set is respectively denoted by VIA and VPA . Given a  TQCN N , N  will denote the set of scenarios which are  sub-TQCN of N . We will say that the TQCN N admits the  scenario S when S â N .  A TQCN N = (V, C) is -consistent iff for all v, v  , v  â  V, C(v, v  ) â C(v, v  )  C(v  , v  ). Given a TQCN N , the  largest (for â) -consistent sub-TQCN of N will be denoted  by (N ) and called the closure of N by weak composition.  This TQCN can be computed in polynomial time (O(|V|3 )).  In the sequel, CPA , CIA , PIA and HIA , will denote respectively  the subclass of the convex relations of PA, the subclass of the  convex relations of IA [11], the subclass of the pointisable  relations of IA [12] and the subclass of the ORD-Horn of  IA [13]. CPA corresponds to the relations of PA expected the  relation {<, >}. CIA contains 83 relations. Ligozat introduces a  lattice arranging the base relations of BIA , see Figure 1(b). The  convex relations of IA correspond to the intervals of this lattice.  A convex TQCN is a TQCN deďŹned by convex relations.  Furthermore, we have CIA â PIA â HIA . For TQCNs of PA  and TQCNs of IA deďŹned on HIA , computing the closure under  weak composition allows to solve the consistency problem.  HIA is the maximal subclass of IA containing the singleton  relations for which the consistency problem is tractable. A  constraint between two intervals deďŹned by convex relations  of IA can, in an equivalent manner, be expressed by constraints  deďŹned by convex relations of PA on the bounds of the two  intervals. In [12], is given for each convex relation of IA its  translation in PA. Given a set of interval variables V, we  deďŹne  the set of point variables Points(V) by Points(V) =    â +  vâV {v , v }. Moreover, given a TQCN N = (V, C) of IA  deďŹned by relations of CIA , PA(N ) will denote the TQCN of  PA deďŹned on the variables Points(V) obtained by using the  translation given in [12].  â˘  â˘  rankâ (N , v) is the maximal length of the paths v  <  . . . < v from a variable v  â V to the variable v,  rank+ (N , v) is the maximal length of the paths v < . . . <  v  from the variable v to a variable v  â V.  We deďŹne the width of the TQCN N , denoted by width(N ),  by the integer number max{rankâ (N , v) : v â V} + 1. We  extend this deďŹnition to a convex TQCN N of IA by considering its translation into PA : width(N ) = width(PA(N )).  Given a solution Ď of a TQCN N = (V, C) of PA (resp.  IA), we deďŹne the cardinality of Ď, denoted by card(Ď), by  card(Ď) = |{Ď(v) : v â V}| (resp. card(Ď) = |{x, y : v â  V and Ď(v) = (x, y)}|).  Example 3: Figure 4(a) shows a graph G0 whose the  transitive closure is the graph G< (S  ) with S  = (V, C) the  scenario in Figure 3. For each variable v â V is given the integer rankâ (S  , v). For example, we have rankâ (S  , v2â ) = 2  because the longest paths of G< (S  ) having v2â as last vertex  have a length of 2 (the path v0â < v0+ < v2â for example).  The width of S  , i.e. width(S  ), is equal to 6. Furthermore,  rank+ (S  , v2â ) = 3. The cardinality of the solution in Figure  2(c) is 6.  III. T HE M INIMAL C ONSISTENCY P ROBLEM  In this section, we introduce a decision problem concerning  the TQCNs which we call the Minimal Consistency Problem  (MinCons). Intuitively, given a TQCN N and a positive integer  k, this problem is to decide whether there exists or not a  solution of N using at most k distinct points on the line.  More formally, this problem is deďŹned in the following way:  DeďŹnition 2: The problem MinCons :  â˘ Given : A TQCN N = (V, C) and an integer k âĽ 0.  â˘ Question : Is there a solution Ď of N such that card(Ď) â¤  k?  By noting that, given a solution Ď, the width of the scenario  corresponding to Ď and the cardinality of Ď are equal, we can  in a manner equivalent reformulate the question of MinCons by  : is there a consistent scenario S of N such that width(S) â¤ k?  The restriction of MinCons to the TQCNs of PA (resp. IA)  Example 2: Figure 2(a) represents a TQCN N = (V, C)  of IA by a graph. Note that we do not represent the constraint  C(v, v  ) when C(v  , v) is already represented or v = v  . This  TQCN is deďŹned on CIA and is -consistent. In Figure 2(b)  and Figure 2(c), we have respectively a scenario S of N and  13  9  0  5  0  5  v0â  v3+  v0â  v3+  v2+  v1â  5  0  v1â  v0+  1  v2â  2  v1+  v3â  3  4  0  v0+  v1+  v3â  v2â  1  2  3  4  v2+  5  (a) G0  (b) G1  0  v0â  v1â  4  2  v1+  v0+  v3+  v3â  v2â  1  0  2  3  v2+  4  (c) G2  Fig. 4. Three graphs G0 , G1 and G2 corresponding to the graphs G< (S0 ), G< (S1 ), G< (S2 ) (without edges which we can obtain by transitivity), with  S0 , S1 and S2 three scenarios of the TQCN N  . The scenario S0 is the scenario S  .  Ď of N with card(Ď) â¤ 3, for each v â V , there exists a  unique i â {1, 2, 3} such that Ď(coli ) = Ď(v). Moreover, for  all (v, v  ) â E, Ď(v) = Ď(v  ). We can check that G is 3  colorable iff the answer of Ď is yes.  â˘ (2) Ď  = N  = (V  , C  ), k  . The integer k is deďŹned  by 4. For each vertex of G and each color is introduced  a variable of V  : V = V âŞ {col1 , col2 , col3 }. We force  col1 , col2 and col3 to be instantiated by three intervals (the  colors) with same lower bounds and different upper bounds  : C  (col1 , col2 ) = C  (col2 , col3 ) = {s} and C  (col2 , col1 ) =  C  (col3 , col2 ) = {si}. For all v â V , we force the interval  associated with v to have the same lower bounds that the intervals associated with col1 , col2 and col3 : C  (col1 , v) = {eq, s}.  Given (v, v  ) â V Ă V , if (v, v  ) â E then C  (v, v  ) is deďŹned  by {s, si}. In the contrary case, C  (v, v  ) is deďŹned by BIA .  Furthermore, C  (v, v) = {eq} for all v â V. Other constraints  of C  are deďŹned by BIA . For each solution Ď  of N  with  card(Ď  ) â¤ 4 and for each v â V , there exists a unique  i â {1, 2, 3} such that Ď  (coli ) = Ď(v). Moreover, for all  (v, v  ) â E, Ď  (v) = Ď  (v  ). We can show that G is 3 colorable  iff the answer of Ď  is yes.    will be denoted by PMinCons (resp. IMinCons). For example,  consider the instance of IMinCons Ď1 = N , 6 and the  instance of PMinCons Ď2 = N  , 3 with N and N  the  TQCNs respectively described in Figure 3 and Figure 4.  The reader can check that the answer of Ď1 is yes whereas  the answer of Ď2 is no. Given a subclass A â 2BPA (resp.  A â 2BIA ), PMinCons(A) (resp. IMinCons(A)) denotes the  restriction of PMinCons (IMinCons) to the TQCNs deďŹned  by relations belonging to A.  Now, we are going to show that in the general case  MinCons is a NP-complete problem, even for PA for which  the consistency problem is polynomial [2]. By deďŹning the two  sets E â 2BPA and E2 â 2BIA by E = {{=}, {<, >}, BPA } and  E2 = {{eq}, {s}, {si}, {s, si}, BIA }, we have the following  result :  Proposition 1: Let A â 2BPA and A â 2BIA two subclasses. We have:  (1) if E â A then PMinCons(A) is NP-hard ;  (2) if E  â A then IMinCons(A ) is NP-hard.  Proof. Suppose that E â A and E  â A . We are  going to deďŹne a reduction from the 3-coloring problem to  PMinCons(A) and a reduction from the 3-coloring problem to  IMinCons(A ). Let G = (V, E) be an undirected graph to be  colored with 3 colors. We deďŹne the instance Ď of MinConsPA  and the instance Ď  of MinConsIA such that the answer of Ď  (resp. Ď  ) is yes iff G is 3 colorable.  â˘ (1) Ď = N = (V, C), k . The integer k is deďŹned by 3.  To each vertex of G and each color corresponds a variable  of V : V = V âŞ {col1 , col2 , col3 }. We force col1 , col2 and  col3 to have three different values (the colors) by deďŹning  C(coli , colj ) with the relation {<, >} for all i, j â {1, . . . , 3}  such that i = j. For all v, v  â V such that v = v  , if  (v, v  ) â E then C(v, v  ) = {<, >} (v and v  cannot have  the same color). In the contrary case, C(v, v  ) is deďŹned by  {<, =, >}. Furthermore, C(v, v) = {=} for all v â V. Other  constraints of C are deďŹned by {<, =, >}. For any solution  MinCons is clearly in NP since, in polynomial time, we can  check whether an atomic TQCN S on V is a scenario of a  TQCN N = (V, C) and check whether width(S) â¤ k with k  a positive integer. Furthermore, we have the set E  which is  included by PIA â HIA . Hence, from the previous proposition  we can assert the following result :  Theorem 1: PMinCons, IMinCons, IMinCons(PIA ) and  IMinCons(HIA ) are NP-complete problems.  Note that MinCons is a problem that is at least as hard  that the consistency problem. Indeed, we can remark that the  cardinality of a solution of a TQCN N = (V, C) is at most  |V | for a TQCN of PA and at most 2|V | for a TQCN of  IA. Hence, we can solve the consistency problem of a TQCN  N = (V, C) of PA (resp. of IA) by solving PMinCons of  14  10  N , |V | (resp. IMinCons of N , 2|V | ). From this, we can  directly establish (without using Proposition 1) that IMinCons  is NP-hard since the consistency problem of IA is NP-hard.  Despite Theorem 1, we will see that there exist some  interesting polynomial cases for MinCons. Indeed, in the  sequel, we study the case of the convex subclasses and show  that PMinCons(CPA ) and IMinCons(CIA ) are polynomial.  Proof. The transitivity and the reďŹexivity follow straightly  the deďŹnition of (VPA , â¤â ) and (VPA , â¤+ ). Now,  consider two scenarios S = (V, C), S  = (V, C  ) â VPA  such that S â¤â S  and S  â¤â S. For all v â V,  rankâ (S, v) = rankâ (S  , v). Hence, for all v, v  â V,  C(v, v  ) = {=} iff rankâ (S, v) = rankâ (S, v  ) iff  rankâ (S  , v) = rankâ (S  , v  ) iff C  (v, v  ) = {=}. For all  v, v  â V, C(v, v  ) = {<} iff rankâ (S, v) < rankâ (S, v  )  iff rankâ (S  , v) < rankâ (S  , v  ) iff C  (v, v  ) = {<}. We  can conclude that S and S  have the same constraints. By a  similar line of reasoning we can show that (VPA , â¤+ ) is  antisymmetric.    IV. C OMPARISON OF S CENARIOS  In this section, we introduce several preorder relations on  scenarios of PA. These binary relations will allow us to compare scenarios and, under certain conditions, to characterize  some scenarios of a TQCN among the scenarios having a  minimal width, i.e. the scenarios corresponding to the solutions  using a minimal number of points on the line.  To compare the scenarios deďŹned on a set of variables V in  term of width, we introduce a ďŹrst binary relation denoted by  (VPA , â¤C ) and deďŹned in the following manner:  We can show that for all scenarios S and S  , when S and S   satisfy â¤â or â¤+ , S is at least as compact as S  . Indeed, we  have the following property:  Proposition 3: Let two scenarios S = (V, C) and S  =  (V, C  ) belonging to VPA . We have: if S â¤â S  or S â¤+ S   then S â¤C S  .  DeďŹnition 3: Given a set of point variables V, the binary  relation (VPA , â¤C ) is deďŹned by : âS, S  â VPA , S â¤C  S  iff width(S) â¤ width(S  ).  Proof. We know that width(S) = max{rankâ (S, v) :  v â V} + 1 = max{rank+ (S, v) : v â V} + 1 et  width(S  ) = max{rankâ (S  , v) : v â V} + 1 =  max{rank+ (S  , v) : v â V}+1. Furthermore, if S â¤â S  (resp.  S â¤+ S  ), for all v â V, rankâ (S, v) â¤ rankâ (S  , v) (resp.  rank+ (S, v) â¤ rank+ (S  , v)). From all this, we can conclude  that if S â¤â S  or S â¤+ S  then width(S) â¤ width(S  ).   Clearly, (VPA , â¤C ) is a transitive and reďŹexive relation. In  the general case, it is not an antisymmetric relation since two  distinct scenarios deďŹned on a same set of variables can have  same width. For two scenarios S and S  , we will say that S  is at least as compact as S  when S â¤ S  .  In the sequel, we deďŹne two orders on the set of the  scenarios of PA deďŹned on V, respectively denoted by â¤â  and â¤+ . Intuitively, two scenarios S and S  satisfy â¤â iff  for all solutions Ď and Ď  of S and S  respectively, for each  variable v â V, we have the number of points on the line  before Ď(v) for S, i.e. |{Ď(v  ) : Ď(v  ) < Ď(v)}| which is  less than or equal to the number of points on the line before  Ď(v) for S  , i.e. |{Ď  (v  ) : Ď(v  ) < Ď  (v)}|. For the relation  â¤+ , we compare the numbers of points on the line after Ď(v)  rather than the points before Ď(v). Formally, (VPA , â¤â ) and  (VPA , â¤+ ) are deďŹned in the following manner :  V. AGGREGATION O PERATORS FOR S CENARIOS  In this section, we introduce two aggregation operators,  denoted by  and â, allowing to combine two scenarios S  and S  of PA in order to obtain a scenario both smallest than  S and S  w.r.t. the partial order â¤â (resp. â¤+ ) for  (resp.  â). Hence, the scenario resulting of the aggregation is at least  as compact as S and S  . These two operators will allow us  to show that all consistent convex TQCN admits a unique  minimal scenario w.r.t. â¤â or â¤+ .  DeďŹnition 5: Let S = (V, C), S  = (V, C  ) â VPA .  DeďŹnition 4: Given a set of point variables V, the binary  relations (VPA , â¤â ) and (VPA , â¤+ ) are deďŹned by :    â  â˘ âS, S â VPA , S â¤  S  iff âv â V, rankâ (S, v) â¤  â    rank (S , v) ;    +  â˘ âS, S â VPA , S â¤  S  iff âv â V, rank+ (S, v) â¤  rank+ (S  , v).  â˘  â˘  Example 4: For example, consider the three scenarios S0 ,  S1 and S2 represented by the graphs G0 , G1 and G2 in Figure  4. We can check that S0 â¤+ S2 and S1 â¤+ S2 . However,  S0 â¤+ S1 . Indeed, we have for example rankâ (S0 , v1+ ) â¤  rankâ (S1 , v1+ ) (rankâ (S0 , v1+ ) = 3 and rankâ (S1 , v1+ ) = 2).  S  S  is the unique scenario S  = (V, C  ) of VPA  having as solution the instantiation Ď deďŹned by Ď(v) =  min{rankâ (S, v), rankâ (S  , v)} ;  S â S  is the unique scenario S  = (V, C  )  of VPA having as solution the instantiation Ď deďŹned by Ď(v) = (max{width(S), width(S  )} â 1) â  min{rank+ (S, v), rank+ (S  , v)}.  Intuitively, from two scenarios S and S  , the operator  (resp.  â) allows to obtain a scenario by preserving, for each v â V,  the shortest paths of G< (S) or G< (S  ) of the form v 0 <  . . . < v k with v k = v (resp. of the form v 0 < . . . < v k with  v 0 = v). Note that the operators  and â are close to the  operator MAX used in [14] to aggregate preference models.  The relations â¤â and â¤+ are two partial orders, as the  following proposition proves:  Proposition 2: Let V a set of point variables. We have:  (VPA , â¤â ) and (VPA , â¤+ ) are reďŹexive, transitive and  antisymmetric.  15  11  Example 5: For example, consider the three scenarios S0 ,  S1 and S2 respectively represented by the graphs G0 , G1 and  G2 in Figure 4. The reader can check that S2 is S0  S2 .  elements and, with this result, we will show that MinCons is  polynomial for the convex TQCNs, contrary to the general  case.  Proposition 5: Let N = (V, C) be a convex TQCN of PA  and two scenarios S, S  â N . We have: S  S  â N  and  S â S  â N .  Proof. We prove the property S  S  â N . The  property S â S  â N  can be proved by a similar  line of reasoning. Let Ď the instantiation deďŹned by  Ď(v) = min{rankâ (S, v), rankâ (S  , v)} for all v â V and,  let v, v  two variables belonging to V. We denote by b, b and  b the base relations deďŹning the constraints between v and  v  of S, S  , S  S  , respectively. Note that by deďŹnition b  is the base relation satisďŹed by the pair (Ď(v), Ď(v  )). We are  going to show that b â C(v, v  ) :  â˘ Case b is < and b is <. We have  <  rankâ (S, v  ) and rankâ (S  , v)  <  rankâ (S, v)  â     rank (S , v ). Hence, min{rankâ (S, v), rankâ (S  , v)} <  min{rankâ (S, v  ), rankâ (S  , v  )}. Consequently, we have  Ď(v) < Ď(v  ). We can conclude that b is < which belongs  to C(v, v  ) since b is also <.  â˘ Case b is < and b is =. We have rankâ (S, v) <  rankâ (S, v  ) and rankâ (S  , v) = rankâ (S  , v  ). Consider the  three possible following cases:  (a) Case rankâ (S  , v) â¤ rankâ (S, v). We can show that  Ď(v) = min{rankâ (S, v), rankâ (S  , v)} = rankâ (S  , v) and  Ď(v  ) = min{rankâ (S, v  ), rankâ (S  , v  )} = rankâ (S  , v  ) =  rankâ (S  , v). Hence, Ď(v) = Ď(v  ). Consequently, b is =  which belongs to C(v, v  ) since b is also =.  (b) Case rankâ (S, v) < rankâ (S  , v) < rankâ (S, v  ). We  can show that Ď(v) = min{rankâ (S, v), rankâ (S  , v)} =  rankâ (S, v) and Ď(v  ) = min{rankâ (S, v  ), rankâ (S  , v  )} =  rankâ (S  , v  ) = rankâ (S  , v). Hence, Ď(v) < Ď(v  ).  Consequently, b is < which belongs to C(v, v  ) because b  is also <.  (c) Case rankâ (S, v  ) â¤ rankâ (S  , v). We can show that  Ď(v) = min{rankâ (S, v), rankâ (S  , v)} = rankâ (S, v) and  Ď(v  ) = min{rankâ (S, v  ), rankâ (S  , v  )} = rankâ (S, v  ).  Hence, Ď(v) < Ď(v  ). Consequently, b is < which belongs  to C(v, v  ) since b is also <.  â˘ Case b is < and b is >. We have C(v, v  ) = {<, =, >}  since {<, =, >} is the unique convex relation containing both  < and >. Consequently, b belongs to C(v, v  ).  â˘ Case b is = and b is =. We have  =  rankâ (S, v  ) and rankâ (S  , v)  =  rankâ (S, v)  rankâ (S  , v  ). Hence, min{rankâ (S, v), rankâ (S  , v)} =  min{rankâ (S, v  ), rankâ (S  , v  )}. Consequently, we have  Ď(v) = Ď(v  ). We can conclude that b is = which belongs  to C(v, v  ) since b is also =.  â˘ The other cases corresponds to previous cases by permuting    S and S  or v and v  .  As explain at the beginning of this section, the operators   and â allow to obtain a scenario at least as compact as  the scenarios given as inputs and also smaller than the two  scenarios w.r.t. respectively â¤â and â¤+ :  Proposition 4: Let S and S  = (V, C  ) be two scenarios  belonging to VPA . We have:    â    â   â˘ (1) (S  S ) â¤ S and (S  S ) â¤ S ;    +    +   â˘ (2) (S â S ) â¤ S and (S â S ) â¤ S ;          â˘ (3) (S  S ) â¤C S, (S  S ) â¤C S , (S â S ) â¤C S and      (S â S ) â¤C S .  Proof.  â˘ (1) Let S  = (V, C  ) be the TQCN S  S  and Ď the  instantiation on V deďŹned by Ď(v) = min{rankâ (S, v),  rankâ (S  , v)}. Ď uses only positive or null integers.  Consequently, we have |{v  â V : C  (v  ) =  {<}}| â¤ Ď(v). Hence, |{v  â V : C  (v  ) =  {<}}|  â¤  min{rankâ (S, v), rankâ (S  , v)}. Since  â    rank (S , v) = |{v  â V : C  = {<}}|, we can conclude  â¤  min{rankâ (S, v), rankâ (S  , v)}.  that rankâ (S  , v)  â    Hence, rank (S , v) â¤ rankâ (S, v) and rankâ (S  , v) â¤  rankâ (S  , v)}. Thus, we have (S  S  ) â¤â S and  (S  S  ) â¤â S  .  â˘ (2) The property (2) can be proved by following an  approach similar to the one followed for the property (1).  â˘ (3) The property (3) is a consequence of the properties (1)  and (2) of Proposition 3.    Hence, both aggregation operators  and â allows us to obtain  from two scenarios S and S  , a scenario at least as compact as  S and S  . Nevertheless, note that in the general case, when S  and S  are scenarios of a TQCN N , the scenarios S  S  and  S â S  are not necessarily scenarios of N . To be convinced  of this, consider the TQCN of PA N  = (V, C  ) deďŹned  by the same set of variables and the same constraints than  those of the TQCN N  represented in Figure 3 except for the  constraint between v1+ and v2â which is deďŹned for N  by  the relation {<, >}. The scenarios S0 and S1 represented in  Figure 4 are scenarios of N  . However, the scenario S2 in the  same ďŹgure, which corresponds to S0  S1 , is not a scenario  of N  . Indeed, the base relation satisďŹed by (v1+ , v2â ) is = for  this scenario whereas C  (v1+ , v2â ) is the relation {<, >}. In  spite of this, we will show in the next section that the result of  the operators  and â on two scenarios of a convex TQCN  is always a scenario of this TQCN.  VI. MinCons AND THE CONVEX TQCNS  In this section, we focus on the convex TQCNs, i.e. TQCNs  of PA (resp. IA) deďŹned by relations belonging to the subclass  CPA (resp. CIA ). We will notably show that the partial orders  â¤â and â¤+ restricted to the scenarios of a convex and consistent TQCN admits a unique minimal element. We will also  characterize a polynomial method to compute these minimal  From this proposition, we can establish that for every  convex and consistent TQCN of PA N , (N , â¤â ) and  (N , â¤+ ) have a unique minimal element :  16  12  integers Ď(v) and Ď(v  ). Consider all possible cases and let  us show that b â C(v, v  ) :  â Case 1: b is the relation <. We have k < k  . Furthermore,  there exists two paths of G< (N ) composed of distinct  variables of the form v 0 < . . . < v k with v k = v      and w0 < . . . < wk with wk = v  . Now, suppose  that < does not belong to C(v, v  ). We have C(v, v  )  which corresponds to one of the following relations    {{=, >}, {=}}. Consider the variable wk â1 . We have    k â1  ) = {>}. As N is -consistent, we have  C(v , w        C(v, wk â1 ) â (C(v, v  )C(v  , wk â1 )). Hence, C(v, wk â1 )  is the relation {>} since {=, >}  {>} = {=}  {>} = {>}.    Hence, w0 < . . . < wk â1 < v is a path of G< (N ) with  a length greater than or equal to rankâ (N , v  ). There is a  contradiction. We can conclude that < belongs to C(v, v  ).  â Case 2: b is the relation > or the relation =. By following  a line of reasoning similar to the one of the previous case,  we can show that b â C(v, v  ).  â˘ Lastly, let us show that S is Minâ¤â (N ). Suppose that for  a variable v â V, rankâ (S, v) > rankâ (Minâ¤â (N ), v). Let  k = rankâ (S, v). For the graph G< (Minâ¤â (N )), every path  of the form v 0 < . . . < v has a length strictly lower than k. It  is not possible since G< (N ) is a subgraph of G< (Minâ¤â (N ))  which has a path of this form of length equal to k. Hence, for  every v â V, we have rankâ (S, v) â¤ rankâ (Minâ¤â (N ), v).  Consequently, S â¤â Minâ¤â (N ). Since Minâ¤â (N ) is the  unique minimal element of (N , â¤â ), S is the scenario    Minâ¤â (N ).  Proposition 6: Let N = (V, C) be a consistent and convex  TQCN of PA. The partial orders (N , â¤â ) and (N , â¤+  ) admit unique minimal elements, denoted by respectively  Minâ¤â (N ) and Minâ¤+ (N ).  Proof. Note that N  is a non empty set since N is  consistent. Hence, (N , â¤â ) admits at least one minimal  element. Now, suppose that N admits two different scenarios  S and S  such that S and S  are minimal elements of  (N , â¤â ). We will denote by S  the scenario corresponding  to S  S  . From Proposition 5, S  belongs to N . Moreover,  from Proposition 4, we have S  â¤â S and S  â¤â S  . Since  S and S  are two minimal elements of (N , â¤â ), we can  assert that S  = S and S  = S  . Consequently, S = S  .  There is a contradiction. We can conclude that (N , â¤â ) has  a unique minimal element. With a similar line of reasoning we  can prove that (N , â¤+ ) admits a unique minimal element.   For each convex and consistent TQCN of PA N , we can also  show that there is no scenario more compact than Minâ¤â (N )  and Minâ¤+ (N ):  Proposition 7: Let N = (V, C) be a convex and consistent TQCN of PA. For every scenario S â N , we have  Minâ¤â (N ) â¤C S and Minâ¤+ (N ) â¤C S.  Proof. Let S â N . We denote by S  the scenario  corresponding to Minâ¤â (N )  S. From Proposition 5, S  is  a scenario belonging to N . Moreover, from Proposition 4,  we have S  â¤â Minâ¤â (N ) (a) and S  â¤â S (b). From  (a) and the deďŹnition of Minâ¤â (N ), we can assert that  S  = Minâ¤â (N ). Consequently, from this and (b) we have  Minâ¤â (N ) â¤â S. From Proposition 3, we can conclude  that Minâ¤â (N ) â¤C S. Minâ¤+ (N ) â¤C S can be proved in a  similar manner.    From this result we can establish that the scenarios Minâ¤â (N )  and Minâ¤+ (N ) of a convex, non trivially inconsistent and  -consistent TQCN N can be computed in O(n2 ) with n  the number of its variables. Indeed, for this, in a ďŹrst step  we compute the graph G< (N ). Then, in a second step, we  compute for each v â V, rankâ (N , v) and rank+ (N , v)  from the directed acyclic graph G< (N ). In a last step, the  constraints of Minâ¤â (N ) and Minâ¤+ (N ) are computed from  the integers obtained in the previous step. Each of these steps  can be realized in O(n2 ).  For convex TQCNs, from Proposition 7 we know that  Minâ¤â (N ) and Minâ¤+ (N ) belong to the set of scenarios  which are the most compact. From this and the previous  proposition, we can establish that MinCons is a polynomial  problem for the convex TQCNs:  Now, given a consistent and convex TQCN of PA N , we  are going to establish a result allowing to compute the two  scenarios Minâ¤â (N ) and Minâ¤+ (N ).  Proposition 8: Let N = (V, C) be a not trivially inconsistent, -consistent and convex TQCN of PA. We have :  â˘  â˘  (1) Minâ¤â (N ) corresponds to the scenario on V having  as solution the instantiation Ď deďŹned by: for all v â V,  Ď(v) = rankâ (N , v);  (2) Minâ¤+ (N ) corresponds to the scenario on V having as solution the instantiation Ď deďŹned by: Ď(v) =  rank+ (N , v).  Theorem 2: PMinCons(CPA ) and IMinCons(CIA ) are polynomial and can be solved in O(n3 ), with n the number of  variables of the TQCN considered.  Proof. Due to lack of space, we just give a proof for  the ďŹrst property. To prove the property (2), we can use a  similar approach. Note that since N is -consistent and not  trivially inconsistent, N is consistent. Let S = (V, C  ) be  the scenario having as solution the instantiation Ď deďŹned by  Ď(v) = rankâ (N , v) for all v â V.  â˘ First, let us show that S is a scenario of N . Let v, v  â V  and b the base relation deďŹning the constraint C  (v, v  ),  i.e. the base relation satisďŹed by the pair (Ď(v), Ď(v  )).  Sometimes, we will denote by respectively k and k  the two  Proof.  â˘ Let Ď = (N , k) be an instance of PMinCons(CPA ). To  answer to the question associated with Ď we can in a  ďŹrst step compute (in O(n3 )) the closure under weak  composition of N , i.e. the TQCN (N ). (N ) is convex  and equivalent to N . In the case where (N ) is trivially  inconsistent, we know that N is not consistent and the  answer of Ď is no. In the contrary case, in a second  17  13  v0â  v1â  v0+  v1  v3â  v2  v0  v1+  v2+  v3+  v2â  v3  0  1  2  3  v0â  v1â  v0+  v1+  v2â  v3â  v2+  v3+  (a) G3  v1  v2  v0  v3  0  1  2  3  v0â  v1â  v0+  v1+  v2â  v3â  v2+  v3+  (b) Ď1  (c) Ď2  v0  v0  {eq}  {m}  v1  {eq}  {p}  {p}  v2  {p}  v1  {m}  {p}  {p}  v2  {p}  {f i}  {eq}  v3  v3  (d) S1  (e) S2  Fig. 5.  â˘  step we compute the maximal length k  of the paths of  G< ((N )) (in O(n2 ). We know that k  corresponds to  the width of the most compact scenarios of N since  k  = width(Minâ¤â ((N ))) = width(Minâ¤+ ((N )))  (Proposition 8). Hence, if k âĽ k  then the answer of  Ď is yes, otherwise the answer is no.  Let Ď = (N , k) an instance of IMinCons(CIA ) with  N = (V, C). To answer to the question associated with  Ď (or ďŹnd a compact scenario of N ), we can consider  the equivalent problem of PMinCons(CPA ) corresponding  to the instance Ď  = (PA(N ), k). Remind that PA(N )  corresponds to the translation of N into TQCN N  of  PA deďŹned on the set of variables Points(V).    [2] M. Vilain, H. Kautz, and P. van Beek, âConstraint propagation  algorithms for temporal reasoning: a revised report,â Qualitative  Reasoning about Physical Systems, pp. 372â381, 1990.  [3] J. Huang, J. J. Li, and J. Renz, âDecomposition and tractability  in qualitative spatial and temporal reasoning,â Artif. Intell., vol.  195, pp. 140â164, 2013.  [4] T. Drakengren and P. Jonsson, âA complete classiďŹcation of  tractability in allenâs algebra relative to subsets of basic relations,â Artif. Intell., vol. 106, no. 2, pp. 205â219, 1998.  [5] C. Boutilier, âToward a logic for qualitative decision theory,â in  KRâ94, 1994, pp. 75â86.  [6] A. N. The and A. TsoukiaĚs, âNumerical representation of pqi  interval orders,â Discrete Applied Mathematics, vol. 147, no. 1,  pp. 125â146, 2005.  [7] J.-F. Condotta and S. Kaci, âCompiling preference queries in  qualitative constraint problems,â in Proc. of The 26th Intern.  FLAIRS Conference (FLAIRSâ13), pp. 1-6, 2013.  [8] J. Renz and G. Ligozat, âWeak composition for qualitative  spatial and temporal reasoning,â in Proc. of the 11th Intern.  Conf. CPâ05, Spain, LNCS, vol. 3709, 2005, pp. 534â548.  [9] J. F. Allen, âAn interval-based representation of temporal knowledge,â in IJCAI, 1981.  [10] M. Vilain and H. Kautz, âConstraint Propagation Algorithms  for Temporal Reasoning,â in Proc. of the Fifth National Conf.  on ArtiďŹcial Intelligence (AAAIâ86), 1986, pp. 377â382.  [11] K. NoĚkel, âTemporally distributed symptoms in technical diagnosis,â LNCS, vol. 517, pp. 1â184, 1991.  [12] P. Van Beek and R. Cohen, âExact and approximate reasoning  about temporal relations,â Computational Intelligence, vol. 6,  pp. 133â44, 1990.  [13] B. Nebel and H.-J. BuĚrckert, âReasoning About Temporal  Relations: A Maximal Tractable Subclass of Allenâs Interval  Algebra,â JACM, vol. 42, pp. 43â66, 1995.  [14] S. Kaci and L. W. N. van der Torre, âAlgorithms for a  nonmonotonic logic of preferences,â in Proc. of The 8th Euro.  Conf. Symbolic and Quantitative Approaches to Reasoning with  Uncertainty (ECSQARUâ05), 2005, pp. 281â292.  VII. C ONCLUSION  In this paper, we introduced and studied the problem which  consists in charachterizing compact solutions or scenarios of  a TQCN and a related decision problem called MinCons.  We showed that these problems are NP-hard for PA and  for IA. Moreover, we proved that for the particular of the  convex relations these problems are polynomial. For this, by  following an approach based on particular partial orders and  aggregation operators on scenarios, we proved that we can  obtain in polynomial time particular compact scenarios for  the consistent convex TQCNs. A ďŹnal objective of our work  is to identify all tractable cases for MinCons of IA and deďŹne  methods to solve this problem for the general case.  R EFERENCES  [1] J. F. Allen, âMaintaining knowledge about temporal intervals,â  vol. 26, no. 11. New York, NY, USA: ACM, 1983, pp. 832â843.  18  14 