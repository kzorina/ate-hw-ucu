On Non-local Propositional and Local One-variable Quantified CTL  Sebastian Bauer  Institut fuÄšÂˆr Informatik,  UniversitaÄšÂˆt Leipzig,  Augustus-Platz 10Ã¢Â€Â“11,  04109 Leipzig, Germany  bauer@informatik.uni-leipzig.de  Frank Wolter  Institut fuÄšÂˆr Informatik,  UniversitaÄšÂˆt Leipzig,  Augustus-Platz 10Ã¢Â€Â“11,  04109 Leipzig, Germany  wolter@informatik.uni-leipzig.de  Abstract  We prove decidability of Ã¢Â€Â˜non-localÃ¢Â€Â™ propositional CTL ,  where truth values of atoms may depend on the branch of  evaluation. This result is then used to show decidability  of the Ã¢Â€Â˜weakÃ¢Â€Â™ one-variable fragment of first-order (local)  CTL , in which all temporal operators and path quantifiers  except Ã¢Â€Â˜tomorrowÃ¢Â€Â™ are applicable only to sentences. Various spatio-temporal logics based on combinations of CTL  and RCC-8 can be embedded into this fragment, and so are  decidable.  1 Introduction  This paper continues the investigation of the computational behaviour of first-order branching time temporal logics started in [6]. A Ã¢Â€Â˜negativeÃ¢Â€Â™ result obtained in [6] is the  undecidability of the one-variable fragment of quantified  computational tree logic CTL (both bundled [1, 10] and  Ã¢Â€Â˜unbundledÃ¢Â€Â™ versions, and even with sole temporal operator Ã¢Â€Â˜some time in the futureÃ¢Â€Â™). On the other hand, it was  shown that by restricting applications of first-order quantifiers to state (i.e., path-independent) formulas, and applications of temporal operators and path quantifiers to formulas  with at most one free variable, decidable fragments can be  obtained.  Here we prove decidability of another kind of fragment  of first-order CTL , the so-called weak one-variable fragment, in which quantifiers are not restricted to state formu-  Ian Hodkinson  Department of Computing,  Imperial College,  180 QueenÃ¢Â€Â™s Gate,  London SW7 2BZ, U.K.  imh@doc.ic.ac.uk  Michael Zakharyaschev  Department of Computer Science,  KingÃ¢Â€Â™s College,  Strand,  London WC2R 2LS, U.K.  mz@dcs.kcl.ac.uk  las, but only the next-time operator may be applied to open  formulas, while all other temporal operators and path quantifiers are applicable only to sentences. The main technical  instrument is the method of quasimodels [4]. We first show  decidability of the non-local version of propositional CTL ,  where truth values of atoms may depend on the branch of  evaluation.1 We then show that this logic can express the  existence of a certain quasimodel associated with a given  formula of the weak one-variable fragment. Since this existence is equivalent to the satisfiability of the formula, the  decidability of the weak fragment follows. This decidability result is not only of interest per se, but also because it  can be used to obtain decidability results for certain spatiotemporal logics based on CTL and the region connection  calculus RCC-8 (see the survey papers [5, 9]). All omitted  details of proofs can be found in the full draft version of the  paper at http://www.dcs.kcl.ac.uk/staff/mz.  2 Decidability of non-local PCTL  The propositional language PCTL [3, 7] extends propositional logic with temporal connectives U; S (Ã¢Â€Â˜until,Ã¢Â€Â™  Ã¢Â€Â˜sinceÃ¢Â€Â™) and a path quantifier E (Ã¢Â€Â˜there exists a branch (or  history)Ã¢Â€Â™). The dual path quantifier A (Ã¢Â€Â˜for all branches  (or histories)Ã¢Â€Â™) is defined as an abbreviation: AÄÂ• = E ÄÂ•.  Other standard abbreviations we need are: 3F ÄÂ• = U ÄÂ•,  2F ÄÂ• = 3F ÄÂ•, 3PÄÂ• = S ÄÂ•, ÄÂ• = U ÄÂ•, P ÄÂ• = S ÄÂ•  (Ã¢Â€Â˜some time in the future,Ã¢Â€Â™ Ã¢Â€Â˜always in the future,Ã¢Â€Â™ Ã¢Â€Â˜some time  : :  >  ?  ::  >  ?  1 This contrasts with the behaviour of process logic, the local version of  which is decidable, while the non-local one is undecidable [2].  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE  in the past,Ã¢Â€Â™ Ã¢Â€Â˜at the next momentÃ¢Â€Â™ and Ã¢Â€Â˜at the previous momentÃ¢Â€Â™). We write P for the underlying set of propositional  atoms.  PCTL is interpreted in (bundled and unbundled) models  based on ÄÂ‰-trees. A tree is a strict partial order T = hT ; <i  such that for all w 2 T , the set fv 2 T : v < wg is linearly  ordered by <. When we write T for a tree, it will be implicit  that T = hT ; <i. For t 2 T , let ht (t ) = jfu 2 T : u < t gj. A  full branch of F is a maximal linearly-ordered subset of T .  In this paper we are only concerned with ÄÂ‰-trees. An ÄÂ‰-tree  is a rooted tree whose full branches, ordered by <, are all  order-isomorphic to the natural numbers hS  N ; <i . A bundle  on T is a set H of full branches of T with H = T .  In this paper we deal with the Ã¢Â€Â˜non-localÃ¢Â€Â™ variant of  PCTL in which truth values of atoms can depend on the  branch of evaluation. Thus, a bundled model has the form  M = T; H ; h , where T is an ÄÂ‰-tree, H is a bundle on T,  and h : P ! Ã¢Â„Â˜(f(ÃË›; t ) : t 2 ÃË› 2 H g). M is a full tree model  if H is the set of all full branches of T. The semantics of  PCTL is now defined as follows, where t 2 ÃË› 2 H :  Proof. Let M = T; H ; h be a tree model. We may view  M as a two-sorted first-order structure, the two sorts being  T and H . Taking a countable elementary substructure of  this yields a bundled tree model N = T0 ; H0 ; h0 whose  tree T0 and bundle H0 are countable. Here,  h0 ( p) = h( p) \ f(ÃË›; t ) : t 2 ÃË› 2 H0 g  for any atom p. It is easy to translate PCTL -formulas to  two-sorted first-order formulas with the same meaning. It  follows that for any ÃË› 2 H0 , t 2 ÃË›, and any formula ÄÂˆ, we  have (M; ÃË›; t ) j= ÄÂˆ iff (N; ÃË›; t ) j= ÄÂˆ. This completes the  proof for the bundled case.  Suppose  D now thatEH contains all full branches of T and  let N = T0 ; H 0 ; h0 be the full tree model based on N,  where H 0  H0 is the set of all full branches of T0 , and  h0 ( p) = h( p) \ f(t ; ÃË›) : t 2 ÃË› 2 H 0 g, for an atom p. We  claim that for all PCTL -formulas ÄÂˆ, all full branches ÃÅ‚ of  T0 and all t 2 ÃÅ‚, we have  (M; ÃÅ‚; t ) j= ÄÂˆ   for an atom p, (M; ÃË›; t ) j= p iff (ÃË›; t ) 2 h( p);   the booleans are defined as usual;    (M; ÃË›; t ) j=    (M; ÃË›; t ) j= ÄÂ• S ÄÂˆ    (M; ÃË›; t ) j=  ÄÂ• U ÄÂˆ iff there is u > t such that u 2 ÃË›,  ÄÂˆ, and (M; ÃË›; v) j= ÄÂ• for all v 2 (t ; u),  where (t ; u) = fv 2 T : t < v < ug;  (M; ÃË›; u) j=  iff there is u < t with (M; ÃË›; u) j= ÄÂˆ  and (M; ÃË›; v) j= ÄÂ• for all v 2 (u; t );  t 2 ÃÅ‚.  EÄÂ• iff (M; ÃÅ‚; t ) j= ÄÂ• for some ÃÅ‚ 2 H  with  R EMARK 1. By requiring that (ÃË›; t ) 2 h( p) if and only if  (ÃË›0 ; t ) 2 h( p) for all p, t, ÃË›, ÃË›0 with t 2 ÃË› \ ÃË›0 , we obtain  the traditional local semantics in which the truth values of  atoms do not depend on the branch of evaluation. For an  atom p, this independence is expressible (at the root of an  ÄÂ‰-tree) in the non-local semantics by  ÃÅ¥( p) = (E p ! A p) ^ A2F (E p ! A p):  Thus, a formula ÄÂ• is satisfiable in the local semantics iff  (ÄÂ• _  3F ÄÂ•) ^ :3P> ^  ^  Fix a PCTL -formula ÄÂ•.  D EFINITION 3. Let sub(ÄÂ•) denote the set of subformulas of  ÄÂ• and their negations. A type for ÄÂ• is a subset ÄÂƒ of sub(ÄÂ•)  such that ÄÂˆ ^ ÄÂ‡ 2 ÄÂƒ iff ÄÂˆ 2 ÄÂƒ and ÄÂ‡ 2 ÄÂƒ, for every ÄÂˆ ^ ÄÂ‡ in  sub(ÄÂ•), and :ÄÂˆ 2 ÄÂƒ iff ÄÂˆ 2  = ÄÂƒ, for every :ÄÂˆ 2 sub(ÄÂ•). A set  ÃÅ of types is said to be coherent if it is non-empty and for  T  S  ÄÂˆ 2 sub(ÄÂ•), the conditions EÄÂˆ 2 ÃÅ, EÄÂˆ 2 ÃÅ, and  all ES  ÄÂˆ 2 ÃÅ are equivalent.  Fix an ÄÂ‰-tree T = hT ; <i.  D EFINITION 4. Given a non-empty set ÃÅt of types for each  t 2 T , and a full branch ÃË› of T, a run in ÃË› is a map  ÃÅ¥( p)  L EMMA 2. If a PCTL -formula ÄÂ• is satisfiable in a full  (bundled) tree model, then ÄÂ• is satisfiable in a full (respectively, bundled) tree model based on a countable ÄÂ‰-tree.    (N; ÃÅ‚; t ) j= ÄÂˆ:  The proof is by induction on ÄÂˆ. The atomic, boolean, and  temporal cases are trivial. Consider the case EÄÂˆ and inductively assume the result for ÄÂˆ.  If (M; ÃÅ‚; t ) j= EÄÂˆ, pick ÃË› 2 H0 containing t. Clearly,  (M; ÃË›; t ) j= EÄÂˆ, so (N; ÃË›; t ) j= EÄÂˆ. Then there is ÃË›0 2 H0  with (N; ÃË›0 ; t ) j= ÄÂˆ. Thus, (M; ÃË›0 ; t ) j= ÄÂˆ. Inductively,  (N; ÃË›0 ; t ) j= ÄÂˆ. So (N; ÃÅ‚; t ) j= EÄÂˆ, as required. The converse  implication is easy.  r:ÃË›!  p 2ÃÅš  is satisfiable in the non-local semantics, where ÃÅš denotes  the set of atoms occurring in ÄÂ•. Hence, local satisfiability is  reducible to non-local satisfiability.  iff  [  ÃÅt  t 2ÃË›  such that   r(t ) 2 ÃÅt for each t 2 ÃË›,   for all ÄÂˆ U ÄÂ‡ 2 sub(ÄÂ•) and t 2 ÃË›, we have ÄÂˆ U ÄÂ‡ 2 r(t )  iff there is u > t with u 2 ÃË›, ÄÂ‡ 2 r(u), and ÄÂˆ 2 r(v) for  all v 2 (t ; u),  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE   for all ÄÂˆ S ÄÂ‡ 2 sub(ÄÂ•) and t 2 ÃË›, we have ÄÂˆ S ÄÂ‡ 2 r(t )  iff there is u < t with ÄÂ‡ 2 r(u) and ÄÂˆ 2 r(v) for all  v 2 (u; t ).  D EFINITION 5. A family (ÃÅt : t 2 T ) of coherent sets of  types is said to be an unbundled quasimodel for ÄÂ• over if  T  1. ÄÂ• 2 ÄÂƒ 2 ÃÅt for some t 2 T and ÄÂƒ 2 ÃÅt ,  T  2. for all t 2 T , ÄÂƒ 2 ÃÅt , there is a full branch ÃË› of containing t and there is a run r in ÃË› such that r(t ) = ÄÂƒ,  T  3. for each full branch ÃË› of , there exists a run in ÃË›.  : t 2 T ) is a bundled quasimodel for ÄÂ• over  fies conditions 1 and 2.  (ÃÅt  T if it satis-  L EMMA 6. ÄÂ• is satisfied in a (bundled) model iff there is a  (bundled) quasimodel for ÄÂ• over a countable ÄÂ‰-tree.  M T  M  =  ; ÃË›0 ; t0 ) j= ÄÂ• for  ; H ; h be such that (  Proof. Let  some ÃË›0 2 H and t0 2 ÃË›0 . By Lemma 2, we can assume that  is countable. For ÃË› 2 H , t 2 ÃË› and t 2 T , let  T  M  tp(t ; ÃË›) = fÄÂˆ 2 sub(ÄÂ•) : ( ; ÃË›; t ) j= ÄÂˆg;  ÃÅt = ftp(t ; ÃË›) : t 2 ÃË› 2 H g:  Clearly, tp(t ; ÃË›) is a type for ÄÂ• and ÃÅt is coherent. For any  ÃË› 2 H , the map rÃË› : t 7! tp(t ; ÃË›) is then a run in ÃË›. We claim  that (ÃÅt : t 2 T ) is a quasimodel for ÄÂ• over (a bundled  one if  is bundled, and an unbundled one otherwise). As  ( ; ÃË›0 ; t0 ) j= ÄÂ•, we have ÄÂ• 2 tp(t0 ; ÃË›0 ) 2 ÃÅt0 . For each t 2 T  and ÄÂƒ 2 ÃÅt , we have ÄÂƒ = tp(t ; ÃË›) for some ÃË› 2 H containing  t, so rÃË› (t ) = ÄÂƒ and condition 2 of Definition 5 holds. Finally,  is a full tree model,  for all ÃË› 2 H , rÃË› is a run in ÃË›, so if  it is clear that condition 3 holds.  Conversely, let (ÃÅt : t 2 T ) be a quasimodel for ÄÂ• over  a countable ÄÂ‰-tree . Let <ÄÂ‰ 2 denote the set of finite sequences of 0s and 1s. For ÃË‡ 2 <ÄÂ‰ 2, jÃË‡j denotes the length  of ÃË‡. By replacing with  T  M  M  M  T  T  T  <  ÄÂ‰  2 =def f(t ; ÃË‡) : t 2 T ; ÃË‡ 2 <ÄÂ‰ 2; ht (t ) = jÃË‡jg;  i.e., a countable ÄÂ‰-tree when ordered by (t ; ÃË‡) < (u; ÃÅ¾) iff  t < u in T and ÃË‡ is an initial segment (a prefix) of ÃÅ¾, and  by letting ÃÅ(t ;ÃË‡) = ÃÅt for all t ; ÃË‡, we can assume that () for  each t 2 T and ÄÂƒ 2 ÃÅt , there are 2ÄÂ‰ full branches ÃË› of  containing t such that there is a run r in ÃË› with r(t ) = ÄÂƒ.  Each ÃÅt is finite, so there are countably many pairs (t ; ÄÂƒ)  with t 2 T , ÄÂƒ 2 ÃÅt . Enumerate them as (tn ; ÄÂƒn ), n < ÄÂ‰. Inductively, using (), choose a full branch ÃË›n 3 tn for each  n < ÄÂ‰, such that (i) there is a run rÃË›n in ÃË›n with rÃË›n (tn ) = ÄÂƒn ,  and (ii) ÃË›n =  6 ÃË›m for all m < n. If we have a bundled quasimodel, let H = fÃË›n : n < ÄÂ‰g. This is clearly a bundle  on . If we have an unbundled quasimodel, let H be the  set of all full branches of , and further choose for each  T  T  T  ÃË› 2 H n fÃË›n : n < ÄÂ‰g a run rÃË› in ÃË›; this can be done by  condition 3 of Definition 5. So we have defined a run rÃË› in  ÃË›, for each ÃË› 2 H . Now define a model  =  ; H ; h by  taking h( p) = f(ÃË›; t ) : t 2 ÃË› 2 H ; p 2 rÃË› (t )g for p 2 P .  M T  C LAIM . For all ÃË› 2 H , all t 2 ÃË›, and all ÄÂˆ 2 sub(ÄÂ•), we  have ( ; ÃË›; t ) j= ÄÂˆ iff ÄÂˆ 2 rÃË› (t ).  P ROOF OF CLAIM . The proof is by induction on ÄÂˆ. For  atomic ÄÂˆ = p, we have ( ; ÃË›; t ) j= p iff (ÃË›; t ) 2 h( p), iff  p 2 rÃË› (t ) as required. The boolean cases are trivial. For  ÄÂˆ U ÄÂ‡ 2 sub(ÄÂ•), we have ( ; ÃË›; t ) j= ÄÂˆ U ÄÂ‡ iff there is u 2 ÃË›  such that u > t, ( ; ÃË›; u) j= ÄÂ‡, and ( ; ÃË›; v) j= ÄÂˆ for all  v 2 (t ; u). Inductively, this holds iff there is u 2 ÃË› with u > t,  ÄÂ‡ 2 rÃË› (u), and ÄÂˆ 2 rÃË› (v) for all v 2 (t ; u). Since rÃË› is a run  in ÃË›, this is iff ÄÂˆ U ÄÂ‡ 2 rÃË› (t ), as required. The case of S is  similar.  Finally, for EÄÂˆ 2 sub(ÄÂ•), we have ( ; ÃË›; t ) j= EÄÂˆ iff  ( ; ÃÅ‚; t ) j= ÄÂˆ for some ÃÅ‚ 2 H with t 2 ÃÅ‚. Inductively, this  is iff ÄÂˆ 2 rÃÅ‚ (t ) for some ÃÅ‚ 2 H with t 2 ÃÅ‚. But evidently,  S  ÃÅt = frÃÅ‚ (t ) : ÃÅ‚ 2 H ; t 2 ÃÅ‚g, so this is iff ÄÂˆ 2 ÃÅt . Since ÃÅt  is coherent, this is iff EÄÂˆ 2 rÃË› (t ), as required. The claim is  proved.  Now let t 2 T be such that ÄÂ• 2 ÄÂƒ for some ÄÂƒ 2 ÃÅt . We  may choose n < ÄÂ‰ with (t ; ÄÂƒ) = (tn ; ÄÂƒn ). Then t 2 ÃË›n 2 H  and rÃË›n (t ) = ÄÂƒ, so by the claim, ( ; ÃË›n ; t ) j= ÄÂ•. Thus, ÄÂ• has  a model.  M  M  M  M  M  M  M  M  L EMMA 7. Given a PCTL -formula ÄÂ•, it is decidable  whether ÄÂ• has an unbundled quasimodel over a countable  ÄÂ‰-tree. The same holds for bundled quasimodels.  Proof. We will express the existence of a quasimodel in  monadic second-order logic. Given ÄÂ•, we can effectively  construct the set C of all coherent sets of types. A quasimodel over an ÄÂ‰-tree has the form (ÃÅt : t 2 T ) where  ÃÅt 2 C for each t; we will express this by unary relation  variables PÃÅ for each ÃÅ 2 C , the aim being that PÃÅ is true at  t iff ÃÅt = ÃÅ. We then express the stipulations of Definition 5  in terms of the PÃÅ , as follows. Let RÄÂˆ (ÄÂˆ 2 sub(ÄÂ•)) be unary  relation variables. For a type ÄÂƒ for ÄÂ•, let  T  ÄÂ‡ÄÂƒ (x)  ^  =  ÄÂˆ2ÄÂƒ  R ÄÂˆ (x ) ^  ^  :RÄÂˆ (x):  ÄÂˆ2sub(ÄÂ•)nÄÂƒ  The formula ÄÂ‡ÄÂƒ (x) says that the RÄÂˆ (x) define the type ÄÂƒ at  x. For a unary relation variable B, let ÄÂ be the conjunction  of:    V  ÃÅ2C  8x B(x) ^ PÃÅ (x) !  W    ÄÂƒ2ÃÅ ÄÂ‡ÄÂƒ (x)  ,   8x RÄÂˆ1 UÄÂˆ2 (x) $9y (B(y) ^ x < y ^ RÄÂˆ2 (y) ^ 8z (x <  z < y ! RÄÂˆ1 (z))) , for all ÄÂˆ1 U ÄÂˆ2 2 sub(ÄÂ•),   8x RÄÂˆ1 SÄÂˆ2 (x) $ 9y (y < x ^ RÄÂˆ2 (y) ^ 8z (y < z < x !  RÄÂˆ1 (z))) , for all ÄÂˆ1 S ÄÂˆ2 2 sub(ÄÂ•).  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE  So assuming that B defines a full branch, ÄÂ says that the RÄÂˆ  define a run in B. Let ÃË›(B) be a monadic second-order formula expressing that B is a full branch (a maximal linearlyordered set):  ÃÅ¥(X )  X Y  ÃË›(B)  8xy X x ^ X y ! x y _ x y _ y  8x X x ! Y x  ÃÅ¥ B ^8X ÃÅ¥ X ^ B  X ! X  B  =    ( ( )  =  ( )  ( ( )  =  =  <  <  ( ( )  9  ÃÅ2C  8x _  h  PÃÅ (x)  ÃÅ2C  i  ÃÅ0 (x)  ÃÅ0 2C  ÃÅ=  6 ÃÅ0  h  ^ 8B ÃË› B ! 9 R  ( )  ÄÂˆ  ^ 9x _  ÄÂ  i  ÄÂˆ2sub(ÄÂ•)  ÃÅ2SC  ÄÂ•2 ÃÅ  ÃÅ( )  ÃÅ2C  ÄÂƒ2ÃÅ  ( )  ( )  PÃÅ (x)  ^  h    8x ^ P x !9B ÃË› B ^ B x ^ 9 R ÄÂ ^ ÄÂ‡  ÄÂˆ(  !  i  ÄÂƒ (x))  :  9  f  g  Here, 9ÃÅ2C PÃÅ denotes PÃÅ1 : : : PÃÅk , for C = ÃÅ1 ; : : : ; ÃÅk ,  and similarly for the other 9s. If we are dealing with bundled models, the conjunct B [ÃË›(B)  9ÄÂˆ2sub(ÄÂ•) RÄÂˆ ÄÂ] on  the second line should be omitted.  It should be clear that for any ÄÂ‰-tree , we have = Ã‚Ä¾ iff  there is a quasimodel for ÄÂ• over (bundled or unbundled,  as appropriate). It follows from decidability of S2S [8] that  it is decidable whether a given monadic second-order sentence is true in some countable ÄÂ‰-tree. The lemma now  follows.  8  T  !  T  Tj  As a consequence of Lemmas 6 and 7 we finally obtain  T HEOREM 8. It is decidable whether a PCTL -formula has  a full tree model in the non-local semantics. The same holds  for bundled models.  3 Decidability of the weak one-variable fragment of quantified PCTL  Fix an individual variable x and denote by QPCTL1 the  one-variable fragment of first-order PCTL , which can be  defined as the closure of the sets P0 (x); P1 (x); : : : of unary  predicates and p0 ; p1 ; : : : of propositional variables under  is  the operators x, , , E, , U and S. Note that now  regarded as a primitive operator. The weak one-variable  fragment QPCTLw of QPCTL consists of all QPCTL1 formulas in which the temporal operators U and S and the  path-quantifier E are applied to sentences only. Thus,  is the only temporal operator which can be applied to open  formulas.  f  g  9 ^:  f  g  ;:::;  2  I (w)  p0  T  E  ;:::  M  a f g!  in the signature of QPCTL1 Ã¢Â€Â”the state of  at w. As before, is called a full model if H contains all full branches  is a function : x  D. Let  of . An assignment in  w ÃË› H and let ÄÂ• be a formula. The truth-relation  ( ; ÃË›; w) =a ÄÂ• (or (ÃË›; w) =a ÄÂ• if  is understood, or  ( ; ÃË›; w) = ÄÂ•[d ], where (x) = d) is defined inductively  by taking:  M  T  2 2  M j  M j      ÄÂˆ2sub(ÄÂ•)  9  I (w)  I (w) = D; P0  ):  ^ ^ :P  M  D  x);  Thus, the following monadic second-order formula Ã‚Ä¾ is effectively constructible from ÄÂ•:  PÃÅ  T h i  ( ));  ( )  M T  =  ; H ; D; I ,  A QPCTL1 -model is a quadruple  where = T ; < is an ÄÂ‰-tree, H is a bundle on , D is  a non-empty set, the domain of , and I is a function associating with every time point w T a usual first-order  structure  a  j  M  j ÃÄ… iff I w j a ÃÄ…, for atomic ÃÄ…;  ÃË› w j a 9x ÄÂˆ iff ÃË› w j b ÄÂˆ for some assignment b;  (ÃË›; w) =a  (  M  ;  ( ) =  ) =  (  ;  ) =  for the temporal operators and path quantifiers, the definition is the same as in the propositional case. Note that we  have returned to the traditional Ã¢Â€Â˜localÃ¢Â€Â™ semantics in which  truth values of atoms do not depend on the branch ÃË› of evaluation.  The main result we prove in the remainder of this section  is the following  T HEOREM 9. The satisfiability problem for QPCTLw formulas in both bundled and full models is decidable.  R EMARK 10. (1) We remind the reader that the satisfiability  problem for the full one variable fragment QPCTL1 in both  bundled and full models is undecidable [6].  (2) Actually, using somewhat more sophisticated machinery (in particular, a mosaic technique) one can generalise Theorem 9 to the two variable, monadic, and guarded  can be applied to formufragments of QPCTL in which  las with at most one free variable and the other temporal  operators and path quantifiers only to sentences.  (3) Theorem 9 and its generalisation above still hold if  we extend QPCTLw with individual constants; however,  functional symbols and equality may lead to undecidability, cf. [4].  We will prove this result in two steps. First, we show  that a QPCTLw -formula is satisfiable iff it is satisfiable in  certain quasimodels. Then we will reduce satisfiability in  quasimodels to non-local propositional satisfiability. We  begin the proof of Theorem 9 by recalling that the bundled  case is reducible to the Ã¢Â€Â˜unbundledÃ¢Â€Â™ one [6]. So it is enough  =  ; D; I .  to consider satisfiability in full models  Fix a QPCTLw -sentence ÄÂ•. For simplicity we may assume that any subsentence ÄÂˆ of ÄÂ• is replaced by U ÄÂˆ.  Thus,  is only applied to formulas with free variable x.  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE  M hT i  ?  We define sub(ÄÂ•) and types for ÄÂ• as in Definition 3. For every formula ÃÂ¸(x) = ÄÂˆ(x) 2 sub(ÄÂ•) we reserve fresh unary  predicates PÃÂ¸i (x), and for every ÃÂ¸ of the form EÄÂˆ, ÄÂˆ1 U ÄÂˆ2 ,  or ÄÂˆ1 S ÄÂˆ2 in sub(ÄÂ•) we reserve fresh propositional variables piÃÂ¸ , where i = 0; 1; : : : . The PÃÂ¸i (x) and piÃÂ¸ are called the  i-surrogates of ÃÂ¸(x) and ÃÂ¸, respectively. For ÄÂˆ 2 sub(ÄÂ•),  denote by ÄÂˆi the result of replacing in ÄÂˆ all its subformulas of the form ÄÂˆ, ÄÂˆ U ÄÂ‡, ÄÂˆ S ÄÂ‡, or EÄÂˆ that are not within  the scope of another occurrence of a non-classical operator by their i-surrogates. Thus, ÄÂˆi is a purely first-order  (non-temporal) formula. Let ÃÂ“i = fÄÂ‡i : ÄÂ‡ 2 ÃÂ“g for any set  ÃÂ“  sub(ÄÂ•).  The idea behind these definitions is as follows. The formulas ÄÂ‡i abstract from the temporal component of ÄÂ‡ and can  be evaluated in a first-order structure without taking into account its temporal evolution. Of course, later we have to be  able to reconstruct the truth value of ÄÂ‡ in temporal models  from the truth value of the ÄÂ‡i . In contrast to the linear time  case, we need a list of abstractions ÄÂ‡0 ; ÄÂ‡1 ; : : :, since the temporal evolution depends on branches. So, intuitively, each  i < ÄÂ‰ represents a branch. (Actually, we will see that finitely  many i < ÄÂ‰ are enough, since we have to represent branches  only up to a certain equivalence relation).  sub(ÄÂ•)  Let ÄÂ(ÄÂ•) = 44  .  j  \\  Si  iff  ik  EÄÂˆ 2  [\  Si  iff  ik  ÄÂˆ2  T  Lest this be confusing, we note that S  [\  Si :  ik  i is the set of formulas occurring in every type in Si .  S  (ii) T is a set of maps ÄÂ„ : f1; : : : ; nÃÂ˜ g ! ik Si , called  traces, where nÃÂ˜ ÄÂ(ÄÂ•) is a natural number depending on  ÃÂ˜ and such that fÄÂ„(i) : ÄÂ„ 2 T g : i  nÃÂ˜ = S .  T  The set of sentences in fÄÂ„(i) : ÄÂ„ 2 T g will be denoted  by ÃÂ˜(i). For a trace ÄÂ„, we set  ÄÂ„=  [  i  (ÄÂ„(i)) ;  inÃÂ˜  T  =  fÄÂ„ : ÄÂ„ 2 T g  :  D EFINITION 12. Let ÃÂ˜ = hS ; T i be a state candidate for ÄÂ•  and  D  D  = D; P0 ; : : : ; p0 ; : : :  D  a first-order structure in the signature of QPCTL1 . For every  a 2 D we define the trace of a (with respect to ÃÂ˜) as  tr(a) = fÄÂˆ 2  We say that  L EMMA 13. A state candidate ÃÂ˜ = hS ; T i for ÄÂ• is realisable iff the first-order sentence  ÃÄ…ÃÂ˜ =  ^  ÄÂ„2T  9x ÄÂ„ ^ 8x  _  ÄÂ„  ÄÂ„2T  is satisfiable.  D EFINITION 14. A connection is a quadruple (Ã¢ÂˆÂ†; ÃÂ˜; R; N )  consisting of two realisable state candidates Ã¢ÂˆÂ† = (S ; T ) and  ÃÂ˜ = (U ; V ), a relation R  T  V with domain T and  range V , and a relation N  f1; : : : ; nÃ¢ÂˆÂ† gf1; : : : ; nÃÂ˜ g with  range f1; : : : ; nÃÂ˜ g, such that for all (i; j) 2 N, all (ÄÂ„; ÄÂ„0 ) 2 R,  and all ÄÂˆ 2 sub(ÄÂ•), we have ÄÂˆ 2 ÄÂ„(i) iff ÄÂˆ 2 ÄÂ„0 ( j).  j  D EFINITION 11. A state candidate for ÄÂ• is a pair of the  form ÃÂ˜ = (S ; T ) in which:  (i) S = fS1 ; : : : ; Sk g, where each Si is a set of types for ÄÂ•  such that, for every sentence ÄÂˆ, we have ÄÂˆ 2 ÄÂƒ iff ÄÂˆ 2 ÄÂƒ0 ,  for any ÄÂƒ; ÄÂƒ0 2 Si , and for every EÄÂˆ 2 sub(ÄÂ•),  EÄÂˆ 2  State candidates represent states w of temporal models.  The intuition behind this definition will be clear from the  proof of the theorem below. Here we only say that, roughly,  the components Si of a state candidate ÃÂ˜ = hS ; T i represent  the states of a moment w in different branches, and each  trace ÄÂ„ 2 T shows the types of one element of the domain  of w in these states (i.e., its possible states in different histories).  It follows immediately from the definition that we have:  [  inÃÂ˜  i  (sub(ÄÂ•))  :  D j= ÄÂˆ[a]g  D realises ÃÂ˜ if T = ftr(a) : a 2 Dg.  :  A connection describes how (the abstract representation  ÃÂ˜ of) a state w is related to (the abstract representation Ã¢ÂˆÂ†  of) its immediate predecessor. To this end, the relation R  between the traces in both representations is fixed.  For an ÄÂ‰-tree = hT ; <i and w 2 T , denote by B(w) the  set of full branches coming through w.  T  T  D EFINITION 15. A quasimodel for ÄÂ• over is a map f associating with the root w0 of a pair f (w0 ) = (ÃÂ˜w0 ; gw0 ),  where ÃÂ˜w0 is a realisable state candidate, and with every  non-root point w 2 T a pair f (w) = (Cw ; gw ), where Cw =  (Ã¢ÂˆÂ†w ; ÃÂ˜w ; Rw ; Nw ) is a connection, and all gw , for w 2 T , are  functions from B(w) onto f1; : : : ; nÃÂ˜w g such that the following hold:  T  T  1. if v is the immediate predecessor of w in , then ÃÂ˜v =  Ã¢ÂˆÂ†w and Nw = f(gv (ÃË›); gw (ÃË›)) : ÃË› 2 B(w)g;  2. for all ÃË› 2 B(w), ÄÂ‡ U ÄÂˆ 2 ÃÂ˜w (gw (ÃË›)) iff there exists  u > w with u 2 ÃË›, ÄÂˆ 2 ÃÂ˜u (gu (ÃË›)) and ÄÂ‡ 2 ÃÂ˜v (gv (ÃË›)),  for all v 2 (w; u) (ÃÂ˜(i) was defined after Definition 11);  3. for all ÃË› 2 B(w), ÄÂ‡ S ÄÂˆ 2 ÃÂ˜w (gw (ÃË›)) iff there exists  u < w with ÄÂˆ 2 ÃÂ˜u (gu (ÃË›)) and ÄÂ‡ 2 ÃÂ˜v (gv (ÃË›)) for all  v 2 (u; w).  We say that f satisfies ÄÂ• if there exists w 2 T such that  S  ÃÂ˜w = (Sw ; Tw ) and ÄÂ• 2 S for some S 2 Sw .  While the connections take care of the truth values of  Ã¢Â€Â˜localÃ¢Â€Â™ formulas of the form ÄÂ‡, quasimodels take care of  the remaining Ã¢Â€Â˜globalÃ¢Â€Â™ temporal operators.  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE  S(ÃË›; w) = ftp(ÃË›; w; a) : a 2 Dg;  An induction on d shows that the number ](d ) of dw -classes  is at most ÃÅ¾(ÄÂ•)d  2(d +1)jsub(ÄÂ•)j (for any w). For d = 0, one  may check that if (ÃË›; w) j= ÄÂˆ iff (ÃË›0 ; w) j= ÄÂˆ for each sentence ÄÂˆ 2 sub(ÄÂ•), then ÃË› 0w ÃË›0 . So ](0)  2jsub(ÄÂ•)j . Assume the result for d. One may check that if ÃË›; ÃË›0 2 B(w)  contain a common immediate successor v of w, (ÃË›; w) j= ÄÂˆ  iff (ÃË›0 ; w) j= ÄÂˆ for each sentence ÄÂˆ 2 sub(ÄÂ•), and ÃË› dv ÃË›0 ,  then ÃË› wd +1 ÃË›0 . Both checks involve an induction on ÄÂˆ in  (2) above. It follows that ](d + 1)  ÃÅ¾(ÄÂ•)  2jsub(ÄÂ•)j  ](d ), and  hence that ](d )  ÃÅ¾(ÄÂ•)d  2(d +1)jsub(ÄÂ•)j for all d, as required.  jsub(ÄÂ•)j 0  ÃË› then ÃË› w ÃË›0 , so that w  Finally observe that if ÃË› w  has at most ](jsub(ÄÂ•)j)  ÄÂ(ÄÂ•) classes.  MÃË›w j  Let ÃË›w1 ; : : : ÃË›wnw be some minimal list of full branches  such that f[ÃË›w1 ]w ; : : : ; [ÃË›wnw ]w g is the set of all w -equivalence  classes. With each a 2 D we associate a trace  T HEOREM 16. ÄÂ• is satisfiable in a QPCTL1 -model iff there  exists a quasimodel satisfying ÄÂ•.  Proof. ()) Suppose that ÄÂ• is satisfied in some model. We  <ÄÂ‰ÄÂ‰, as in the proof of  may replace its tree by + =  <  ÄÂ‰  Lemma 6; ÄÂ‰ denotes the set of finite sequences of natural  numbers. Every branch of is Ã¢Â€Â˜duplicatedÃ¢Â€Â™ ÄÂ‰ times in +  at each node, and ÄÂ• is still satisfied in the resulting model  = h + ; D; I i. Thus ( ; ÄÂƒ; v) j=a ÄÂ• for some v 2 T + ,  ÄÂƒ 2 B(v) (defined with respect to + ) and some assignment  . If w 2 T + and ÃË› 2 B(w), let  T T T  T  M  T  M T  a  where  tp(ÃË›; w; a) = fÄÂˆ 2 sub(ÄÂ•) : (  T  ;  ;  g  ) = ÄÂˆ[a]  :  T  Let Sw = fS(ÃË›; w) : ÃË› 2 B(w)g. We extract from + a  subtree 0 = hT 0 ; <0 i in which every node has at most  sub(ÄÂ•)  immediate successors. To this end, we inÃÅ¾(ÄÂ•) = 22  ductively define Tn0  T + with this property. Set T00 = fw0 g,  where w0 is the root of + . Given Tn0 , for each w 2 Tn0  with ht (w) = n, and each S 2 Sw , we pick ÃË›S 2 B(w) such  <ÄÂ‰ÄÂ‰  that S(ÃË›S ; w) = S, and (we use the form of + =  0  +  here) ÃË›S \ Tn = ÃË›S \ ÃË›S = ft 2 T : t  wg for  S distinct  S; S0 2 Sw . Let Bw = fÃË›S : S 2 Sw g, and Tw = Bw . We  can assume thatSÄÂƒ 2 Bw0 . Note that jBw j  ÃÅ¾(ÄÂ•). Now  0  set Tn0S  fTw : w 2 Tn0 ; ht (w) = ng. Finally define  +1 = Tn [  0  0  T = n<ÄÂ‰ Tn . Note that ÄÂƒ  T 0 and v 2 T 0 .  Let 0 = h 0 ; D; I 0 i and 0 be the restrictions of  and  +  to T 0 . One can easily show by induction on the construction of ÄÂˆ 2 sub(ÄÂ•) that ( ; ÃË›; w) j=a ÄÂˆ iff ( 0 ; ÃË›; w) j=a ÄÂˆ,  for all full branches ÃË› in 0 and all w 2 ÃË›. (For example,  suppose ( ; ÃË›; w) j=a EÄÂˆ. Then there is ÃË›0 2 B(w) in +  such that ( ; ÃË›0 ; w) j=a ÄÂˆ. Pick a full branch ÃÅ‚ in 0 for  which S(ÃË›0 ; w) = S(ÃÅ‚; w). Since ÄÂˆ is a sentence, we have  ( ; ÃÅ‚; w) j=a ÄÂˆ. It follows by IH that ( 0 ; ÃÅ‚; w) j=a ÄÂˆ and  so ( 0 ; ÃË›; w) j=a EÄÂˆ.)  Thus 0 satisfies ÄÂ• and we can work with this model  instead of . Define an equivalence relation w on B(w)  (defined in 0 now), for w 2 T 0 , by taking ÃË› w ÃË›0 when  ( 0 ; ÃË›; w) j=a ÄÂˆ iff ( 0 ; ÃË›0 ; w) j=a ÄÂˆ, for every ÄÂˆ 2 sub(ÄÂ•)  and every assignment . The w -equivalence class generated by ÃË› will be denoted by [ÃË›]w .  is applied to open formulas, we can show  Since only  that the number of w -equivalence classes is bounded by  ÄÂ(ÄÂ•). To show this, for w 2 T 0 , full branches ÃË› and ÃË›0 in  B(w), and d < ÄÂ‰, we put ÃË› dw ÃË›0 if for all t 2 T 0 with t  w  and ht (t )  ht (w) + d, we have  T  j  j  T  T T  0  M T  T  M  M  M  T  M  M  M  M  M  T  1. t 2 ÃË› iff t 2 ÃË›0 ,  T  M  M  M  T  T  M  a  a  2. if t 2 ÃË›, then for all assignments and all ÄÂˆ 2 sub(ÄÂ•)  with at most ht (w) + d ht (t ) occurrences of , we  have (ÃË›; t ) j=a ÄÂˆ iff (ÃË›0 ; t ) j=a ÄÂˆ.  ÄÂ„wa : f1; : : : ; nw g !  [  Sw  by taking ÄÂ„wa (i) = tp(ÃË›wi ; w; a). Denote the resulting set of  traces by Tw . Let ÃÂ˜w = (Sw ; Tw ) for all w 2 T 0 . We are now  in a position to define a quasimodel f over 0 satisfying ÄÂ•.  If w is not the root, then set f (w) = ((ÃÂ˜v ; ÃÂ˜w ; Rw ; Nw ); gw ),  where v is the immediate predecessor of w, and for root w0  let f (w0 ) = (ÃÂ˜w0 ; gw0 ), where  T        gw (ÃË›) = i iff ÃË› 2 [ÃË›wi ]w ,  Rw = f(ÄÂ„va ; ÄÂ„wa ) : a 2 Dg,  Nw = f(gv (ÃË›); gw (ÃË›)) : ÃË› 2 B(w)g.  It is not hard to check that f is a quasimodel satisfying ÄÂ•.  (() Now suppose that f is a quasimodel for ÄÂ• over T =  hT i with root w0 . Let f (w0 ) = (ÃÂ˜w gw ) and f (w) =  (Cw gw ) = ((Ã¢ÂˆÂ†w ÃÂ˜w Rw Nw ) gw ) for non-root w 2 T . Let  ;<  0;  ;  ;  ;  ;  0  ;  ÃÂ˜w = (Sw ; Tw ) and nw = nÃÂ˜w .  A run r in f is a function associating with any w 2 T a  trace r(w) 2 Tw such that (r(v); r(w)) 2 Rw for any non-root  w with immediate predecessor v. Using the condition that  the range and domain of Rw coincide with f1; : : : ; nw g and  f1; : : : ; nvg, respectively, it is not difficult to see that, for any  w and any ÄÂ„ 2 Tw , there exists a run r with r(w) = ÄÂ„. Let R  be the set of all runs.  For every w 2 T we find a first-order structure I (w) with  domain D = R realising ÃÂ˜w = (Sw ; Tw ) and such that for all  i 2 f1; : : : ; nw g, r 2 D, and ÄÂˆ 2 sub(ÄÂ•),  M T  ÄÂˆ 2 r(w)(i)  iff I (w) j= ÄÂˆi [r]:  a  Let  = h ; D; I i and let be any assignment in D. One  can show by induction that for all ÄÂˆ 2 sub(ÄÂ•), all w 2 T ,  and all ÃË› 2 B(w) with gw (ÃË›) = i, say, we have  I (w) j=a ÄÂˆi  iff  (  M ÃË› w j aÄÂˆ  ;  ;  ) =  :  Since ÄÂ• 2 r(w)(gw (ÄÂƒ)) for some w 2 T , ÄÂƒ 2 B(w) and r 2  R , we finally obtain ( ; ÄÂƒ; w) j= ÄÂ•.  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE  M  Now we construct a reduction of QPCTLw to non-local  PCTL by means of encoding quasimodels in non-local  propositional tree models. Suppose again that a QPCTLw sentence ÄÂ• is fixed.  With every realisable state candidate ÃÂ˜ = (S ; T ) for ÄÂ•,  every connection C, every i  ÄÂ(ÄÂ•), and every sentence  ÄÂ‡ 2 sub(ÄÂ•), which either is a propositional variable or starts  with an existential quantifier 9x, we associate propositional  variables pÃÂ˜ , pC , pi , and pÄÂ‡ , respectively. Let ] be a translation from the set of QPCTLw -sentences into the set of  PCTL -formulas which distributes over the booleans, temporal operators and path quantifiers, and ÄÂ‡] = pÄÂ‡ , where ÄÂ‡  is a propositional variable or a sentence of the form 9x ÄÂ‘.  Clearly, ÄÂ•] is a PCTL -formula. Then the following formula ÄÂ•? is effectively constructable from ÄÂ•:  tended to mean gw (ÃË›) = i. This is ensured by the formulas  A  ( i  j );  ! :  (5)  1i< j ÄÂ(ÄÂ•)  A2F  ^    ^  ÃÂ˜2R (ÄÂ•)  A2F  ( i  ! :  j );  (6)  1i< j ÄÂ(ÄÂ•)  pÃÂ˜ !  i^    1inÃÂ˜  pC !  i^  1inÃÂ˜  C2C (ÄÂ•)  (7)  ;  i  1inÃÂ˜  (8)  :  i  1inÃÂ˜  Here and below we assume that C = (Ã¢ÂˆÂ†; ÃÂ˜; R; N ). Now we  write down a formula which says that N in C is determined  by the functions gw :  A2F    ÄÂ•? = ÄÂ•] ^ (ÄÂ‡ ^ :3P>) _ 3P(ÄÂ‡ ^ :3P>)  ^ p p  ^ p p  ^ Ep A _ p   ^ Ep A _ p   ^    pC !  C2C (ÄÂ•)  ^  E( p j ^  (i; j )2N  ;  ^  A  _  P pi )    (p j ^  P pi )  (9)  :  (i; j )2N  where ÄÂ‡ is the conjunction of the formulas (1)Ã¢Â€Â“(11) defined  below.  _  _R  ÃÂ˜2  A2F    A pÃÂ˜ ^  ^Ap  ^Ap  A pC ^  C2C (ÄÂ•)  ! :  pÃÂ˜ );  0  0  ( C  (1)    ! :  pC )  0  :  (2)  C6=C0  Here R (ÄÂ•) and C (ÄÂ•) are the sets of realisable state candidates and connections for ÄÂ•, respectively. The formulas  in (1) say that the pÃÂ˜ and pC are Ã¢Â€Â˜localÃ¢Â€Â™ (so we can write  w j= pÃÂ˜ and w j= pC ) and that precisely one pÃÂ˜ holds at the  root and precisely one pC holds at each non-root point.  Intuitively, w j= pC means that f (w) = (C; g), for some  g. Say that a pair of connections (C1 ; C2 ) is suitable if the  second state candidate of C1 coincides with the first state  candidate of C2 . The set of all suitable pairs of connections  is denoted by Cs (ÄÂ•). A pair (ÃÂ˜; C) is suitable if the first  state candidate of C coincides with ÃÂ˜. The set of all suitable pairs of this form is denoted by R s (ÄÂ•). The following  formulas say that the pair induced by a point and its immediate predecessor is suitable:  A  _  _R  (ÃÂ˜;C)2  A2F  ( pÃÂ˜ ^  pC );  (3)  s (ÄÂ•)  ( pC1  ^  ^  ^ÄÂ‡ ^  ^ p  R  ^ p  A2  include:  ( ÃÂ˜  ÃÂ˜6=ÃÂ˜  (ÄÂ•)  Finally, we have to ensure that the set of sentences true at  (ÃË›; w) corresponds to the set of sentences in ÃÂ˜w (gw (ÃË›)). Let  ÃÂ˜0w (i) be the set of sentences in sub(ÄÂ•) n ÃÂ˜w (i). Then we  ^  pC2 ):  (4)  (C1 ;C2 )2Cs (ÄÂ•)  Intuitively, for i such that 1  i  ÄÂ(ÄÂ•), (ÃË›; w) j= pi is in-  A  ( ÃÂ˜ ^ pi ) ! (  ÄÂ‡  ÃÂ˜2 (ÄÂ•);1inÃÂ˜  ÄÂ‡2ÃÂ˜(i)  ( C ^ pi ) ! (  C2S (ÄÂ•);1inÃÂ˜  ÄÂ‡2ÃÂ˜(i)  F  ]  ]    ÄÂ‡] )  ÄÂ‡2ÃÂ˜0 (i)  ^  ;  (10)  :  (11)  :  ^    ÄÂ‡] )  :  ÄÂ‡2ÃÂ˜0 (i)  T HEOREM 17. A QPCTLw -sentence ÄÂ• is satisfiable in a  full model iff the PCTL -formula ÄÂ•? is satisfiable in a full  non-local model.  Proof. ()) If ÄÂ• is satisfiable, then it is satisfied in a quasimodel f for ÄÂ• based on an ÄÂ‰-tree = hT ; <i. Let f (w) =  (Cw ; gw ) = ((Ã¢ÂˆÂ†w ; ÃÂ˜w ; Nw ; Rw ); gw ) if w is not the root and  f (w0 ) = (Ã¢ÂˆÂ†w0 ; gw0 ) for root w0 of . Define a (propositional) valuation h in  by taking, for all w 2 T and  ÃË› 2 B(w):  T  T    (ÃË›; w)    (ÃË›; w) 2 h( pC )    (ÃË›; w) 2 h( pi )    (ÃË›; w)  T  2 h( pÃÂ˜ ) iff ÃÂ˜ = ÃÂ˜w , for every realisable state  candidate ÃÂ˜;  iff C = Cw , for every connection C;  iff gw (ÃË›) = i, for all i < ÄÂ(ÄÂ•);  2 h( pÄÂ‡ ) iff ÄÂ‡ 2 ÃÂ˜w (gw (ÃË›)), for all sentences ÄÂ‡  in sub(ÄÂ•).  It is not hard to prove that the full model  required.  M T  T  M Th  =  h  ;  i  is as  Conversely, suppose  = h ; hi satisfies ÄÂ•? . Then  ÄÂ‡ is true at the root w0 of . Define a quasimodel f by  taking f (w) = (Cw ; gw ) = ((Ã¢ÂˆÂ†w ; ÃÂ˜w ; Nw ; Rw ); gw ) if w 6= w0 ,  and f (w0 ) = (ÃÂ˜w0 ; gw0 ), where  (()  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE   ÃÂ˜w0 is the unique ÃÂ˜ for which w0 j= pÃÂ˜ (this is independent of the branch of evaluation);   for w 6= w0 , Cw is the unique C such that w j= pC ;   gw (ÃË›) = i for the unique i for which (ÃË›; w) j= pi .  The reader can check that f is a quasimodel satisfying ÄÂ•.  4 Conclusion  The decidability of the weak one-variable fragment of  first-order CTL can be used to obtain decidability results  for certain spatio-temporal logics based on CTL and the  region connection calculus RCC-8 (see the survey papers  [5, 9]). From this viewpoint it has sufficient expressive  power to be useful. However, there is still a gap between the  undecidability of the one-variable fragment of first-order  CTL and the decidability of its weak one-variable fragment. In particular, the following problems are still open.  1. What happens if the path-quantifier  open formulas as well?  E  is applied to  2. Or, what happens if all temporal operators are applied  to open formulas, but E only to sentences?  3. Another open problem is the computational complexity of the logics considered above.  The reduction proofs presented in this paper provide only  non-elementary decision procedures (simply because the  complexity of S2S is non-elementary). We do not believe  that this is optimal.  [2] A. Chandra, J. Halpern, A. Meyer, and R. Parikh. Equations  between regular terms and an application to process logic. In  STOC, pages 384Ã¢Â€Â“390, 1981.  [3] E. Emerson and J. Halpern. Ã¢Â€ÂœsometimesÃ¢Â€Â and Ã¢Â€Âœnot neverÃ¢Â€Â revisited: on branching versus linear time. Journal of the ACM,  33:151Ã¢Â€Â“178, 1986.  [4] I. Hodkinson, F. Wolter, and M. Zakharyaschev. Decidable  fragments of first-order temporal logics. Annals of Pure and  Applied Logic, 106:85Ã¢Â€Â“134, 2000.  [5] I. Hodkinson, F. Wolter, and M. Zakharyaschev. Monodic  fragments of first-order temporal logics: 2000Ã¢Â€Â“2001 a.d. In  R. Nieuwenhuis and A. Voronkov, editors, Logic for Programming, Artificial Intelligence and Reasoning, volume  2250 of LNAI, pages 1Ã¢Â€Â“23. Springer-Verlag, 2001.  [6] I. Hodkinson, F. Wolter, and M. Zakharyaschev. Decidable  and undecidable fragments of first-order branching temporal  logics. In Proc. Logic in Computer Science (LICSÃ¢Â€Â™02). IEEE  Computer Science Press, 2002 (in print). (Draft available at  http://www.dcs.kcl.ac.uk/staff/mz.)  [7] F. Laroussinie and P. Schnoebelen. A hierarchy of temporal logics with past. Volume 775 of LNCS, pages 47Ã¢Â€Â“58.  Springer-Verlag, 1994.  [8] M. O. Rabin. Decidability of second order theories and automata on infinite trees. Transactions of the American Mathematical Society, 141:1Ã¢Â€Â“35, 1969.  [9] F. Wolter and M. Zakharyaschev. Qualitative spatio-temporal  representation and reasoning: a computational perspective. In  Exploring Artificial Intelligence in the New Millenium. Morgan Kaufmann Publishers, 2002 (in print).  [10] A. Zanardo. A finite axiomatization of the set of strongly  valid ockamist formulas. Journal of Philosophical Logic,  14:447Ã¢Â€Â“468, 1985.  Acknowledgements  The work of the second and forth authors was partially  supported by UK EPSRC grant GR/R45369/01 Ã¢Â€ÂœAnalysis  and mechanisation of decidable first-order temporal logics;Ã¢Â€Â the fourth author was also partially supported by  UK EPSRC grant GR/R42474/01 Ã¢Â€ÂœComplexity analysis  of reasoning in combined knowledge representation systems.Ã¢Â€Â The work of the third author was partially supported by Deutsche Forschungsgemeinschaft (DFG) grant  Wo583/3-1. We are grateful to Szabolcs MikulaÄšÂs for helpful  discussions and Colin Stirling who attracted our attention to  the non-local version of CTL . Thanks are also due to the  anonymous referees for useful suggestions and comments  on the first version of this paper.  References  [1] J. Burgess. Logic and time. Journal of Symbolic Logic,  44:566Ã¢Â€Â“582, 1979.  Proceedings of the Ninth International Symposium on Temporal Representation and Reasoning (TIMEÃ¢Â€Â™02)  1530-1311/02 $17.00 Ã‚Å  2002 IEEE 